import t from"http";import e from"https";import n from"string_decoder";import r from"events";import s from"timers";import o from"url";function i(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a,c={},u={};function l(){return a||(a=1,function(){u.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,includeWhiteChars:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}}}.call(u)),u}var p,h={},d={},f={};function m(){return p||(p=1,function(){var t,e,n,r,s,o,i,a=[].slice,c={}.hasOwnProperty;t=function(){var t,e,n,r,o,i;if(i=arguments[0],o=2<=arguments.length?a.call(arguments,1):[],s(Object.assign))Object.assign.apply(null,arguments);else for(t=0,n=o.length;t<n;t++)if(null!=(r=o[t]))for(e in r)c.call(r,e)&&(i[e]=r[e]);return i},s=function(t){return!!t&&"[object Function]"===Object.prototype.toString.call(t)},o=function(t){var e;return!!t&&("function"==(e=typeof t)||"object"===e)},n=function(t){return s(Array.isArray)?Array.isArray(t):"[object Array]"===Object.prototype.toString.call(t)},r=function(t){var e;if(n(t))return!t.length;for(e in t)if(c.call(t,e))return!1;return!0},i=function(t){var e,n;return o(t)&&(n=Object.getPrototypeOf(t))&&(e=n.constructor)&&"function"==typeof e&&e instanceof e&&Function.prototype.toString.call(e)===Function.prototype.toString.call(Object)},e=function(t){return s(t.valueOf)?t.valueOf():t},f.assign=t,f.isFunction=s,f.isObject=o,f.isArray=n,f.isEmpty=r,f.isPlainObject=i,f.getValue=e}.call(f)),f}var g,y={exports:{}},w=y.exports;function b(){return g||(g=1,function(){y.exports=function(){function t(){}return t.prototype.hasFeature=function(t,e){return!0},t.prototype.createDocumentType=function(t,e,n){throw new Error("This DOM method is not implemented.")},t.prototype.createDocument=function(t,e,n){throw new Error("This DOM method is not implemented.")},t.prototype.createHTMLDocument=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}.call(w)),y.exports}var _,v={exports:{}},T={exports:{}},x={exports:{}},E=x.exports;function O(){return _||(_=1,function(){x.exports=function(){function t(){}return t.prototype.handleError=function(t){throw new Error(t)},t}()}.call(E)),x.exports}var I,D={exports:{}},A=D.exports;function S(){return I||(I=1,function(){D.exports=function(){function t(t){this.arr=t||[]}return Object.defineProperty(t.prototype,"length",{get:function(){return this.arr.length}}),t.prototype.item=function(t){return this.arr[t]||null},t.prototype.contains=function(t){return-1!==this.arr.indexOf(t)},t}()}.call(A)),D.exports}var k,N=T.exports;function P(){return k||(k=1,function(){var t,e;t=O(),e=S(),T.exports=function(){function n(){this.defaultParams={"canonical-form":!1,"cdata-sections":!1,comments:!1,"datatype-normalization":!1,"element-content-whitespace":!0,entities:!0,"error-handler":new t,infoset:!0,"validate-if-schema":!1,namespaces:!0,"namespace-declarations":!0,"normalize-characters":!1,"schema-location":"","schema-type":"","split-cdata-sections":!0,validate:!1,"well-formed":!0},this.params=Object.create(this.defaultParams)}return Object.defineProperty(n.prototype,"parameterNames",{get:function(){return new e(Object.keys(this.defaultParams))}}),n.prototype.getParameter=function(t){return this.params.hasOwnProperty(t)?this.params[t]:null},n.prototype.canSetParameter=function(t,e){return!0},n.prototype.setParameter=function(t,e){return null!=e?this.params[t]=e:delete this.params[t]},n}()}.call(N)),T.exports}var C,L={exports:{}},R={exports:{}},$={exports:{}},j=$.exports;function q(){return C||(C=1,function(){$.exports={Element:1,Attribute:2,Text:3,CData:4,EntityReference:5,EntityDeclaration:6,ProcessingInstruction:7,Comment:8,Document:9,DocType:10,DocumentFragment:11,NotationDeclaration:12,Declaration:201,Raw:202,AttributeDeclaration:203,ElementDeclaration:204,Dummy:205}}.call(j)),$.exports}var F,M={exports:{}},z=M.exports;function U(){return F||(F=1,function(){var t;t=q(),se(),M.exports=function(){function e(e,n,r){if(this.parent=e,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),null==n)throw new Error("Missing attribute name. "+this.debugInfo(n));this.name=this.stringify.name(n),this.value=this.stringify.attValue(r),this.type=t.Attribute,this.isId=!1,this.schemaTypeInfo=null}return Object.defineProperty(e.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(e.prototype,"ownerElement",{get:function(){return this.parent}}),Object.defineProperty(e.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(e.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(e.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(e.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(e.prototype,"specified",{get:function(){return!0}}),e.prototype.clone=function(){return Object.create(this)},e.prototype.toString=function(t){return this.options.writer.attribute(this,this.options.writer.filterOptions(t))},e.prototype.debugInfo=function(t){return null==(t=t||this.name)?"parent: <"+this.parent.name+">":"attribute: {"+t+"}, parent: <"+this.parent.name+">"},e.prototype.isEqualNode=function(t){return t.namespaceURI===this.namespaceURI&&(t.prefix===this.prefix&&(t.localName===this.localName&&t.value===this.value))},e}()}.call(z)),M.exports}var B,V={exports:{}},Z=V.exports;function H(){return B||(B=1,function(){V.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return Object.keys(this.nodes).length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.getNamedItem=function(t){return this.nodes[t]},t.prototype.setNamedItem=function(t){var e;return e=this.nodes[t.nodeName],this.nodes[t.nodeName]=t,e||null},t.prototype.removeNamedItem=function(t){var e;return e=this.nodes[t],delete this.nodes[t],e||null},t.prototype.item=function(t){return this.nodes[Object.keys(this.nodes)[t]]||null},t.prototype.getNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t.prototype.setNamedItemNS=function(t){throw new Error("This DOM method is not implemented.")},t.prototype.removeNamedItemNS=function(t,e){throw new Error("This DOM method is not implemented.")},t}()}.call(Z)),V.exports}var W,X=R.exports;function G(){return W||(W=1,function(){var t,e,n,r,s,o,i,a,c={}.hasOwnProperty;a=m(),i=a.isObject,o=a.isFunction,s=a.getValue,r=se(),t=q(),e=U(),n=H(),R.exports=function(r){function a(e,n,r){var s,o,i,c;if(a.__super__.constructor.call(this,e),null==n)throw new Error("Missing element name. "+this.debugInfo());if(this.name=this.stringify.name(n),this.type=t.Element,this.attribs={},this.schemaTypeInfo=null,null!=r&&this.attribute(r),e.type===t.Document&&(this.isRoot=!0,this.documentObject=e,e.rootObject=this,e.children))for(o=0,i=(c=e.children).length;o<i;o++)if((s=c[o]).type===t.DocType){s.name=this.name;break}}return function(t,e){for(var n in e)c.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(a,r),Object.defineProperty(a.prototype,"tagName",{get:function(){return this.name}}),Object.defineProperty(a.prototype,"namespaceURI",{get:function(){return""}}),Object.defineProperty(a.prototype,"prefix",{get:function(){return""}}),Object.defineProperty(a.prototype,"localName",{get:function(){return this.name}}),Object.defineProperty(a.prototype,"id",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(a.prototype,"className",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(a.prototype,"classList",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(a.prototype,"attributes",{get:function(){return this.attributeMap&&this.attributeMap.nodes||(this.attributeMap=new n(this.attribs)),this.attributeMap}}),a.prototype.clone=function(){var t,e,n,r;for(e in(n=Object.create(this)).isRoot&&(n.documentObject=null),n.attribs={},r=this.attribs)c.call(r,e)&&(t=r[e],n.attribs[e]=t.clone());return n.children=[],this.children.forEach(function(t){var e;return(e=t.clone()).parent=n,n.children.push(e)}),n},a.prototype.attribute=function(t,n){var r,a;if(null!=t&&(t=s(t)),i(t))for(r in t)c.call(t,r)&&(a=t[r],this.attribute(r,a));else o(n)&&(n=n.apply()),this.options.keepNullAttributes&&null==n?this.attribs[t]=new e(this,t,""):null!=n&&(this.attribs[t]=new e(this,t,n));return this},a.prototype.removeAttribute=function(t){var e,n,r;if(null==t)throw new Error("Missing attribute name. "+this.debugInfo());if(t=s(t),Array.isArray(t))for(n=0,r=t.length;n<r;n++)e=t[n],delete this.attribs[e];else delete this.attribs[t];return this},a.prototype.toString=function(t){return this.options.writer.element(this,this.options.writer.filterOptions(t))},a.prototype.att=function(t,e){return this.attribute(t,e)},a.prototype.a=function(t,e){return this.attribute(t,e)},a.prototype.getAttribute=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t].value:null},a.prototype.setAttribute=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getAttributeNode=function(t){return this.attribs.hasOwnProperty(t)?this.attribs[t]:null},a.prototype.setAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.removeAttributeNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.setAttributeNS=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.removeAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getAttributeNodeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.setAttributeNodeNS=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.hasAttribute=function(t){return this.attribs.hasOwnProperty(t)},a.prototype.hasAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.setIdAttribute=function(t,e){return this.attribs.hasOwnProperty(t)?this.attribs[t].isId:e},a.prototype.setIdAttributeNS=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.setIdAttributeNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},a.prototype.isEqualNode=function(t){var e,n,r;if(!a.__super__.isEqualNode.apply(this,arguments).isEqualNode(t))return!1;if(t.namespaceURI!==this.namespaceURI)return!1;if(t.prefix!==this.prefix)return!1;if(t.localName!==this.localName)return!1;if(t.attribs.length!==this.attribs.length)return!1;for(e=n=0,r=this.attribs.length-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)if(!this.attribs[e].isEqualNode(t.attribs[e]))return!1;return!0},a}(r)}.call(X)),R.exports}var K,Y={exports:{}},J={exports:{}},Q=J.exports;function tt(){return K||(K=1,function(){var t,e={}.hasOwnProperty;t=se(),J.exports=function(t){function n(t){n.__super__.constructor.call(this,t),this.value=""}return function(t,n){for(var r in n)e.call(n,r)&&(t[r]=n[r]);function s(){this.constructor=t}s.prototype=n.prototype,t.prototype=new s,t.__super__=n.prototype}(n,t),Object.defineProperty(n.prototype,"data",{get:function(){return this.value},set:function(t){return this.value=t||""}}),Object.defineProperty(n.prototype,"length",{get:function(){return this.value.length}}),Object.defineProperty(n.prototype,"textContent",{get:function(){return this.value},set:function(t){return this.value=t||""}}),n.prototype.clone=function(){return Object.create(this)},n.prototype.substringData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.appendData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.insertData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.deleteData=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.replaceData=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},n.prototype.isEqualNode=function(t){return!!n.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.data===this.data},n}(t)}.call(Q)),J.exports}var et,nt=Y.exports;function rt(){return et||(et=1,function(){var t,e,n={}.hasOwnProperty;t=q(),e=tt(),Y.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing CDATA text. "+this.debugInfo());this.name="#cdata-section",this.type=t.CData,this.value=this.stringify.cdata(n)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.cdata(this,this.options.writer.filterOptions(t))},r}(e)}.call(nt)),Y.exports}var st,ot={exports:{}},it=ot.exports;function at(){return st||(st=1,function(){var t,e,n={}.hasOwnProperty;t=q(),e=tt(),ot.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing comment text. "+this.debugInfo());this.name="#comment",this.type=t.Comment,this.value=this.stringify.comment(n)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.comment(this,this.options.writer.filterOptions(t))},r}(e)}.call(it)),ot.exports}var ct,ut={exports:{}},lt=ut.exports;function pt(){return ct||(ct=1,function(){var t,e,n,r={}.hasOwnProperty;n=m().isObject,e=se(),t=q(),ut.exports=function(e){function s(e,r,o,i){var a;s.__super__.constructor.call(this,e),n(r)&&(r=(a=r).version,o=a.encoding,i=a.standalone),r||(r="1.0"),this.type=t.Declaration,this.version=this.stringify.xmlVersion(r),null!=o&&(this.encoding=this.stringify.xmlEncoding(o)),null!=i&&(this.standalone=this.stringify.xmlStandalone(i))}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(s,e),s.prototype.toString=function(t){return this.options.writer.declaration(this,this.options.writer.filterOptions(t))},s}(e)}.call(lt)),ut.exports}var ht,dt={exports:{}},ft={exports:{}},mt=ft.exports;function gt(){return ht||(ht=1,function(){var t,e,n={}.hasOwnProperty;e=se(),t=q(),ft.exports=function(e){function r(e,n,s,o,i,a){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());if(null==s)throw new Error("Missing DTD attribute name. "+this.debugInfo(n));if(!o)throw new Error("Missing DTD attribute type. "+this.debugInfo(n));if(!i)throw new Error("Missing DTD attribute default. "+this.debugInfo(n));if(0!==i.indexOf("#")&&(i="#"+i),!i.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT. "+this.debugInfo(n));if(a&&!i.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT. "+this.debugInfo(n));this.elementName=this.stringify.name(n),this.type=t.AttributeDeclaration,this.attributeName=this.stringify.name(s),this.attributeType=this.stringify.dtdAttType(o),a&&(this.defaultValue=this.stringify.dtdAttDefault(a)),this.defaultValueType=i}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.toString=function(t){return this.options.writer.dtdAttList(this,this.options.writer.filterOptions(t))},r}(e)}.call(mt)),ft.exports}var yt,wt={exports:{}},bt=wt.exports;function _t(){return yt||(yt=1,function(){var t,e,n,r={}.hasOwnProperty;n=m().isObject,e=se(),t=q(),wt.exports=function(e){function s(e,r,o,i){if(s.__super__.constructor.call(this,e),null==o)throw new Error("Missing DTD entity name. "+this.debugInfo(o));if(null==i)throw new Error("Missing DTD entity value. "+this.debugInfo(o));if(this.pe=!!r,this.name=this.stringify.name(o),this.type=t.EntityDeclaration,n(i)){if(!i.pubID&&!i.sysID)throw new Error("Public and/or system identifiers are required for an external entity. "+this.debugInfo(o));if(i.pubID&&!i.sysID)throw new Error("System identifier is required for a public external entity. "+this.debugInfo(o));if(this.internal=!1,null!=i.pubID&&(this.pubID=this.stringify.dtdPubID(i.pubID)),null!=i.sysID&&(this.sysID=this.stringify.dtdSysID(i.sysID)),null!=i.nData&&(this.nData=this.stringify.dtdNData(i.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity. "+this.debugInfo(o))}else this.value=this.stringify.dtdEntityValue(i),this.internal=!0}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(s,e),Object.defineProperty(s.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(s.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(s.prototype,"notationName",{get:function(){return this.nData||null}}),Object.defineProperty(s.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(s.prototype,"xmlEncoding",{get:function(){return null}}),Object.defineProperty(s.prototype,"xmlVersion",{get:function(){return null}}),s.prototype.toString=function(t){return this.options.writer.dtdEntity(this,this.options.writer.filterOptions(t))},s}(e)}.call(bt)),wt.exports}var vt,Tt={exports:{}},xt=Tt.exports;function Et(){return vt||(vt=1,function(){var t,e,n={}.hasOwnProperty;e=se(),t=q(),Tt.exports=function(e){function r(e,n,s){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD element name. "+this.debugInfo());s||(s="(#PCDATA)"),Array.isArray(s)&&(s="("+s.join(",")+")"),this.name=this.stringify.name(n),this.type=t.ElementDeclaration,this.value=this.stringify.dtdElementValue(s)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.toString=function(t){return this.options.writer.dtdElement(this,this.options.writer.filterOptions(t))},r}(e)}.call(xt)),Tt.exports}var Ot,It={exports:{}},Dt=It.exports;function At(){return Ot||(Ot=1,function(){var t,e,n={}.hasOwnProperty;e=se(),t=q(),It.exports=function(e){function r(e,n,s){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing DTD notation name. "+this.debugInfo(n));if(!s.pubID&&!s.sysID)throw new Error("Public or system identifiers are required for an external entity. "+this.debugInfo(n));this.name=this.stringify.name(n),this.type=t.NotationDeclaration,null!=s.pubID&&(this.pubID=this.stringify.dtdPubID(s.pubID)),null!=s.sysID&&(this.sysID=this.stringify.dtdSysID(s.sysID))}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),Object.defineProperty(r.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(r.prototype,"systemId",{get:function(){return this.sysID}}),r.prototype.toString=function(t){return this.options.writer.dtdNotation(this,this.options.writer.filterOptions(t))},r}(e)}.call(Dt)),It.exports}var St,kt=dt.exports;function Nt(){return St||(St=1,function(){var t,e,n,r,s,o,i,a,c={}.hasOwnProperty;a=m().isObject,i=se(),t=q(),e=gt(),r=_t(),n=Et(),s=At(),o=H(),dt.exports=function(i){function u(e,n,r){var s,o,i,c,l,p;if(u.__super__.constructor.call(this,e),this.type=t.DocType,e.children)for(o=0,i=(c=e.children).length;o<i;o++)if((s=c[o]).type===t.Element){this.name=s.name;break}this.documentObject=e,a(n)&&(n=(l=n).pubID,r=l.sysID),null==r&&(r=(p=[n,r])[0],n=p[1]),null!=n&&(this.pubID=this.stringify.dtdPubID(n)),null!=r&&(this.sysID=this.stringify.dtdSysID(r))}return function(t,e){for(var n in e)c.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(u,i),Object.defineProperty(u.prototype,"entities",{get:function(){var e,n,r,s,i;for(s={},n=0,r=(i=this.children).length;n<r;n++)(e=i[n]).type!==t.EntityDeclaration||e.pe||(s[e.name]=e);return new o(s)}}),Object.defineProperty(u.prototype,"notations",{get:function(){var e,n,r,s,i;for(s={},n=0,r=(i=this.children).length;n<r;n++)(e=i[n]).type===t.NotationDeclaration&&(s[e.name]=e);return new o(s)}}),Object.defineProperty(u.prototype,"publicId",{get:function(){return this.pubID}}),Object.defineProperty(u.prototype,"systemId",{get:function(){return this.sysID}}),Object.defineProperty(u.prototype,"internalSubset",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),u.prototype.element=function(t,e){var r;return r=new n(this,t,e),this.children.push(r),this},u.prototype.attList=function(t,n,r,s,o){var i;return i=new e(this,t,n,r,s,o),this.children.push(i),this},u.prototype.entity=function(t,e){var n;return n=new r(this,!1,t,e),this.children.push(n),this},u.prototype.pEntity=function(t,e){var n;return n=new r(this,!0,t,e),this.children.push(n),this},u.prototype.notation=function(t,e){var n;return n=new s(this,t,e),this.children.push(n),this},u.prototype.toString=function(t){return this.options.writer.docType(this,this.options.writer.filterOptions(t))},u.prototype.ele=function(t,e){return this.element(t,e)},u.prototype.att=function(t,e,n,r,s){return this.attList(t,e,n,r,s)},u.prototype.ent=function(t,e){return this.entity(t,e)},u.prototype.pent=function(t,e){return this.pEntity(t,e)},u.prototype.not=function(t,e){return this.notation(t,e)},u.prototype.up=function(){return this.root()||this.documentObject},u.prototype.isEqualNode=function(t){return!!u.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&(t.name===this.name&&(t.publicId===this.publicId&&t.systemId===this.systemId))},u}(i)}.call(kt)),dt.exports}var Pt,Ct={exports:{}},Lt=Ct.exports;function Rt(){return Pt||(Pt=1,function(){var t,e,n={}.hasOwnProperty;t=q(),e=se(),Ct.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing raw text. "+this.debugInfo());this.type=t.Raw,this.value=this.stringify.raw(n)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.raw(this,this.options.writer.filterOptions(t))},r}(e)}.call(Lt)),Ct.exports}var $t,jt={exports:{}},qt=jt.exports;function Ft(){return $t||($t=1,function(){var t,e,n={}.hasOwnProperty;t=q(),e=tt(),jt.exports=function(e){function r(e,n){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing element text. "+this.debugInfo());this.name="#text",this.type=t.Text,this.value=this.stringify.text(n)}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),Object.defineProperty(r.prototype,"isElementContentWhitespace",{get:function(){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),Object.defineProperty(r.prototype,"wholeText",{get:function(){var t,e,n;for(n="",e=this.previousSibling;e;)n=e.data+n,e=e.previousSibling;for(n+=this.data,t=this.nextSibling;t;)n+=t.data,t=t.nextSibling;return n}}),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.text(this,this.options.writer.filterOptions(t))},r.prototype.splitText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r.prototype.replaceWholeText=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},r}(e)}.call(qt)),jt.exports}var Mt,zt={exports:{}},Ut=zt.exports;function Bt(){return Mt||(Mt=1,function(){var t,e,n={}.hasOwnProperty;t=q(),e=tt(),zt.exports=function(e){function r(e,n,s){if(r.__super__.constructor.call(this,e),null==n)throw new Error("Missing instruction target. "+this.debugInfo());this.type=t.ProcessingInstruction,this.target=this.stringify.insTarget(n),this.name=this.target,s&&(this.value=this.stringify.insValue(s))}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return this.options.writer.processingInstruction(this,this.options.writer.filterOptions(t))},r.prototype.isEqualNode=function(t){return!!r.__super__.isEqualNode.apply(this,arguments).isEqualNode(t)&&t.target===this.target},r}(e)}.call(Ut)),zt.exports}var Vt,Zt={exports:{}},Ht=Zt.exports;function Wt(){return Vt||(Vt=1,function(){var t,e,n={}.hasOwnProperty;e=se(),t=q(),Zt.exports=function(e){function r(e){r.__super__.constructor.call(this,e),this.type=t.Dummy}return function(t,e){for(var r in e)n.call(e,r)&&(t[r]=e[r]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(r,e),r.prototype.clone=function(){return Object.create(this)},r.prototype.toString=function(t){return""},r}(e)}.call(Ht)),Zt.exports}var Xt,Gt={exports:{}},Kt=Gt.exports;function Yt(){return Xt||(Xt=1,function(){Gt.exports=function(){function t(t){this.nodes=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.nodes.length||0}}),t.prototype.clone=function(){return this.nodes=null},t.prototype.item=function(t){return this.nodes[t]||null},t}()}.call(Kt)),Gt.exports}var Jt,Qt={exports:{}},te=Qt.exports;function ee(){return Jt||(Jt=1,function(){Qt.exports={Disconnected:1,Preceding:2,Following:4,Contains:8,ContainedBy:16,ImplementationSpecific:32}}.call(te)),Qt.exports}var ne,re=L.exports;function se(){return ne||(ne=1,function(){var t,e,n,r,s,o,i,a,c,u,l,p,h,d,f,g,y,w={}.hasOwnProperty;y=m(),g=y.isObject,f=y.isFunction,d=y.isEmpty,h=y.getValue,a=null,n=null,r=null,s=null,o=null,l=null,p=null,u=null,i=null,e=null,c=null,t=null,L.exports=function(){function m(h){this.parent=h,this.parent&&(this.options=this.parent.options,this.stringify=this.parent.stringify),this.value=null,this.children=[],this.baseURI=null,a||(a=G(),n=rt(),r=at(),s=pt(),o=Nt(),l=Rt(),p=Ft(),u=Bt(),i=Wt(),e=q(),c=Yt(),H(),t=ee())}return Object.defineProperty(m.prototype,"nodeName",{get:function(){return this.name}}),Object.defineProperty(m.prototype,"nodeType",{get:function(){return this.type}}),Object.defineProperty(m.prototype,"nodeValue",{get:function(){return this.value}}),Object.defineProperty(m.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(m.prototype,"childNodes",{get:function(){return this.childNodeList&&this.childNodeList.nodes||(this.childNodeList=new c(this.children)),this.childNodeList}}),Object.defineProperty(m.prototype,"firstChild",{get:function(){return this.children[0]||null}}),Object.defineProperty(m.prototype,"lastChild",{get:function(){return this.children[this.children.length-1]||null}}),Object.defineProperty(m.prototype,"previousSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t-1]||null}}),Object.defineProperty(m.prototype,"nextSibling",{get:function(){var t;return t=this.parent.children.indexOf(this),this.parent.children[t+1]||null}}),Object.defineProperty(m.prototype,"ownerDocument",{get:function(){return this.document()||null}}),Object.defineProperty(m.prototype,"textContent",{get:function(){var t,n,r,s,o;if(this.nodeType===e.Element||this.nodeType===e.DocumentFragment){for(o="",n=0,r=(s=this.children).length;n<r;n++)(t=s[n]).textContent&&(o+=t.textContent);return o}return null},set:function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())}}),m.prototype.setParent=function(t){var e,n,r,s,o;for(this.parent=t,t&&(this.options=t.options,this.stringify=t.stringify),o=[],n=0,r=(s=this.children).length;n<r;n++)e=s[n],o.push(e.setParent(this));return o},m.prototype.element=function(t,e,n){var r,s,o,i,a,c,u,l,p,m,y;if(c=null,null===e&&null==n&&(e=(p=[{},null])[0],n=p[1]),null==e&&(e={}),e=h(e),g(e)||(n=(m=[e,n])[0],e=m[1]),null!=t&&(t=h(t)),Array.isArray(t))for(o=0,u=t.length;o<u;o++)s=t[o],c=this.element(s);else if(f(t))c=this.element(t.apply());else if(g(t)){for(a in t)if(w.call(t,a))if(y=t[a],f(y)&&(y=y.apply()),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===a.indexOf(this.stringify.convertAttKey))c=this.attribute(a.substr(this.stringify.convertAttKey.length),y);else if(!this.options.separateArrayItems&&Array.isArray(y)&&d(y))c=this.dummy();else if(g(y)&&d(y))c=this.element(a);else if(this.options.keepNullNodes||null!=y)if(!this.options.separateArrayItems&&Array.isArray(y))for(i=0,l=y.length;i<l;i++)s=y[i],(r={})[a]=s,c=this.element(r);else g(y)?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?c=this.element(y):(c=this.element(a)).element(y):c=this.element(a,y);else c=this.dummy()}else c=this.options.keepNullNodes||null!==n?!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===t.indexOf(this.stringify.convertTextKey)?this.text(n):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===t.indexOf(this.stringify.convertCDataKey)?this.cdata(n):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===t.indexOf(this.stringify.convertCommentKey)?this.comment(n):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===t.indexOf(this.stringify.convertRawKey)?this.raw(n):!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===t.indexOf(this.stringify.convertPIKey)?this.instruction(t.substr(this.stringify.convertPIKey.length),n):this.node(t,e,n):this.dummy();if(null==c)throw new Error("Could not create any elements with: "+t+". "+this.debugInfo());return c},m.prototype.insertBefore=function(t,e,n){var r,s,o,i,a;if(null!=t?t.type:void 0)return i=e,(o=t).setParent(this),i?(s=children.indexOf(i),a=children.splice(s),children.push(o),Array.prototype.push.apply(children,a)):children.push(o),o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return s=this.parent.children.indexOf(this),a=this.parent.children.splice(s),r=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,a),r},m.prototype.insertAfter=function(t,e,n){var r,s,o;if(this.isRoot)throw new Error("Cannot insert elements at root level. "+this.debugInfo(t));return s=this.parent.children.indexOf(this),o=this.parent.children.splice(s+1),r=this.parent.element(t,e,n),Array.prototype.push.apply(this.parent.children,o),r},m.prototype.remove=function(){var t;if(this.isRoot)throw new Error("Cannot remove the root element. "+this.debugInfo());return t=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[t,t-t+1].concat([])),this.parent},m.prototype.node=function(t,e,n){var r,s;return null!=t&&(t=h(t)),e||(e={}),e=h(e),g(e)||(n=(s=[e,n])[0],e=s[1]),r=new a(this,t,e),null!=n&&r.text(n),this.children.push(r),r},m.prototype.text=function(t){var e;return g(t)&&this.element(t),e=new p(this,t),this.children.push(e),this},m.prototype.cdata=function(t){var e;return e=new n(this,t),this.children.push(e),this},m.prototype.comment=function(t){var e;return e=new r(this,t),this.children.push(e),this},m.prototype.commentBefore=function(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this},m.prototype.commentAfter=function(t){var e,n;return e=this.parent.children.indexOf(this),n=this.parent.children.splice(e+1),this.parent.comment(t),Array.prototype.push.apply(this.parent.children,n),this},m.prototype.raw=function(t){var e;return e=new l(this,t),this.children.push(e),this},m.prototype.dummy=function(){return new i(this)},m.prototype.instruction=function(t,e){var n,r,s,o,i;if(null!=t&&(t=h(t)),null!=e&&(e=h(e)),Array.isArray(t))for(o=0,i=t.length;o<i;o++)n=t[o],this.instruction(n);else if(g(t))for(n in t)w.call(t,n)&&(r=t[n],this.instruction(n,r));else f(e)&&(e=e.apply()),s=new u(this,t,e),this.children.push(s);return this},m.prototype.instructionBefore=function(t,e){var n,r;return n=this.parent.children.indexOf(this),r=this.parent.children.splice(n),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this},m.prototype.instructionAfter=function(t,e){var n,r;return n=this.parent.children.indexOf(this),r=this.parent.children.splice(n+1),this.parent.instruction(t,e),Array.prototype.push.apply(this.parent.children,r),this},m.prototype.declaration=function(t,n,r){var o,i;return o=this.document(),i=new s(o,t,n,r),0===o.children.length?o.children.unshift(i):o.children[0].type===e.Declaration?o.children[0]=i:o.children.unshift(i),o.root()||o},m.prototype.dtd=function(t,n){var r,s,i,a,c,u,l,p,h;for(r=this.document(),s=new o(r,t,n),i=a=0,u=(p=r.children).length;a<u;i=++a)if(p[i].type===e.DocType)return r.children[i]=s,s;for(i=c=0,l=(h=r.children).length;c<l;i=++c)if(h[i].isRoot)return r.children.splice(i,0,s),s;return r.children.push(s),s},m.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},m.prototype.root=function(){var t;for(t=this;t;){if(t.type===e.Document)return t.rootObject;if(t.isRoot)return t;t=t.parent}},m.prototype.document=function(){var t;for(t=this;t;){if(t.type===e.Document)return t;t=t.parent}},m.prototype.end=function(t){return this.document().end(t)},m.prototype.prev=function(){var t;if((t=this.parent.children.indexOf(this))<1)throw new Error("Already at the first node. "+this.debugInfo());return this.parent.children[t-1]},m.prototype.next=function(){var t;if(-1===(t=this.parent.children.indexOf(this))||t===this.parent.children.length-1)throw new Error("Already at the last node. "+this.debugInfo());return this.parent.children[t+1]},m.prototype.importDocument=function(t){var e;return(e=t.root().clone()).parent=this,e.isRoot=!1,this.children.push(e),this},m.prototype.debugInfo=function(t){var e,n;return null!=(t=t||this.name)||(null!=(e=this.parent)?e.name:void 0)?null==t?"parent: <"+this.parent.name+">":(null!=(n=this.parent)?n.name:void 0)?"node: <"+t+">, parent: <"+this.parent.name+">":"node: <"+t+">":""},m.prototype.ele=function(t,e,n){return this.element(t,e,n)},m.prototype.nod=function(t,e,n){return this.node(t,e,n)},m.prototype.txt=function(t){return this.text(t)},m.prototype.dat=function(t){return this.cdata(t)},m.prototype.com=function(t){return this.comment(t)},m.prototype.ins=function(t,e){return this.instruction(t,e)},m.prototype.doc=function(){return this.document()},m.prototype.dec=function(t,e,n){return this.declaration(t,e,n)},m.prototype.e=function(t,e,n){return this.element(t,e,n)},m.prototype.n=function(t,e,n){return this.node(t,e,n)},m.prototype.t=function(t){return this.text(t)},m.prototype.d=function(t){return this.cdata(t)},m.prototype.c=function(t){return this.comment(t)},m.prototype.r=function(t){return this.raw(t)},m.prototype.i=function(t,e){return this.instruction(t,e)},m.prototype.u=function(){return this.up()},m.prototype.importXMLBuilder=function(t){return this.importDocument(t)},m.prototype.replaceChild=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.removeChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.appendChild=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.hasChildNodes=function(){return 0!==this.children.length},m.prototype.cloneNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.normalize=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.isSupported=function(t,e){return!0},m.prototype.hasAttributes=function(){return 0!==this.attribs.length},m.prototype.compareDocumentPosition=function(e){var n,r;return(n=this)===e?0:this.document()!==e.document()?(r=t.Disconnected|t.ImplementationSpecific,Math.random()<.5?r|=t.Preceding:r|=t.Following,r):n.isAncestor(e)?t.Contains|t.Preceding:n.isDescendant(e)?t.Contains|t.Following:n.isPreceding(e)?t.Preceding:t.Following},m.prototype.isSameNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.lookupPrefix=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.isDefaultNamespace=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.lookupNamespaceURI=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.isEqualNode=function(t){var e,n,r;if(t.nodeType!==this.nodeType)return!1;if(t.children.length!==this.children.length)return!1;for(e=n=0,r=this.children.length-1;0<=r?n<=r:n>=r;e=0<=r?++n:--n)if(!this.children[e].isEqualNode(t.children[e]))return!1;return!0},m.prototype.getFeature=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.setUserData=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.getUserData=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},m.prototype.contains=function(t){return!!t&&(t===this||this.isDescendant(t))},m.prototype.isDescendant=function(t){var e,n,r,s;for(n=0,r=(s=this.children).length;n<r;n++){if(t===(e=s[n]))return!0;if(e.isDescendant(t))return!0}return!1},m.prototype.isAncestor=function(t){return t.isDescendant(this)},m.prototype.isPreceding=function(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e<n},m.prototype.isFollowing=function(t){var e,n;return e=this.treePosition(t),n=this.treePosition(this),-1!==e&&-1!==n&&e>n},m.prototype.treePosition=function(t){var e,n;return n=0,e=!1,this.foreachTreeNode(this.document(),function(r){if(n++,!e&&r===t)return e=!0}),e?n:-1},m.prototype.foreachTreeNode=function(t,e){var n,r,s,o,i;for(t||(t=this.document()),r=0,s=(o=t.children).length;r<s;r++){if(i=e(n=o[r]))return i;if(i=this.foreachTreeNode(n,e))return i}},m}()}.call(re)),L.exports}var oe,ie={exports:{}},ae=ie.exports;function ce(){return oe||(oe=1,function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e={}.hasOwnProperty;ie.exports=function(){function n(n){var r,s,o;for(r in this.assertLegalName=t(this.assertLegalName,this),this.assertLegalChar=t(this.assertLegalChar,this),n||(n={}),this.options=n,this.options.version||(this.options.version="1.0"),s=n.stringify||{})e.call(s,r)&&(o=s[r],this[r]=o)}return n.prototype.name=function(t){return this.options.noValidation?t:this.assertLegalName(""+t||"")},n.prototype.text=function(t){return this.options.noValidation?t:this.assertLegalChar(this.textEscape(""+t||""))},n.prototype.cdata=function(t){return this.options.noValidation?t:(t=(t=""+t||"").replace("]]>","]]]]><![CDATA[>"),this.assertLegalChar(t))},n.prototype.comment=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return this.assertLegalChar(t)},n.prototype.raw=function(t){return this.options.noValidation?t:""+t||""},n.prototype.attValue=function(t){return this.options.noValidation?t:this.assertLegalChar(this.attEscape(t=""+t||""))},n.prototype.insTarget=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.insValue=function(t){if(this.options.noValidation)return t;if((t=""+t||"").match(/\?>/))throw new Error("Invalid processing instruction value: "+t);return this.assertLegalChar(t)},n.prototype.xmlVersion=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/1\.[0-9]+/))throw new Error("Invalid version number: "+t);return t},n.prototype.xmlEncoding=function(t){if(this.options.noValidation)return t;if(!(t=""+t||"").match(/^[A-Za-z](?:[A-Za-z0-9._-])*$/))throw new Error("Invalid encoding: "+t);return this.assertLegalChar(t)},n.prototype.xmlStandalone=function(t){return this.options.noValidation?t:t?"yes":"no"},n.prototype.dtdPubID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.dtdSysID=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.dtdElementValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.dtdAttType=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.dtdAttDefault=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.dtdEntityValue=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.dtdNData=function(t){return this.options.noValidation?t:this.assertLegalChar(""+t||"")},n.prototype.convertAttKey="@",n.prototype.convertPIKey="?",n.prototype.convertTextKey="#text",n.prototype.convertCDataKey="#cdata",n.prototype.convertCommentKey="#comment",n.prototype.convertRawKey="#raw",n.prototype.assertLegalChar=function(t){var e,n;if(this.options.noValidation)return t;if(e="","1.0"===this.options.version){if(e=/[\0-\x08\x0B\f\x0E-\x1F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=t.match(e))throw new Error("Invalid character in string: "+t+" at index "+n.index)}else if("1.1"===this.options.version&&(e=/[\0\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,n=t.match(e)))throw new Error("Invalid character in string: "+t+" at index "+n.index);return t},n.prototype.assertLegalName=function(t){var e;if(this.options.noValidation)return t;if(this.assertLegalChar(t),e=/^([:A-Z_a-z\xC0-\xD6\xD8-\xF6\xF8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])([\x2D\.0-:A-Z_a-z\xB7\xC0-\xD6\xD8-\xF6\xF8-\u037D\u037F-\u1FFF\u200C\u200D\u203F\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]|[\uD800-\uDB7F][\uDC00-\uDFFF])*$/,!t.match(e))throw new Error("Invalid character in name");return t},n.prototype.textEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;"))},n.prototype.attEscape=function(t){var e;return this.options.noValidation?t:(e=this.options.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,t.replace(e,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"))},n}()}.call(ae)),ie.exports}var ue,le={exports:{}},pe={exports:{}},he={exports:{}},de=he.exports;function fe(){return ue||(ue=1,function(){he.exports={None:0,OpenTag:1,InsideTag:2,CloseTag:3}}.call(de)),he.exports}var me,ge=pe.exports;function ye(){return me||(me=1,function(){var t,e,n,r={}.hasOwnProperty;n=m().assign,t=q(),pt(),Nt(),rt(),at(),G(),Rt(),Ft(),Bt(),Wt(),gt(),Et(),_t(),At(),e=fe(),pe.exports=function(){function s(t){var e,n,s;for(e in t||(t={}),this.options=t,n=t.writer||{})r.call(n,e)&&(s=n[e],this["_"+e]=this[e],this[e]=s)}return s.prototype.filterOptions=function(t){var r,s,o,i,a,c,u,l;return t||(t={}),t=n({},this.options,t),(r={writer:this}).pretty=t.pretty||!1,r.allowEmpty=t.allowEmpty||!1,r.indent=null!=(s=t.indent)?s:"  ",r.newline=null!=(o=t.newline)?o:"\n",r.offset=null!=(i=t.offset)?i:0,r.dontPrettyTextNodes=null!=(a=null!=(c=t.dontPrettyTextNodes)?c:t.dontprettytextnodes)?a:0,r.spaceBeforeSlash=null!=(u=null!=(l=t.spaceBeforeSlash)?l:t.spacebeforeslash)?u:"",!0===r.spaceBeforeSlash&&(r.spaceBeforeSlash=" "),r.suppressPrettyCount=0,r.user={},r.state=e.None,r},s.prototype.indent=function(t,e,n){var r;return!e.pretty||e.suppressPrettyCount?"":e.pretty&&(r=(n||0)+e.offset+1)>0?new Array(r).join(e.indent):""},s.prototype.endline=function(t,e,n){return!e.pretty||e.suppressPrettyCount?"":e.newline},s.prototype.attribute=function(t,e,n){var r;return this.openAttribute(t,e,n),r=" "+t.name+'="'+t.value+'"',this.closeAttribute(t,e,n),r},s.prototype.cdata=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"<![CDATA[",n.state=e.InsideTag,s+=t.value,n.state=e.CloseTag,s+="]]>"+this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.comment=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"\x3c!-- ",n.state=e.InsideTag,s+=t.value,n.state=e.CloseTag,s+=" --\x3e"+this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.declaration=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"<?xml",n.state=e.InsideTag,s+=' version="'+t.version+'"',null!=t.encoding&&(s+=' encoding="'+t.encoding+'"'),null!=t.standalone&&(s+=' standalone="'+t.standalone+'"'),n.state=e.CloseTag,s+=n.spaceBeforeSlash+"?>",s+=this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.docType=function(t,n,r){var s,o,i,a,c;if(r||(r=0),this.openNode(t,n,r),n.state=e.OpenTag,a=this.indent(t,n,r),a+="<!DOCTYPE "+t.root().name,t.pubID&&t.sysID?a+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(a+=' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(a+=" [",a+=this.endline(t,n,r),n.state=e.InsideTag,o=0,i=(c=t.children).length;o<i;o++)s=c[o],a+=this.writeChildNode(s,n,r+1);n.state=e.CloseTag,a+="]"}return n.state=e.CloseTag,a+=n.spaceBeforeSlash+">",a+=this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),a},s.prototype.element=function(n,s,o){var i,a,c,u,l,p,h,d,f,m,g,y,w,b;for(f in o||(o=0),m=!1,g="",this.openNode(n,s,o),s.state=e.OpenTag,g+=this.indent(n,s,o)+"<"+n.name,y=n.attribs)r.call(y,f)&&(i=y[f],g+=this.attribute(i,s,o));if(u=0===(c=n.children.length)?null:n.children[0],0===c||n.children.every(function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value}))s.allowEmpty?(g+=">",s.state=e.CloseTag,g+="</"+n.name+">"+this.endline(n,s,o)):(s.state=e.CloseTag,g+=s.spaceBeforeSlash+"/>"+this.endline(n,s,o));else if(!s.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){if(s.dontPrettyTextNodes)for(l=0,h=(w=n.children).length;l<h;l++)if(((a=w[l]).type===t.Text||a.type===t.Raw)&&null!=a.value){s.suppressPrettyCount++,m=!0;break}for(g+=">"+this.endline(n,s,o),s.state=e.InsideTag,p=0,d=(b=n.children).length;p<d;p++)a=b[p],g+=this.writeChildNode(a,s,o+1);s.state=e.CloseTag,g+=this.indent(n,s,o)+"</"+n.name+">",m&&s.suppressPrettyCount--,g+=this.endline(n,s,o),s.state=e.None}else g+=">",s.state=e.InsideTag,s.suppressPrettyCount++,m=!0,g+=this.writeChildNode(u,s,o+1),s.suppressPrettyCount--,m=!1,s.state=e.CloseTag,g+="</"+n.name+">"+this.endline(n,s,o);return this.closeNode(n,s,o),g},s.prototype.writeChildNode=function(e,n,r){switch(e.type){case t.CData:return this.cdata(e,n,r);case t.Comment:return this.comment(e,n,r);case t.Element:return this.element(e,n,r);case t.Raw:return this.raw(e,n,r);case t.Text:return this.text(e,n,r);case t.ProcessingInstruction:return this.processingInstruction(e,n,r);case t.Dummy:return"";case t.Declaration:return this.declaration(e,n,r);case t.DocType:return this.docType(e,n,r);case t.AttributeDeclaration:return this.dtdAttList(e,n,r);case t.ElementDeclaration:return this.dtdElement(e,n,r);case t.EntityDeclaration:return this.dtdEntity(e,n,r);case t.NotationDeclaration:return this.dtdNotation(e,n,r);default:throw new Error("Unknown XML node type: "+e.constructor.name)}},s.prototype.processingInstruction=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"<?",n.state=e.InsideTag,s+=t.target,t.value&&(s+=" "+t.value),n.state=e.CloseTag,s+=n.spaceBeforeSlash+"?>",s+=this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.raw=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r),n.state=e.InsideTag,s+=t.value,n.state=e.CloseTag,s+=this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.text=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r),n.state=e.InsideTag,s+=t.value,n.state=e.CloseTag,s+=this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.dtdAttList=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"<!ATTLIST",n.state=e.InsideTag,s+=" "+t.elementName+" "+t.attributeName+" "+t.attributeType,"#DEFAULT"!==t.defaultValueType&&(s+=" "+t.defaultValueType),t.defaultValue&&(s+=' "'+t.defaultValue+'"'),n.state=e.CloseTag,s+=n.spaceBeforeSlash+">"+this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.dtdElement=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"<!ELEMENT",n.state=e.InsideTag,s+=" "+t.name+" "+t.value,n.state=e.CloseTag,s+=n.spaceBeforeSlash+">"+this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.dtdEntity=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"<!ENTITY",n.state=e.InsideTag,t.pe&&(s+=" %"),s+=" "+t.name,t.value?s+=' "'+t.value+'"':(t.pubID&&t.sysID?s+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.sysID&&(s+=' SYSTEM "'+t.sysID+'"'),t.nData&&(s+=" NDATA "+t.nData)),n.state=e.CloseTag,s+=n.spaceBeforeSlash+">"+this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.dtdNotation=function(t,n,r){var s;return this.openNode(t,n,r),n.state=e.OpenTag,s=this.indent(t,n,r)+"<!NOTATION",n.state=e.InsideTag,s+=" "+t.name,t.pubID&&t.sysID?s+=' PUBLIC "'+t.pubID+'" "'+t.sysID+'"':t.pubID?s+=' PUBLIC "'+t.pubID+'"':t.sysID&&(s+=' SYSTEM "'+t.sysID+'"'),n.state=e.CloseTag,s+=n.spaceBeforeSlash+">"+this.endline(t,n,r),n.state=e.None,this.closeNode(t,n,r),s},s.prototype.openNode=function(t,e,n){},s.prototype.closeNode=function(t,e,n){},s.prototype.openAttribute=function(t,e,n){},s.prototype.closeAttribute=function(t,e,n){},s}()}.call(ge)),pe.exports}var we,be=le.exports;function _e(){return we||(we=1,function(){var t,e={}.hasOwnProperty;t=ye(),le.exports=function(t){function n(t){n.__super__.constructor.call(this,t)}return function(t,n){for(var r in n)e.call(n,r)&&(t[r]=n[r]);function s(){this.constructor=t}s.prototype=n.prototype,t.prototype=new s,t.__super__=n.prototype}(n,t),n.prototype.document=function(t,e){var n,r,s,o,i;for(e=this.filterOptions(e),o="",r=0,s=(i=t.children).length;r<s;r++)n=i[r],o+=this.writeChildNode(n,e,0);return e.pretty&&o.slice(-e.newline.length)===e.newline&&(o=o.slice(0,-e.newline.length)),o},n}(t)}.call(be)),le.exports}var ve,Te=v.exports;function xe(){return ve||(ve=1,function(){var t,e,n,r,s,o,i,a={}.hasOwnProperty;i=m().isPlainObject,n=b(),e=P(),r=se(),t=q(),o=ce(),s=_e(),v.exports=function(r){function c(n){c.__super__.constructor.call(this,null),this.name="#document",this.type=t.Document,this.documentURI=null,this.domConfig=new e,n||(n={}),n.writer||(n.writer=new s),this.options=n,this.stringify=new o(n)}return function(t,e){for(var n in e)a.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(c,r),Object.defineProperty(c.prototype,"implementation",{value:new n}),Object.defineProperty(c.prototype,"doctype",{get:function(){var e,n,r,s;for(n=0,r=(s=this.children).length;n<r;n++)if((e=s[n]).type===t.DocType)return e;return null}}),Object.defineProperty(c.prototype,"documentElement",{get:function(){return this.rootObject||null}}),Object.defineProperty(c.prototype,"inputEncoding",{get:function(){return null}}),Object.defineProperty(c.prototype,"strictErrorChecking",{get:function(){return!1}}),Object.defineProperty(c.prototype,"xmlEncoding",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].encoding:null}}),Object.defineProperty(c.prototype,"xmlStandalone",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration&&"yes"===this.children[0].standalone}}),Object.defineProperty(c.prototype,"xmlVersion",{get:function(){return 0!==this.children.length&&this.children[0].type===t.Declaration?this.children[0].version:"1.0"}}),Object.defineProperty(c.prototype,"URL",{get:function(){return this.documentURI}}),Object.defineProperty(c.prototype,"origin",{get:function(){return null}}),Object.defineProperty(c.prototype,"compatMode",{get:function(){return null}}),Object.defineProperty(c.prototype,"characterSet",{get:function(){return null}}),Object.defineProperty(c.prototype,"contentType",{get:function(){return null}}),c.prototype.end=function(t){var e;return e={},t?i(t)&&(e=t,t=this.options.writer):t=this.options.writer,t.document(this,t.filterOptions(e))},c.prototype.toString=function(t){return this.options.writer.document(this,this.options.writer.filterOptions(t))},c.prototype.createElement=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createDocumentFragment=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createTextNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createComment=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createCDATASection=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createProcessingInstruction=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createAttribute=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createEntityReference=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByTagName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.importNode=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createElementNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createAttributeNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByTagNameNS=function(t,e){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementById=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.adoptNode=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.normalizeDocument=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.renameNode=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.getElementsByClassName=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createEvent=function(t){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createRange=function(){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createNodeIterator=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},c.prototype.createTreeWalker=function(t,e,n){throw new Error("This DOM method is not implemented."+this.debugInfo())},c}(r)}.call(Te)),v.exports}var Ee,Oe={exports:{}},Ie=Oe.exports;function De(){return Ee||(Ee=1,function(){var t,e,n,r,s,o,i,a,c,u,l,p,h,d,f,g,y,w,b,_,v,T,x,E={}.hasOwnProperty;x=m(),v=x.isObject,_=x.isFunction,T=x.isPlainObject,b=x.getValue,t=q(),p=xe(),h=G(),r=rt(),s=at(),f=Rt(),w=Ft(),d=Bt(),u=pt(),l=Nt(),o=gt(),a=_t(),i=Et(),c=At(),n=U(),y=ce(),g=_e(),e=fe(),Oe.exports=function(){function m(e,n,r){var s;this.name="?xml",this.type=t.Document,e||(e={}),s={},e.writer?T(e.writer)&&(s=e.writer,e.writer=new g):e.writer=new g,this.options=e,this.writer=e.writer,this.writerOptions=this.writer.filterOptions(s),this.stringify=new y(e),this.onDataCallback=n||function(){},this.onEndCallback=r||function(){},this.currentNode=null,this.currentLevel=-1,this.openTags={},this.documentStarted=!1,this.documentCompleted=!1,this.root=null}return m.prototype.createChildNode=function(e){var n,r,s,o,i,a,c,u;switch(e.type){case t.CData:this.cdata(e.value);break;case t.Comment:this.comment(e.value);break;case t.Element:for(r in s={},c=e.attribs)E.call(c,r)&&(n=c[r],s[r]=n.value);this.node(e.name,s);break;case t.Dummy:this.dummy();break;case t.Raw:this.raw(e.value);break;case t.Text:this.text(e.value);break;case t.ProcessingInstruction:this.instruction(e.target,e.value);break;default:throw new Error("This XML node type is not supported in a JS object: "+e.constructor.name)}for(i=0,a=(u=e.children).length;i<a;i++)o=u[i],this.createChildNode(o),o.type===t.Element&&this.up();return this},m.prototype.dummy=function(){return this},m.prototype.node=function(t,e,n){var r;if(null==t)throw new Error("Missing node name.");if(this.root&&-1===this.currentLevel)throw new Error("Document can only have one root node. "+this.debugInfo(t));return this.openCurrent(),t=b(t),null==e&&(e={}),e=b(e),v(e)||(n=(r=[e,n])[0],e=r[1]),this.currentNode=new h(this,t,e),this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,null!=n&&this.text(n),this},m.prototype.element=function(e,n,r){var s,o,i,a,c,u;if(this.currentNode&&this.currentNode.type===t.DocType)this.dtdElement.apply(this,arguments);else if(Array.isArray(e)||v(e)||_(e))for(a=this.options.noValidation,this.options.noValidation=!0,(u=new p(this.options).element("TEMP_ROOT")).element(e),this.options.noValidation=a,o=0,i=(c=u.children).length;o<i;o++)s=c[o],this.createChildNode(s),s.type===t.Element&&this.up();else this.node(e,n,r);return this},m.prototype.attribute=function(t,e){var r,s;if(!this.currentNode||this.currentNode.children)throw new Error("att() can only be used immediately after an ele() call in callback mode. "+this.debugInfo(t));if(null!=t&&(t=b(t)),v(t))for(r in t)E.call(t,r)&&(s=t[r],this.attribute(r,s));else _(e)&&(e=e.apply()),this.options.keepNullAttributes&&null==e?this.currentNode.attribs[t]=new n(this,t,""):null!=e&&(this.currentNode.attribs[t]=new n(this,t,e));return this},m.prototype.text=function(t){var e;return this.openCurrent(),e=new w(this,t),this.onData(this.writer.text(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.cdata=function(t){var e;return this.openCurrent(),e=new r(this,t),this.onData(this.writer.cdata(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.comment=function(t){var e;return this.openCurrent(),e=new s(this,t),this.onData(this.writer.comment(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.raw=function(t){var e;return this.openCurrent(),e=new f(this,t),this.onData(this.writer.raw(e,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.instruction=function(t,e){var n,r,s,o,i;if(this.openCurrent(),null!=t&&(t=b(t)),null!=e&&(e=b(e)),Array.isArray(t))for(n=0,o=t.length;n<o;n++)r=t[n],this.instruction(r);else if(v(t))for(r in t)E.call(t,r)&&(s=t[r],this.instruction(r,s));else _(e)&&(e=e.apply()),i=new d(this,t,e),this.onData(this.writer.processingInstruction(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1);return this},m.prototype.declaration=function(t,e,n){var r;if(this.openCurrent(),this.documentStarted)throw new Error("declaration() must be the first node.");return r=new u(this,t,e,n),this.onData(this.writer.declaration(r,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.doctype=function(t,e,n){if(this.openCurrent(),null==t)throw new Error("Missing root node name.");if(this.root)throw new Error("dtd() must come before the root node.");return this.currentNode=new l(this,e,n),this.currentNode.rootNodeName=t,this.currentNode.children=!1,this.currentLevel++,this.openTags[this.currentLevel]=this.currentNode,this},m.prototype.dtdElement=function(t,e){var n;return this.openCurrent(),n=new i(this,t,e),this.onData(this.writer.dtdElement(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.attList=function(t,e,n,r,s){var i;return this.openCurrent(),i=new o(this,t,e,n,r,s),this.onData(this.writer.dtdAttList(i,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.entity=function(t,e){var n;return this.openCurrent(),n=new a(this,!1,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.pEntity=function(t,e){var n;return this.openCurrent(),n=new a(this,!0,t,e),this.onData(this.writer.dtdEntity(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.notation=function(t,e){var n;return this.openCurrent(),n=new c(this,t,e),this.onData(this.writer.dtdNotation(n,this.writerOptions,this.currentLevel+1),this.currentLevel+1),this},m.prototype.up=function(){if(this.currentLevel<0)throw new Error("The document node has no parent.");return this.currentNode?(this.currentNode.children?this.closeNode(this.currentNode):this.openNode(this.currentNode),this.currentNode=null):this.closeNode(this.openTags[this.currentLevel]),delete this.openTags[this.currentLevel],this.currentLevel--,this},m.prototype.end=function(){for(;this.currentLevel>=0;)this.up();return this.onEnd()},m.prototype.openCurrent=function(){if(this.currentNode)return this.currentNode.children=!0,this.openNode(this.currentNode)},m.prototype.openNode=function(n){var r,s,o,i;if(!n.isOpen){if(this.root||0!==this.currentLevel||n.type!==t.Element||(this.root=n),s="",n.type===t.Element){for(o in this.writerOptions.state=e.OpenTag,s=this.writer.indent(n,this.writerOptions,this.currentLevel)+"<"+n.name,i=n.attribs)E.call(i,o)&&(r=i[o],s+=this.writer.attribute(r,this.writerOptions,this.currentLevel));s+=(n.children?">":"/>")+this.writer.endline(n,this.writerOptions,this.currentLevel),this.writerOptions.state=e.InsideTag}else this.writerOptions.state=e.OpenTag,s=this.writer.indent(n,this.writerOptions,this.currentLevel)+"<!DOCTYPE "+n.rootNodeName,n.pubID&&n.sysID?s+=' PUBLIC "'+n.pubID+'" "'+n.sysID+'"':n.sysID&&(s+=' SYSTEM "'+n.sysID+'"'),n.children?(s+=" [",this.writerOptions.state=e.InsideTag):(this.writerOptions.state=e.CloseTag,s+=">"),s+=this.writer.endline(n,this.writerOptions,this.currentLevel);return this.onData(s,this.currentLevel),n.isOpen=!0}},m.prototype.closeNode=function(n){var r;if(!n.isClosed)return r="",this.writerOptions.state=e.CloseTag,r=n.type===t.Element?this.writer.indent(n,this.writerOptions,this.currentLevel)+"</"+n.name+">"+this.writer.endline(n,this.writerOptions,this.currentLevel):this.writer.indent(n,this.writerOptions,this.currentLevel)+"]>"+this.writer.endline(n,this.writerOptions,this.currentLevel),this.writerOptions.state=e.None,this.onData(r,this.currentLevel),n.isClosed=!0},m.prototype.onData=function(t,e){return this.documentStarted=!0,this.onDataCallback(t,e+1)},m.prototype.onEnd=function(){return this.documentCompleted=!0,this.onEndCallback()},m.prototype.debugInfo=function(t){return null==t?"":"node: <"+t+">"},m.prototype.ele=function(){return this.element.apply(this,arguments)},m.prototype.nod=function(t,e,n){return this.node(t,e,n)},m.prototype.txt=function(t){return this.text(t)},m.prototype.dat=function(t){return this.cdata(t)},m.prototype.com=function(t){return this.comment(t)},m.prototype.ins=function(t,e){return this.instruction(t,e)},m.prototype.dec=function(t,e,n){return this.declaration(t,e,n)},m.prototype.dtd=function(t,e,n){return this.doctype(t,e,n)},m.prototype.e=function(t,e,n){return this.element(t,e,n)},m.prototype.n=function(t,e,n){return this.node(t,e,n)},m.prototype.t=function(t){return this.text(t)},m.prototype.d=function(t){return this.cdata(t)},m.prototype.c=function(t){return this.comment(t)},m.prototype.r=function(t){return this.raw(t)},m.prototype.i=function(t,e){return this.instruction(t,e)},m.prototype.att=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},m.prototype.a=function(){return this.currentNode&&this.currentNode.type===t.DocType?this.attList.apply(this,arguments):this.attribute.apply(this,arguments)},m.prototype.ent=function(t,e){return this.entity(t,e)},m.prototype.pent=function(t,e){return this.pEntity(t,e)},m.prototype.not=function(t,e){return this.notation(t,e)},m}()}.call(Ie)),Oe.exports}var Ae,Se,ke,Ne={exports:{}},Pe=Ne.exports;function Ce(){return Ae||(Ae=1,function(){var t,e,n,r={}.hasOwnProperty;t=q(),n=ye(),e=fe(),Ne.exports=function(n){function s(t,e){this.stream=t,s.__super__.constructor.call(this,e)}return function(t,e){for(var n in e)r.call(e,n)&&(t[n]=e[n]);function s(){this.constructor=t}s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype}(s,n),s.prototype.endline=function(t,n,r){return t.isLastRootNode&&n.state===e.CloseTag?"":s.__super__.endline.call(this,t,n,r)},s.prototype.document=function(t,e){var n,r,s,o,i,a,c,u,l;for(r=s=0,i=(c=t.children).length;s<i;r=++s)(n=c[r]).isLastRootNode=r===t.children.length-1;for(e=this.filterOptions(e),l=[],o=0,a=(u=t.children).length;o<a;o++)n=u[o],l.push(this.writeChildNode(n,e,0));return l},s.prototype.attribute=function(t,e,n){return this.stream.write(s.__super__.attribute.call(this,t,e,n))},s.prototype.cdata=function(t,e,n){return this.stream.write(s.__super__.cdata.call(this,t,e,n))},s.prototype.comment=function(t,e,n){return this.stream.write(s.__super__.comment.call(this,t,e,n))},s.prototype.declaration=function(t,e,n){return this.stream.write(s.__super__.declaration.call(this,t,e,n))},s.prototype.docType=function(t,n,r){var s,o,i,a;if(r||(r=0),this.openNode(t,n,r),n.state=e.OpenTag,this.stream.write(this.indent(t,n,r)),this.stream.write("<!DOCTYPE "+t.root().name),t.pubID&&t.sysID?this.stream.write(' PUBLIC "'+t.pubID+'" "'+t.sysID+'"'):t.sysID&&this.stream.write(' SYSTEM "'+t.sysID+'"'),t.children.length>0){for(this.stream.write(" ["),this.stream.write(this.endline(t,n,r)),n.state=e.InsideTag,o=0,i=(a=t.children).length;o<i;o++)s=a[o],this.writeChildNode(s,n,r+1);n.state=e.CloseTag,this.stream.write("]")}return n.state=e.CloseTag,this.stream.write(n.spaceBeforeSlash+">"),this.stream.write(this.endline(t,n,r)),n.state=e.None,this.closeNode(t,n,r)},s.prototype.element=function(n,s,o){var i,a,c,u,l,p,h,d,f;for(h in o||(o=0),this.openNode(n,s,o),s.state=e.OpenTag,this.stream.write(this.indent(n,s,o)+"<"+n.name),d=n.attribs)r.call(d,h)&&(i=d[h],this.attribute(i,s,o));if(u=0===(c=n.children.length)?null:n.children[0],0===c||n.children.every(function(e){return(e.type===t.Text||e.type===t.Raw)&&""===e.value}))s.allowEmpty?(this.stream.write(">"),s.state=e.CloseTag,this.stream.write("</"+n.name+">")):(s.state=e.CloseTag,this.stream.write(s.spaceBeforeSlash+"/>"));else if(!s.pretty||1!==c||u.type!==t.Text&&u.type!==t.Raw||null==u.value){for(this.stream.write(">"+this.endline(n,s,o)),s.state=e.InsideTag,l=0,p=(f=n.children).length;l<p;l++)a=f[l],this.writeChildNode(a,s,o+1);s.state=e.CloseTag,this.stream.write(this.indent(n,s,o)+"</"+n.name+">")}else this.stream.write(">"),s.state=e.InsideTag,s.suppressPrettyCount++,this.writeChildNode(u,s,o+1),s.suppressPrettyCount--,s.state=e.CloseTag,this.stream.write("</"+n.name+">");return this.stream.write(this.endline(n,s,o)),s.state=e.None,this.closeNode(n,s,o)},s.prototype.processingInstruction=function(t,e,n){return this.stream.write(s.__super__.processingInstruction.call(this,t,e,n))},s.prototype.raw=function(t,e,n){return this.stream.write(s.__super__.raw.call(this,t,e,n))},s.prototype.text=function(t,e,n){return this.stream.write(s.__super__.text.call(this,t,e,n))},s.prototype.dtdAttList=function(t,e,n){return this.stream.write(s.__super__.dtdAttList.call(this,t,e,n))},s.prototype.dtdElement=function(t,e,n){return this.stream.write(s.__super__.dtdElement.call(this,t,e,n))},s.prototype.dtdEntity=function(t,e,n){return this.stream.write(s.__super__.dtdEntity.call(this,t,e,n))},s.prototype.dtdNotation=function(t,e,n){return this.stream.write(s.__super__.dtdNotation.call(this,t,e,n))},s}(n)}.call(Pe)),Ne.exports}function Le(){return ke||(ke=1,function(){var t,e,n,r,s,o={}.hasOwnProperty;Se||(Se=1,function(){var t,e,n,r,s,o,i,a,c,u;u=m(),a=u.assign,c=u.isFunction,n=b(),r=xe(),s=De(),i=_e(),o=Ce(),t=q(),e=fe(),d.create=function(t,e,n,s){var o,i;if(null==t)throw new Error("Root element needs a name.");return s=a({},e,n,s),i=(o=new r(s)).element(t),s.headless||(o.declaration(s),null==s.pubID&&null==s.sysID||o.dtd(s)),i},d.begin=function(t,e,n){var o;return c(t)&&(e=(o=[t,e])[0],n=o[1],t={}),e?new s(t,e,n):new r(t)},d.stringWriter=function(t){return new i(t)},d.streamWriter=function(t,e){return new o(t,e)},d.implementation=new n,d.nodeType=t,d.writerState=e}.call(d)),t=d,e=l().defaults,r=function(t){return"string"==typeof t&&(t.indexOf("&")>=0||t.indexOf(">")>=0||t.indexOf("<")>=0)},s=function(t){return"<![CDATA["+n(t)+"]]>"},n=function(t){return t.replace("]]>","]]]]><![CDATA[>")},h.Builder=function(){function n(t){var n,r,s;for(n in this.options={},r=e[.2])o.call(r,n)&&(s=r[n],this.options[n]=s);for(n in t)o.call(t,n)&&(s=t[n],this.options[n]=s)}return n.prototype.buildObject=function(n){var i,a,c,u,l,p;return i=this.options.attrkey,a=this.options.charkey,1===Object.keys(n).length&&this.options.rootName===e[.2].rootName?n=n[l=Object.keys(n)[0]]:l=this.options.rootName,p=this,c=function(t,e){var n,u,l,h,d,f;if("object"!=typeof e)p.options.cdata&&r(e)?t.raw(s(e)):t.txt(e);else if(Array.isArray(e)){for(h in e)if(o.call(e,h))for(d in u=e[h])l=u[d],t=c(t.ele(d),l).up()}else for(d in e)if(o.call(e,d))if(u=e[d],d===i){if("object"==typeof u)for(n in u)f=u[n],t=t.att(n,f)}else if(d===a)t=p.options.cdata&&r(u)?t.raw(s(u)):t.txt(u);else if(Array.isArray(u))for(h in u)o.call(u,h)&&(t="string"==typeof(l=u[h])?p.options.cdata&&r(l)?t.ele(d).raw(s(l)).up():t.ele(d,l).up():c(t.ele(d),l).up());else"object"==typeof u?t=c(t.ele(d),u).up():"string"==typeof u&&p.options.cdata&&r(u)?t=t.ele(d).raw(s(u)).up():(null==u&&(u=""),t=t.ele(d,u.toString()).up());return t},u=t.create(l,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),c(u,n).end(this.options.renderOpts)},n}()}.call(h)),h}var Re,$e={},je={};function qe(){return Re||(Re=1,function(t){t.parser=function(t,e){return new s(t,e)},t.SAXParser=s,t.SAXStream=i,t.createStream=function(t,e){return new i(t,e)},t.MAX_BUFFER_LENGTH=65536;var e,r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];function s(e,n){if(!(this instanceof s))return new s(e,n);var o=this;!function(t){for(var e=0,n=r.length;e<n;e++)t[r[e]]=""}(o),o.q=o.c="",o.bufferCheckPosition=t.MAX_BUFFER_LENGTH,o.opt=n||{},o.opt.lowercase=o.opt.lowercase||o.opt.lowercasetags,o.looseCase=o.opt.lowercase?"toLowerCase":"toUpperCase",o.tags=[],o.closed=o.closedRoot=o.sawRoot=!1,o.tag=o.error=null,o.strict=!!e,o.noscript=!(!e&&!o.opt.noscript),o.state=E.BEGIN,o.strictEntities=o.opt.strictEntities,o.ENTITIES=o.strictEntities?Object.create(t.XML_ENTITIES):Object.create(t.ENTITIES),o.attribList=[],o.opt.xmlns&&(o.ns=Object.create(p)),void 0===o.opt.unquotedAttributeValues&&(o.opt.unquotedAttributeValues=!e),o.trackPosition=!1!==o.opt.position,o.trackPosition&&(o.position=o.line=o.column=0),I(o,"onready")}t.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(t){function e(){}return e.prototype=t,new e}),Object.keys||(Object.keys=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}),s.prototype={end:function(){N(this)},write:function(e){var n=this;if(this.error)throw this.error;if(n.closed)return k(n,"Cannot write after close. Assign an onready handler.");if(null===e)return N(n);"object"==typeof e&&(e=e.toString());for(var s=0,o="";o=M(e,s++),n.c=o,o;)switch(n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++),n.state){case E.BEGIN:if(n.state=E.BEGIN_WHITESPACE,"\ufeff"===o)continue;F(n,o);continue;case E.BEGIN_WHITESPACE:F(n,o);continue;case E.TEXT:if(n.sawRoot&&!n.closedRoot){for(var i=s-1;o&&"<"!==o&&"&"!==o;)(o=M(e,s++))&&n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++);n.textNode+=e.substring(i,s-1)}"<"!==o||n.sawRoot&&n.closedRoot&&!n.strict?(g(o)||n.sawRoot&&!n.closedRoot||P(n,"Text data outside of root node."),"&"===o?n.state=E.TEXT_ENTITY:n.textNode+=o):(n.state=E.OPEN_WAKA,n.startTagPosition=n.position);continue;case E.SCRIPT:"<"===o?n.state=E.SCRIPT_ENDING:n.script+=o;continue;case E.SCRIPT_ENDING:"/"===o?n.state=E.CLOSE_TAG:(n.script+="<"+o,n.state=E.SCRIPT);continue;case E.OPEN_WAKA:if("!"===o)n.state=E.SGML_DECL,n.sgmlDecl="";else if(g(o));else if(b(h,o))n.state=E.OPEN_TAG,n.tagName=o;else if("/"===o)n.state=E.CLOSE_TAG,n.tagName="";else if("?"===o)n.state=E.PROC_INST,n.procInstName=n.procInstBody="";else{if(P(n,"Unencoded <"),n.startTagPosition+1<n.position){var u=n.position-n.startTagPosition;o=new Array(u).join(" ")+o}n.textNode+="<"+o,n.state=E.TEXT}continue;case E.SGML_DECL:if(n.sgmlDecl+o==="--"){n.state=E.COMMENT,n.comment="",n.sgmlDecl="";continue}n.doctype&&!0!==n.doctype&&n.sgmlDecl?(n.state=E.DOCTYPE_DTD,n.doctype+="<!"+n.sgmlDecl+o,n.sgmlDecl=""):(n.sgmlDecl+o).toUpperCase()===a?(D(n,"onopencdata"),n.state=E.CDATA,n.sgmlDecl="",n.cdata=""):(n.sgmlDecl+o).toUpperCase()===c?(n.state=E.DOCTYPE,(n.doctype||n.sawRoot)&&P(n,"Inappropriately located doctype declaration"),n.doctype="",n.sgmlDecl=""):">"===o?(D(n,"onsgmldeclaration",n.sgmlDecl),n.sgmlDecl="",n.state=E.TEXT):y(o)?(n.state=E.SGML_DECL_QUOTED,n.sgmlDecl+=o):n.sgmlDecl+=o;continue;case E.SGML_DECL_QUOTED:o===n.q&&(n.state=E.SGML_DECL,n.q=""),n.sgmlDecl+=o;continue;case E.DOCTYPE:">"===o?(n.state=E.TEXT,D(n,"ondoctype",n.doctype),n.doctype=!0):(n.doctype+=o,"["===o?n.state=E.DOCTYPE_DTD:y(o)&&(n.state=E.DOCTYPE_QUOTED,n.q=o));continue;case E.DOCTYPE_QUOTED:n.doctype+=o,o===n.q&&(n.q="",n.state=E.DOCTYPE);continue;case E.DOCTYPE_DTD:"]"===o?(n.doctype+=o,n.state=E.DOCTYPE):"<"===o?(n.state=E.OPEN_WAKA,n.startTagPosition=n.position):y(o)?(n.doctype+=o,n.state=E.DOCTYPE_DTD_QUOTED,n.q=o):n.doctype+=o;continue;case E.DOCTYPE_DTD_QUOTED:n.doctype+=o,o===n.q&&(n.state=E.DOCTYPE_DTD,n.q="");continue;case E.COMMENT:"-"===o?n.state=E.COMMENT_ENDING:n.comment+=o;continue;case E.COMMENT_ENDING:"-"===o?(n.state=E.COMMENT_ENDED,n.comment=S(n.opt,n.comment),n.comment&&D(n,"oncomment",n.comment),n.comment=""):(n.comment+="-"+o,n.state=E.COMMENT);continue;case E.COMMENT_ENDED:">"!==o?(P(n,"Malformed comment"),n.comment+="--"+o,n.state=E.COMMENT):n.doctype&&!0!==n.doctype?n.state=E.DOCTYPE_DTD:n.state=E.TEXT;continue;case E.CDATA:for(i=s-1;o&&"]"!==o;)(o=M(e,s++))&&n.trackPosition&&(n.position++,"\n"===o?(n.line++,n.column=0):n.column++);n.cdata+=e.substring(i,s-1),"]"===o&&(n.state=E.CDATA_ENDING);continue;case E.CDATA_ENDING:"]"===o?n.state=E.CDATA_ENDING_2:(n.cdata+="]"+o,n.state=E.CDATA);continue;case E.CDATA_ENDING_2:">"===o?(n.cdata&&D(n,"oncdata",n.cdata),D(n,"onclosecdata"),n.cdata="",n.state=E.TEXT):"]"===o?n.cdata+="]":(n.cdata+="]]"+o,n.state=E.CDATA);continue;case E.PROC_INST:"?"===o?n.state=E.PROC_INST_ENDING:g(o)?n.state=E.PROC_INST_BODY:n.procInstName+=o;continue;case E.PROC_INST_BODY:if(!n.procInstBody&&g(o))continue;"?"===o?n.state=E.PROC_INST_ENDING:n.procInstBody+=o;continue;case E.PROC_INST_ENDING:">"===o?(D(n,"onprocessinginstruction",{name:n.procInstName,body:n.procInstBody}),n.procInstName=n.procInstBody="",n.state=E.TEXT):(n.procInstBody+="?"+o,n.state=E.PROC_INST_BODY);continue;case E.OPEN_TAG:b(d,o)?n.tagName+=o:(C(n),">"===o?$(n):"/"===o?n.state=E.OPEN_TAG_SLASH:(g(o)||P(n,"Invalid character in tag name"),n.state=E.ATTRIB));continue;case E.OPEN_TAG_SLASH:">"===o?($(n,!0),j(n)):(P(n,"Forward-slash in opening tag not followed by >"),n.state=E.ATTRIB);continue;case E.ATTRIB:if(g(o))continue;">"===o?$(n):"/"===o?n.state=E.OPEN_TAG_SLASH:b(h,o)?(n.attribName=o,n.attribValue="",n.state=E.ATTRIB_NAME):P(n,"Invalid attribute name");continue;case E.ATTRIB_NAME:"="===o?n.state=E.ATTRIB_VALUE:">"===o?(P(n,"Attribute without value"),n.attribValue=n.attribName,R(n),$(n)):g(o)?n.state=E.ATTRIB_NAME_SAW_WHITE:b(d,o)?n.attribName+=o:P(n,"Invalid attribute name");continue;case E.ATTRIB_NAME_SAW_WHITE:if("="===o)n.state=E.ATTRIB_VALUE;else{if(g(o))continue;P(n,"Attribute without value"),n.tag.attributes[n.attribName]="",n.attribValue="",D(n,"onattribute",{name:n.attribName,value:""}),n.attribName="",">"===o?$(n):b(h,o)?(n.attribName=o,n.state=E.ATTRIB_NAME):(P(n,"Invalid attribute name"),n.state=E.ATTRIB)}continue;case E.ATTRIB_VALUE:if(g(o))continue;y(o)?(n.q=o,n.state=E.ATTRIB_VALUE_QUOTED):(n.opt.unquotedAttributeValues||k(n,"Unquoted attribute value"),n.state=E.ATTRIB_VALUE_UNQUOTED,n.attribValue=o);continue;case E.ATTRIB_VALUE_QUOTED:if(o!==n.q){"&"===o?n.state=E.ATTRIB_VALUE_ENTITY_Q:n.attribValue+=o;continue}R(n),n.q="",n.state=E.ATTRIB_VALUE_CLOSED;continue;case E.ATTRIB_VALUE_CLOSED:g(o)?n.state=E.ATTRIB:">"===o?$(n):"/"===o?n.state=E.OPEN_TAG_SLASH:b(h,o)?(P(n,"No whitespace between attributes"),n.attribName=o,n.attribValue="",n.state=E.ATTRIB_NAME):P(n,"Invalid attribute name");continue;case E.ATTRIB_VALUE_UNQUOTED:if(!w(o)){"&"===o?n.state=E.ATTRIB_VALUE_ENTITY_U:n.attribValue+=o;continue}R(n),">"===o?$(n):n.state=E.ATTRIB;continue;case E.CLOSE_TAG:if(n.tagName)">"===o?j(n):b(d,o)?n.tagName+=o:n.script?(n.script+="</"+n.tagName,n.tagName="",n.state=E.SCRIPT):(g(o)||P(n,"Invalid tagname in closing tag"),n.state=E.CLOSE_TAG_SAW_WHITE);else{if(g(o))continue;_(h,o)?n.script?(n.script+="</"+o,n.state=E.SCRIPT):P(n,"Invalid tagname in closing tag."):n.tagName=o}continue;case E.CLOSE_TAG_SAW_WHITE:if(g(o))continue;">"===o?j(n):P(n,"Invalid characters in closing tag");continue;case E.TEXT_ENTITY:case E.ATTRIB_VALUE_ENTITY_Q:case E.ATTRIB_VALUE_ENTITY_U:var l,p;switch(n.state){case E.TEXT_ENTITY:l=E.TEXT,p="textNode";break;case E.ATTRIB_VALUE_ENTITY_Q:l=E.ATTRIB_VALUE_QUOTED,p="attribValue";break;case E.ATTRIB_VALUE_ENTITY_U:l=E.ATTRIB_VALUE_UNQUOTED,p="attribValue"}if(";"===o){var v=q(n);n.opt.unparsedEntities&&!Object.values(t.XML_ENTITIES).includes(v)?(n.entity="",n.state=l,n.write(v)):(n[p]+=v,n.entity="",n.state=l)}else b(n.entity.length?m:f,o)?n.entity+=o:(P(n,"Invalid character in entity name"),n[p]+="&"+n.entity+o,n.entity="",n.state=l);continue;default:throw new Error(n,"Unknown state: "+n.state)}return n.position>=n.bufferCheckPosition&&function(e){for(var n=Math.max(t.MAX_BUFFER_LENGTH,10),s=0,o=0,i=r.length;o<i;o++){var a=e[r[o]].length;if(a>n)switch(r[o]){case"textNode":A(e);break;case"cdata":D(e,"oncdata",e.cdata),e.cdata="";break;case"script":D(e,"onscript",e.script),e.script="";break;default:k(e,"Max buffer length exceeded: "+r[o])}s=Math.max(s,a)}var c=t.MAX_BUFFER_LENGTH-s;e.bufferCheckPosition=c+e.position}(n),n}
/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){!function(t){A(t),""!==t.cdata&&(D(t,"oncdata",t.cdata),t.cdata=""),""!==t.script&&(D(t,"onscript",t.script),t.script="")}(this)}};try{e=require("stream").Stream}catch(t){e=function(){}}e||(e=function(){});var o=t.EVENTS.filter(function(t){return"error"!==t&&"end"!==t});function i(t,n){if(!(this instanceof i))return new i(t,n);e.apply(this),this._parser=new s(t,n),this.writable=!0,this.readable=!0;var r=this;this._parser.onend=function(){r.emit("end")},this._parser.onerror=function(t){r.emit("error",t),r._parser.error=null},this._decoder=null,o.forEach(function(t){Object.defineProperty(r,"on"+t,{get:function(){return r._parser["on"+t]},set:function(e){if(!e)return r.removeAllListeners(t),r._parser["on"+t]=e,e;r.on(t,e)},enumerable:!0,configurable:!1})})}i.prototype=Object.create(e.prototype,{constructor:{value:i}}),i.prototype.write=function(t){if("function"==typeof Buffer&&"function"==typeof Buffer.isBuffer&&Buffer.isBuffer(t)){if(!this._decoder){var e=n.StringDecoder;this._decoder=new e("utf8")}t=this._decoder.write(t)}return this._parser.write(t.toString()),this.emit("data",t),!0},i.prototype.end=function(t){return t&&t.length&&this.write(t),this._parser.end(),!0},i.prototype.on=function(t,n){var r=this;return r._parser["on"+t]||-1===o.indexOf(t)||(r._parser["on"+t]=function(){var e=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);e.splice(0,0,t),r.emit.apply(r,e)}),e.prototype.on.call(r,t,n)};var a="[CDATA[",c="DOCTYPE",u="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/2000/xmlns/",p={xml:u,xmlns:l},h=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,d=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,f=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,m=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function g(t){return" "===t||"\n"===t||"\r"===t||"\t"===t}function y(t){return'"'===t||"'"===t}function w(t){return">"===t||g(t)}function b(t,e){return t.test(e)}function _(t,e){return!b(t,e)}var v,T,x,E=0;for(var O in t.STATE={BEGIN:E++,BEGIN_WHITESPACE:E++,TEXT:E++,TEXT_ENTITY:E++,OPEN_WAKA:E++,SGML_DECL:E++,SGML_DECL_QUOTED:E++,DOCTYPE:E++,DOCTYPE_QUOTED:E++,DOCTYPE_DTD:E++,DOCTYPE_DTD_QUOTED:E++,COMMENT_STARTING:E++,COMMENT:E++,COMMENT_ENDING:E++,COMMENT_ENDED:E++,CDATA:E++,CDATA_ENDING:E++,CDATA_ENDING_2:E++,PROC_INST:E++,PROC_INST_BODY:E++,PROC_INST_ENDING:E++,OPEN_TAG:E++,OPEN_TAG_SLASH:E++,ATTRIB:E++,ATTRIB_NAME:E++,ATTRIB_NAME_SAW_WHITE:E++,ATTRIB_VALUE:E++,ATTRIB_VALUE_QUOTED:E++,ATTRIB_VALUE_CLOSED:E++,ATTRIB_VALUE_UNQUOTED:E++,ATTRIB_VALUE_ENTITY_Q:E++,ATTRIB_VALUE_ENTITY_U:E++,CLOSE_TAG:E++,CLOSE_TAG_SAW_WHITE:E++,SCRIPT:E++,SCRIPT_ENDING:E++},t.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},t.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(t.ENTITIES).forEach(function(e){var n=t.ENTITIES[e],r="number"==typeof n?String.fromCharCode(n):n;t.ENTITIES[e]=r}),t.STATE)t.STATE[t.STATE[O]]=O;function I(t,e,n){t[e]&&t[e](n)}function D(t,e,n){t.textNode&&A(t),I(t,e,n)}function A(t){t.textNode=S(t.opt,t.textNode),t.textNode&&I(t,"ontext",t.textNode),t.textNode=""}function S(t,e){return t.trim&&(e=e.trim()),t.normalize&&(e=e.replace(/\s+/g," ")),e}function k(t,e){return A(t),t.trackPosition&&(e+="\nLine: "+t.line+"\nColumn: "+t.column+"\nChar: "+t.c),e=new Error(e),t.error=e,I(t,"onerror",e),t}function N(t){return t.sawRoot&&!t.closedRoot&&P(t,"Unclosed root tag"),t.state!==E.BEGIN&&t.state!==E.BEGIN_WHITESPACE&&t.state!==E.TEXT&&k(t,"Unexpected end"),A(t),t.c="",t.closed=!0,I(t,"onend"),s.call(t,t.strict,t.opt),t}function P(t,e){if("object"!=typeof t||!(t instanceof s))throw new Error("bad call to strictFail");t.strict&&k(t,e)}function C(t){t.strict||(t.tagName=t.tagName[t.looseCase]());var e=t.tags[t.tags.length-1]||t,n=t.tag={name:t.tagName,attributes:{}};t.opt.xmlns&&(n.ns=e.ns),t.attribList.length=0,D(t,"onopentagstart",n)}function L(t,e){var n=t.indexOf(":")<0?["",t]:t.split(":"),r=n[0],s=n[1];return e&&"xmlns"===t&&(r="xmlns",s=""),{prefix:r,local:s}}function R(t){if(t.strict||(t.attribName=t.attribName[t.looseCase]()),-1!==t.attribList.indexOf(t.attribName)||t.tag.attributes.hasOwnProperty(t.attribName))t.attribName=t.attribValue="";else{if(t.opt.xmlns){var e=L(t.attribName,!0),n=e.prefix,r=e.local;if("xmlns"===n)if("xml"===r&&t.attribValue!==u)P(t,"xml: prefix must be bound to "+u+"\nActual: "+t.attribValue);else if("xmlns"===r&&t.attribValue!==l)P(t,"xmlns: prefix must be bound to "+l+"\nActual: "+t.attribValue);else{var s=t.tag,o=t.tags[t.tags.length-1]||t;s.ns===o.ns&&(s.ns=Object.create(o.ns)),s.ns[r]=t.attribValue}t.attribList.push([t.attribName,t.attribValue])}else t.tag.attributes[t.attribName]=t.attribValue,D(t,"onattribute",{name:t.attribName,value:t.attribValue});t.attribName=t.attribValue=""}}function $(t,e){if(t.opt.xmlns){var n=t.tag,r=L(t.tagName);n.prefix=r.prefix,n.local=r.local,n.uri=n.ns[r.prefix]||"",n.prefix&&!n.uri&&(P(t,"Unbound namespace prefix: "+JSON.stringify(t.tagName)),n.uri=r.prefix);var s=t.tags[t.tags.length-1]||t;n.ns&&s.ns!==n.ns&&Object.keys(n.ns).forEach(function(e){D(t,"onopennamespace",{prefix:e,uri:n.ns[e]})});for(var o=0,i=t.attribList.length;o<i;o++){var a=t.attribList[o],c=a[0],u=a[1],l=L(c,!0),p=l.prefix,h=l.local,d=""===p?"":n.ns[p]||"",f={name:c,value:u,prefix:p,local:h,uri:d};p&&"xmlns"!==p&&!d&&(P(t,"Unbound namespace prefix: "+JSON.stringify(p)),f.uri=p),t.tag.attributes[c]=f,D(t,"onattribute",f)}t.attribList.length=0}t.tag.isSelfClosing=!!e,t.sawRoot=!0,t.tags.push(t.tag),D(t,"onopentag",t.tag),e||(t.noscript||"script"!==t.tagName.toLowerCase()?t.state=E.TEXT:t.state=E.SCRIPT,t.tag=null,t.tagName=""),t.attribName=t.attribValue="",t.attribList.length=0}function j(t){if(!t.tagName)return P(t,"Weird empty close tag."),t.textNode+="</>",void(t.state=E.TEXT);if(t.script){if("script"!==t.tagName)return t.script+="</"+t.tagName+">",t.tagName="",void(t.state=E.SCRIPT);D(t,"onscript",t.script),t.script=""}var e=t.tags.length,n=t.tagName;t.strict||(n=n[t.looseCase]());for(var r=n;e--&&t.tags[e].name!==r;)P(t,"Unexpected close tag");if(e<0)return P(t,"Unmatched closing tag: "+t.tagName),t.textNode+="</"+t.tagName+">",void(t.state=E.TEXT);t.tagName=n;for(var s=t.tags.length;s-- >e;){var o=t.tag=t.tags.pop();t.tagName=t.tag.name,D(t,"onclosetag",t.tagName);var i={};for(var a in o.ns)i[a]=o.ns[a];var c=t.tags[t.tags.length-1]||t;t.opt.xmlns&&o.ns!==c.ns&&Object.keys(o.ns).forEach(function(e){var n=o.ns[e];D(t,"onclosenamespace",{prefix:e,uri:n})})}0===e&&(t.closedRoot=!0),t.tagName=t.attribValue=t.attribName="",t.attribList.length=0,t.state=E.TEXT}function q(t){var e,n=t.entity,r=n.toLowerCase(),s="";return t.ENTITIES[n]?t.ENTITIES[n]:t.ENTITIES[r]?t.ENTITIES[r]:("#"===(n=r).charAt(0)&&("x"===n.charAt(1)?(n=n.slice(2),s=(e=parseInt(n,16)).toString(16)):(n=n.slice(1),s=(e=parseInt(n,10)).toString(10))),n=n.replace(/^0+/,""),isNaN(e)||s.toLowerCase()!==n||e<0||e>1114111?(P(t,"Invalid character entity"),"&"+t.entity+";"):String.fromCodePoint(e))}function F(t,e){"<"===e?(t.state=E.OPEN_WAKA,t.startTagPosition=t.position):g(e)||(P(t,"Non-whitespace before first tag."),t.textNode=e,t.state=E.TEXT)}function M(t,e){var n="";return e<t.length&&(n=t.charAt(e)),n}E=t.STATE,String.fromCodePoint||(v=String.fromCharCode,T=Math.floor,x=function(){var t,e,n=[],r=-1,s=arguments.length;if(!s)return"";for(var o="";++r<s;){var i=Number(arguments[r]);if(!isFinite(i)||i<0||i>1114111||T(i)!==i)throw RangeError("Invalid code point: "+i);i<=65535?n.push(i):(t=55296+((i-=65536)>>10),e=i%1024+56320,n.push(t,e)),(r+1===s||n.length>16384)&&(o+=v.apply(null,n),n.length=0)}return o},Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:x,configurable:!0,writable:!0}):String.fromCodePoint=x)}(je)),je}var Fe,Me={};function ze(){return Fe||(Fe=1,function(){Me.stripBOM=function(t){return"\ufeff"===t[0]?t.substring(1):t}}.call(Me)),Me}var Ue,Be,Ve,Ze={};function He(){return Ue||(Ue=1,function(){var t;t=new RegExp(/(?!xmlns)^.*:/),Ze.normalize=function(t){return t.toLowerCase()},Ze.firstCharLowerCase=function(t){return t.charAt(0).toLowerCase()+t.slice(1)},Ze.stripPrefix=function(e){return e.replace(t,"")},Ze.parseNumbers=function(t){return isNaN(t)||(t=t%1==0?parseInt(t,10):parseFloat(t)),t},Ze.parseBooleans=function(t){return/^(?:true|false)$/i.test(t)&&(t="true"===t.toLowerCase()),t}}.call(Ze)),Ze}function We(){return Be||(Be=1,t=$e,function(){var e,n,o,i,a,c,u,p,h=function(t,e){return function(){return t.apply(e,arguments)}},d={}.hasOwnProperty;u=qe(),o=r,e=ze(),c=He(),p=s.setImmediate,n=l().defaults,i=function(t){return"object"==typeof t&&null!=t&&0===Object.keys(t).length},a=function(t,e,n){var r,s;for(r=0,s=t.length;r<s;r++)e=(0,t[r])(e,n);return e},t.Parser=function(r){function s(e){var r,s,o;if(this.parseStringPromise=h(this.parseStringPromise,this),this.parseString=h(this.parseString,this),this.reset=h(this.reset,this),this.assignOrPush=h(this.assignOrPush,this),this.processAsync=h(this.processAsync,this),!(this instanceof t.Parser))return new t.Parser(e);for(r in this.options={},s=n[.2])d.call(s,r)&&(o=s[r],this.options[r]=o);for(r in e)d.call(e,r)&&(o=e[r],this.options[r]=o);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(c.normalize)),this.reset()}return function(t,e){for(var n in e)d.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(s,r),s.prototype.processAsync=function(){var t,e;try{return this.remaining.length<=this.options.chunkSize?(t=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(t),this.saxParser.close()):(t=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(t),p(this.processAsync))}catch(t){if(e=t,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(e)}},s.prototype.assignOrPush=function(t,e,n){return e in t?(t[e]instanceof Array||(t[e]=[t[e]]),t[e].push(n)):this.options.explicitArray?t[e]=[n]:t[e]=n},s.prototype.reset=function(){var t,e,n,r,s;return this.removeAllListeners(),this.saxParser=u.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=(s=this,function(t){if(s.saxParser.resume(),!s.saxParser.errThrown)return s.saxParser.errThrown=!0,s.emit("error",t)}),this.saxParser.onend=function(t){return function(){if(!t.saxParser.ended)return t.saxParser.ended=!0,t.emit("end",t.resultObject)}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,r=[],t=this.options.attrkey,e=this.options.charkey,this.saxParser.onopentag=function(n){return function(s){var o,i,c,u,l;if((c=Object.create(null))[e]="",!n.options.ignoreAttrs)for(o in l=s.attributes)d.call(l,o)&&(t in c||n.options.mergeAttrs||(c[t]=Object.create(null)),i=n.options.attrValueProcessors?a(n.options.attrValueProcessors,s.attributes[o],o):s.attributes[o],u=n.options.attrNameProcessors?a(n.options.attrNameProcessors,o):o,n.options.mergeAttrs?n.assignOrPush(c,u,i):c[t][u]=i);return c["#name"]=n.options.tagNameProcessors?a(n.options.tagNameProcessors,s.name):s.name,n.options.xmlns&&(c[n.options.xmlnskey]={uri:s.uri,local:s.local}),r.push(c)}}(this),this.saxParser.onclosetag=function(t){return function(){var n,s,o,c,u,l,p,h,f,m;if(l=r.pop(),u=l["#name"],t.options.explicitChildren&&t.options.preserveChildrenOrder||delete l["#name"],!0===l.cdata&&(n=l.cdata,delete l.cdata),f=r[r.length-1],l[e].match(/^\s*$/)&&!n?(s=l[e],delete l[e]):(t.options.trim&&(l[e]=l[e].trim()),t.options.normalize&&(l[e]=l[e].replace(/\s{2,}/g," ").trim()),l[e]=t.options.valueProcessors?a(t.options.valueProcessors,l[e],u):l[e],1===Object.keys(l).length&&e in l&&!t.EXPLICIT_CHARKEY&&(l=l[e])),i(l)&&(l="function"==typeof t.options.emptyTag?t.options.emptyTag():""!==t.options.emptyTag?t.options.emptyTag:s),null!=t.options.validator&&(m="/"+function(){var t,e,n;for(n=[],t=0,e=r.length;t<e;t++)c=r[t],n.push(c["#name"]);return n}().concat(u).join("/"),function(){var e;try{return l=t.options.validator(m,f&&f[u],l)}catch(n){return e=n,t.emit("error",e)}}()),t.options.explicitChildren&&!t.options.mergeAttrs&&"object"==typeof l)if(t.options.preserveChildrenOrder){if(f){for(o in f[t.options.childkey]=f[t.options.childkey]||[],p=Object.create(null),l)d.call(l,o)&&(p[o]=l[o]);f[t.options.childkey].push(p),delete l["#name"],1===Object.keys(l).length&&e in l&&!t.EXPLICIT_CHARKEY&&(l=l[e])}}else c=Object.create(null),t.options.attrkey in l&&(c[t.options.attrkey]=l[t.options.attrkey],delete l[t.options.attrkey]),!t.options.charsAsChildren&&t.options.charkey in l&&(c[t.options.charkey]=l[t.options.charkey],delete l[t.options.charkey]),Object.getOwnPropertyNames(l).length>0&&(c[t.options.childkey]=l),l=c;return r.length>0?t.assignOrPush(f,u,l):(t.options.explicitRoot&&(h=l,(l=Object.create(null))[u]=h),t.resultObject=l,t.saxParser.ended=!0,t.emit("end",t.resultObject))}}(this),n=function(t){return function(n){var s,o;if(o=r[r.length-1])return o[e]+=n,t.options.explicitChildren&&t.options.preserveChildrenOrder&&t.options.charsAsChildren&&(t.options.includeWhiteChars||""!==n.replace(/\\n/g,"").trim())&&(o[t.options.childkey]=o[t.options.childkey]||[],(s={"#name":"__text__"})[e]=n,t.options.normalize&&(s[e]=s[e].replace(/\s{2,}/g," ").trim()),o[t.options.childkey].push(s)),o}}(this),this.saxParser.ontext=n,this.saxParser.oncdata=function(t){var e;if(e=n(t))return e.cdata=!0}},s.prototype.parseString=function(t,n){var r;null!=n&&"function"==typeof n&&(this.on("end",function(t){return this.reset(),n(null,t)}),this.on("error",function(t){return this.reset(),n(t)}));try{return""===(t=t.toString()).trim()?(this.emit("end",null),!0):(t=e.stripBOM(t),this.options.async?(this.remaining=t,p(this.processAsync),this.saxParser):this.saxParser.write(t).close())}catch(t){if(r=t,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",r),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw r}},s.prototype.parseStringPromise=function(t){return new Promise((e=this,function(n,r){return e.parseString(t,function(t,e){return t?r(t):n(e)})}));var e},s}(o),t.parseString=function(e,n,r){var s,o;return null!=r?("function"==typeof r&&(s=r),"object"==typeof n&&(o=n)):("function"==typeof n&&(s=n),o={}),new t.Parser(o).parseString(e,s)},t.parseStringPromise=function(e,n){var r;return"object"==typeof n&&(r=n),new t.Parser(r).parseStringPromise(e)}}.call($e)),$e;var t}function Xe(){return Ve||(Ve=1,function(){var t,e,n,r,s={}.hasOwnProperty;e=l(),t=Le(),n=We(),r=He(),c.defaults=e.defaults,c.processors=r,c.ValidationError=function(){function t(t){this.message=t}return function(t,e){for(var n in e)s.call(e,n)&&(t[n]=e[n]);function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype}(t,Error),t}(),c.Builder=t.Builder,c.Parser=n.Parser,c.parseString=n.parseString,c.parseStringPromise=n.parseStringPromise}.call(c)),c}var Ge,Ke={exports:{}};function Ye(){if(Ge)return Ke.exports;Ge=1;const t=Ke.exports={};t.feed=[["author","creator"],["dc:publisher","publisher"],["dc:creator","creator"],["dc:source","source"],["dc:title","title"],["dc:type","type"],"title","description","author","pubDate","webMaster","managingEditor","generator","link","language","copyright","lastBuildDate","docs","generator","ttl","rating","skipHours","skipDays"],t.item=[["author","creator"],["dc:creator","creator"],["dc:date","date"],["dc:language","language"],["dc:rights","rights"],["dc:source","source"],["dc:title","title"],"title","link","pubDate","author","summary",["content:encoded","content:encoded",{includeSnippet:!0}],"enclosure","dc:creator","dc:date","comments"];var e=function(t){return["itunes:"+t,t]};return t.podcastFeed=["author","subtitle","summary","explicit"].map(e),t.podcastItem=["author","subtitle","summary","explicit","duration","image","episode","image","season","keywords","episodeType"].map(e),Ke.exports}var Je,Qe,tn={exports:{}},en={},nn={},rn={Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",amp:"&",AMP:"&",andand:"",And:"",and:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angmsd:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",apacir:"",ap:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",barwed:"",Barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",because:"",Because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxdl:"",boxdL:"",boxDl:"",boxDL:"",boxdr:"",boxdR:"",boxDr:"",boxDR:"",boxh:"",boxH:"",boxhd:"",boxHd:"",boxhD:"",boxHD:"",boxhu:"",boxHu:"",boxhU:"",boxHU:"",boxminus:"",boxplus:"",boxtimes:"",boxul:"",boxuL:"",boxUl:"",boxUL:"",boxur:"",boxuR:"",boxUr:"",boxUR:"",boxv:"",boxV:"",boxvh:"",boxvH:"",boxVh:"",boxVH:"",boxvl:"",boxvL:"",boxVl:"",boxVL:"",boxvr:"",boxvR:"",boxVr:"",boxVR:"",bprime:"",breve:"",Breve:"",brvbar:"",bscr:"",Bscr:"",bsemi:"",bsim:"",bsime:"",bsolb:"",bsol:"\\",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",capand:"",capbrcup:"",capcap:"",cap:"",Cap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",centerdot:"",CenterDot:"",cfr:"",Cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cir:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",colon:":",Colon:"",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",conint:"",Conint:"",ContourIntegral:"",copf:"",Copf:"",coprod:"",Coproduct:"",copy:"",COPY:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",cross:"",Cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",cupbrcap:"",cupcap:"",CupCap:"",cup:"",Cup:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",dagger:"",Dagger:"",daleth:"",darr:"",Darr:"",dArr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",ddagger:"",ddarr:"",DD:"",dd:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",diamond:"",Diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrowBar:"",downarrow:"",DownArrow:"",Downarrow:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVectorBar:"",DownLeftVector:"",DownRightTeeVector:"",DownRightVectorBar:"",DownRightVector:"",DownTeeArrow:"",DownTee:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",Ecirc:"",ecirc:"",ecir:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",edot:"",eDot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp13:"",emsp14:"",emsp:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",escr:"",Escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",exponentiale:"",ExponentialE:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",forall:"",ForAll:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",fscr:"",Fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",ge:"",gE:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",gescc:"",ges:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",gg:"",Gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gla:"",gl:"",glE:"",glj:"",gnap:"",gnapprox:"",gne:"",gnE:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",gtcc:"",gtcir:"",gt:">",GT:">",Gt:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",harrcir:"",harr:"",hArr:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",hfr:"",Hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",hopf:"",Hopf:"",horbar:"",HorizontalLine:"",hscr:"",Hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",ifr:"",Ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",Im:"",imof:"",imped:"",Implies:"",incare:"",in:"",infin:"",infintie:"",inodot:"",intcal:"",int:"",Int:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",iscr:"",Iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",lang:"",Lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",larrb:"",larrbfs:"",larr:"",Larr:"",lArr:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",latail:"",lAtail:"",lat:"",late:"",lates:"",lbarr:"",lBarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",le:"",lE:"",LeftAngleBracket:"",LeftArrowBar:"",leftarrow:"",LeftArrow:"",Leftarrow:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVectorBar:"",LeftDownVector:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",leftrightarrow:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTeeArrow:"",LeftTee:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangleBar:"",LeftTriangle:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVectorBar:"",LeftUpVector:"",LeftVectorBar:"",LeftVector:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",lescc:"",les:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",llarr:"",ll:"",Ll:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoustache:"",lmoust:"",lnap:"",lnapprox:"",lne:"",lnE:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",longleftarrow:"",LongLeftArrow:"",Longleftarrow:"",longleftrightarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longmapsto:"",longrightarrow:"",LongRightArrow:"",Longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",lscr:"",Lscr:"",lsh:"",Lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",ltcc:"",ltcir:"",lt:"<",LT:"<",Lt:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",midast:"*",midcir:"",mid:"",middot:"",minusb:"",minus:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",mscr:"",Mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natural:"",naturals:"",natur:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",nearhk:"",nearr:"",neArr:"",nearrow:"",ne:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:"\n",nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nharr:"",nhArr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlarr:"",nlArr:"",nldr:"",nlE:"",nle:"",nleftarrow:"",nLeftarrow:"",nleftrightarrow:"",nLeftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",nopf:"",Nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangleBar:"",NotLeftTriangle:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangleBar:"",NotRightTriangle:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",nparallel:"",npar:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",nprec:"",npreceq:"",npre:"",nrarrc:"",nrarr:"",nrArr:"",nrarrw:"",nrightarrow:"",nRightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nvdash:"",nvDash:"",nVdash:"",nVDash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwarr:"",nwArr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",Ocirc:"",ocirc:"",ocir:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",orarr:"",Or:"",or:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",otimesas:"",Otimes:"",otimes:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",para:"",parallel:"",par:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plusacir:"",plusb:"",pluscir:"",plus:"+",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",popf:"",Popf:"",pound:"",prap:"",Pr:"",pr:"",prcue:"",precapprox:"",prec:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",pre:"",prE:"",precsim:"",prime:"",Prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportional:"",Proportion:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",qopf:"",Qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",quot:'"',QUOT:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",rang:"",Rang:"",rangd:"",range:"",rangle:"",raquo:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarr:"",Rarr:"",rArr:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",ratail:"",rAtail:"",ratio:"",rationals:"",rbarr:"",rBarr:"",RBarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",real:"",realine:"",realpart:"",reals:"",Re:"",rect:"",reg:"",REG:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",rfr:"",Rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrowBar:"",rightarrow:"",RightArrow:"",Rightarrow:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVectorBar:"",RightDownVector:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTeeArrow:"",RightTee:"",RightTeeVector:"",rightthreetimes:"",RightTriangleBar:"",RightTriangle:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVectorBar:"",RightUpVector:"",RightVectorBar:"",RightVector:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoustache:"",rmoust:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",ropf:"",Ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",rscr:"",Rscr:"",rsh:"",Rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",scap:"",Scaron:"",scaron:"",Sc:"",sc:"",sccue:"",sce:"",scE:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdotb:"",sdot:"",sdote:"",searhk:"",searr:"",seArr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",solbar:"",solb:"",sol:"/",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",square:"",Square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squ:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",sub:"",Sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",subset:"",Subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succapprox:"",succ:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",sum:"",Sum:"",sung:"",sup1:"",sup2:"",sup3:"",sup:"",Sup:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",supset:"",Supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swarr:"",swArr:"",swarrow:"",swnwar:"",szlig:"",Tab:"\t",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",therefore:"",Therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",ThinSpace:"",thinsp:"",thkap:"",thksim:"",THORN:"",thorn:"",tilde:"",Tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",timesbar:"",timesb:"",times:"",timesd:"",tint:"",toea:"",topbot:"",topcir:"",top:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",trade:"",TRADE:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",uarr:"",Uarr:"",uArr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrowBar:"",uparrow:"",UpArrow:"",Uparrow:"",UpArrowDownArrow:"",updownarrow:"",UpDownArrow:"",Updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",upsi:"",Upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTeeArrow:"",UpTee:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",varr:"",vArr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",vBar:"",Vbar:"",vBarv:"",Vcy:"",vcy:"",vdash:"",vDash:"",Vdash:"",VDash:"",Vdashl:"",veebar:"",vee:"",Vee:"",veeeq:"",vellip:"",verbar:"|",Verbar:"",vert:"|",Vert:"",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",wedge:"",Wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xharr:"",xhArr:"",Xi:"",xi:"",xlarr:"",xlArr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrarr:"",xrArr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",yuml:"",Yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",zfr:"",Zfr:"",ZHcy:"",zhcy:"",zigrarr:"",zopf:"",Zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""},sn={Aacute:"",aacute:"",Acirc:"",acirc:"",acute:"",AElig:"",aelig:"",Agrave:"",agrave:"",amp:"&",AMP:"&",Aring:"",aring:"",Atilde:"",atilde:"",Auml:"",auml:"",brvbar:"",Ccedil:"",ccedil:"",cedil:"",cent:"",copy:"",COPY:"",curren:"",deg:"",divide:"",Eacute:"",eacute:"",Ecirc:"",ecirc:"",Egrave:"",egrave:"",ETH:"",eth:"",Euml:"",euml:"",frac12:"",frac14:"",frac34:"",gt:">",GT:">",Iacute:"",iacute:"",Icirc:"",icirc:"",iexcl:"",Igrave:"",igrave:"",iquest:"",Iuml:"",iuml:"",laquo:"",lt:"<",LT:"<",macr:"",micro:"",middot:"",nbsp:"",not:"",Ntilde:"",ntilde:"",Oacute:"",oacute:"",Ocirc:"",ocirc:"",Ograve:"",ograve:"",ordf:"",ordm:"",Oslash:"",oslash:"",Otilde:"",otilde:"",Ouml:"",ouml:"",para:"",plusmn:"",pound:"",quot:'"',QUOT:'"',raquo:"",reg:"",REG:"",sect:"",shy:"",sup1:"",sup2:"",sup3:"",szlig:"",THORN:"",thorn:"",times:"",Uacute:"",uacute:"",Ucirc:"",ucirc:"",Ugrave:"",ugrave:"",uml:"",Uuml:"",uuml:"",Yacute:"",yacute:"",yen:"",yuml:""},on={amp:"&",apos:"'",gt:">",lt:"<",quot:'"'},an={},cn={0:65533,128:8364,130:8218,131:402,132:8222,133:8230,134:8224,135:8225,136:710,137:8240,138:352,139:8249,140:338,142:381,145:8216,146:8217,147:8220,148:8221,149:8226,150:8211,151:8212,152:732,153:8482,154:353,155:8250,156:339,158:382,159:376};function un(){if(Qe)return nn;Qe=1;var t=nn&&nn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(nn,"__esModule",{value:!0}),nn.decodeHTML=nn.decodeHTMLStrict=nn.decodeXML=void 0;var e=t(rn),n=t(sn),r=t(on),s=t(function(){if(Je)return an;Je=1;var t=an&&an.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(an,"__esModule",{value:!0});var e=t(cn),n=String.fromCodePoint||function(t){var e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|1023&t),e+String.fromCharCode(t)};return an.default=function(t){return t>=55296&&t<=57343||t>1114111?"":(t in e.default&&(t=e.default[t]),n(t))},an}()),o=/&(?:[a-zA-Z0-9]+|#[xX][\da-fA-F]+|#\d+);/g;function i(t){var e=c(t);return function(t){return String(t).replace(o,e)}}nn.decodeXML=i(r.default),nn.decodeHTMLStrict=i(e.default);var a=function(t,e){return t<e?1:-1};function c(t){return function(e){if("#"===e.charAt(1)){var n=e.charAt(2);return"X"===n||"x"===n?s.default(parseInt(e.substr(3),16)):s.default(parseInt(e.substr(2),10))}return t[e.slice(1,-1)]||e}}return nn.decodeHTML=function(){for(var t=Object.keys(n.default).sort(a),r=Object.keys(e.default).sort(a),s=0,o=0;s<r.length;s++)t[o]===r[s]?(r[s]+=";?",o++):r[s]+=";";var i=new RegExp("&(?:"+r.join("|")+"|#[xX][\\da-fA-F]+;?|#\\d+;?)","g"),u=c(e.default);function l(t){return";"!==t.substr(-1)&&(t+=";"),u(t)}return function(t){return String(t).replace(i,l)}}(),nn}var ln,pn,hn,dn,fn,mn,gn,yn={};function wn(){if(ln)return yn;ln=1;var t=yn&&yn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(yn,"__esModule",{value:!0}),yn.escapeUTF8=yn.escape=yn.encodeNonAsciiHTML=yn.encodeHTML=yn.encodeXML=void 0;var e=a(t(on).default),n=c(e);yn.encodeXML=d(e);var r,s,o=a(t(rn).default),i=c(o);function a(t){return Object.keys(t).sort().reduce(function(e,n){return e[t[n]]="&"+n+";",e},{})}function c(t){for(var e=[],n=[],r=0,s=Object.keys(t);r<s.length;r++){var o=s[r];1===o.length?e.push("\\"+o):n.push(o)}e.sort();for(var i=0;i<e.length-1;i++){for(var a=i;a<e.length-1&&e[a].charCodeAt(1)+1===e[a+1].charCodeAt(1);)a+=1;var c=1+a-i;c<3||e.splice(i,c,e[i]+"-"+e[a])}return n.unshift("["+e.join("")+"]"),new RegExp(n.join("|"),"g")}yn.encodeHTML=(r=o,s=i,function(t){return t.replace(s,function(t){return r[t]}).replace(u,p)}),yn.encodeNonAsciiHTML=d(o);var u=/(?:[\x80-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/g,l=null!=String.prototype.codePointAt?function(t){return t.codePointAt(0)}:function(t){return 1024*(t.charCodeAt(0)-55296)+t.charCodeAt(1)-56320+65536};function p(t){return"&#x"+(t.length>1?l(t):t.charCodeAt(0)).toString(16).toUpperCase()+";"}var h=new RegExp(n.source+"|"+u.source,"g");function d(t){return function(e){return e.replace(h,function(e){return t[e]||p(e)})}}return yn.escape=function(t){return t.replace(h,p)},yn.escapeUTF8=function(t){return t.replace(n,p)},yn}function bn(){return pn||(pn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.decodeXMLStrict=t.decodeHTML5Strict=t.decodeHTML4Strict=t.decodeHTML5=t.decodeHTML4=t.decodeHTMLStrict=t.decodeHTML=t.decodeXML=t.encodeHTML5=t.encodeHTML4=t.escapeUTF8=t.escape=t.encodeNonAsciiHTML=t.encodeHTML=t.encodeXML=t.encode=t.decodeStrict=t.decode=void 0;var e=un(),n=wn();t.decode=function(t,n){return(!n||n<=0?e.decodeXML:e.decodeHTML)(t)},t.decodeStrict=function(t,n){return(!n||n<=0?e.decodeXML:e.decodeHTMLStrict)(t)},t.encode=function(t,e){return(!e||e<=0?n.encodeXML:n.encodeHTML)(t)};var r=wn();Object.defineProperty(t,"encodeXML",{enumerable:!0,get:function(){return r.encodeXML}}),Object.defineProperty(t,"encodeHTML",{enumerable:!0,get:function(){return r.encodeHTML}}),Object.defineProperty(t,"encodeNonAsciiHTML",{enumerable:!0,get:function(){return r.encodeNonAsciiHTML}}),Object.defineProperty(t,"escape",{enumerable:!0,get:function(){return r.escape}}),Object.defineProperty(t,"escapeUTF8",{enumerable:!0,get:function(){return r.escapeUTF8}}),Object.defineProperty(t,"encodeHTML4",{enumerable:!0,get:function(){return r.encodeHTML}}),Object.defineProperty(t,"encodeHTML5",{enumerable:!0,get:function(){return r.encodeHTML}});var s=un();Object.defineProperty(t,"decodeXML",{enumerable:!0,get:function(){return s.decodeXML}}),Object.defineProperty(t,"decodeHTML",{enumerable:!0,get:function(){return s.decodeHTML}}),Object.defineProperty(t,"decodeHTMLStrict",{enumerable:!0,get:function(){return s.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTML4",{enumerable:!0,get:function(){return s.decodeHTML}}),Object.defineProperty(t,"decodeHTML5",{enumerable:!0,get:function(){return s.decodeHTML}}),Object.defineProperty(t,"decodeHTML4Strict",{enumerable:!0,get:function(){return s.decodeHTMLStrict}}),Object.defineProperty(t,"decodeHTML5Strict",{enumerable:!0,get:function(){return s.decodeHTMLStrict}}),Object.defineProperty(t,"decodeXMLStrict",{enumerable:!0,get:function(){return s.decodeXML}})}(en)),en}function _n(){if(hn)return tn.exports;hn=1;const t=tn.exports={},e=bn(),n=Xe();t.stripHtml=function(t){return t=(t=t.replace(/([^\n])<\/?(h|br|p|ul|ol|li|blockquote|section|table|tr|div)(?:.|\n)*?>([^\n])/gm,"$1\n$3")).replace(/<(?:.|\n)*?>/gm,"")},t.getSnippet=function(n){return e.decodeHTML(t.stripHtml(n)).trim()},t.getLink=function(t,e,n){if(t){for(let n=0;n<t.length;++n)if(t[n].$.rel===e)return t[n].$.href;return t[n]?t[n].$.href:void 0}},t.getContent=function(t){if("string"==typeof t._)return t._;if("object"==typeof t){return new n.Builder({headless:!0,explicitRoot:!0,rootName:"div",renderOpts:{pretty:!1}}).buildObject(t)}return t},t.copyFromXML=function(e,n,r){r.forEach(function(r){let s=r,o=r,i={};Array.isArray(r)&&(s=r[0],o=r[1],r.length>2&&(i=r[2]));const{keepArray:a,includeSnippet:c}=i;void 0!==e[s]&&(n[o]=a?e[s]:e[s][0]),n[o]&&"string"==typeof n[o]._&&(n[o]=n[o]._),c&&n[o]&&"string"==typeof n[o]&&(n[o+"Snippet"]=t.getSnippet(n[o]))})},t.maybePromisify=function(t,e){return t?e.then(e=>setTimeout(()=>t(null,e)),e=>setTimeout(()=>t(e))):e};const r=/(encoding|charset)\s*=\s*(\S+)/,s=["ascii","utf8","utf16le","ucs2","base64","latin1","binary","hex"],o={"utf-8":"utf8","iso-8859-1":"latin1"};return t.getEncodingFromContentType=function(t){let e=((t=t||"").match(r)||[])[2]||"";return e=e.toLowerCase(),e=o[e]||e,e&&-1!==s.indexOf(e)||(e="utf8"),e},tn.exports}var vn=(gn||(gn=1,mn=function(){if(fn)return dn;fn=1;const n=t,r=e,s=Xe(),i=o,a=Ye(),c=_n(),u={"User-Agent":"rss-parser",Accept:"application/rss+xml"};return dn=class{constructor(t={}){t.headers=t.headers||{},t.xml2js=t.xml2js||{},t.customFields=t.customFields||{},t.customFields.item=t.customFields.item||[],t.customFields.feed=t.customFields.feed||[],t.requestOptions=t.requestOptions||{},t.maxRedirects||(t.maxRedirects=5),t.timeout||(t.timeout=6e4),this.options=t,this.xmlParser=new s.Parser(this.options.xml2js)}parseString(t,e){let n=new Promise((e,n)=>{this.xmlParser.parseString(t,(t,r)=>{if(t)return n(t);if(!r)return n(new Error("Unable to parse XML."));let s=null;if(r.feed)s=this.buildAtomFeed(r);else if(r.rss&&r.rss.$&&r.rss.$.version&&r.rss.$.version.match(/^2/))s=this.buildRSS2(r);else if(r["rdf:RDF"])s=this.buildRSS1(r);else if(r.rss&&r.rss.$&&r.rss.$.version&&r.rss.$.version.match(/0\.9/))s=this.buildRSS0_9(r);else{if(!r.rss||!this.options.defaultRSS)return n(new Error("Feed not recognized as RSS 1 or 2."));switch(this.options.defaultRSS){case.9:s=this.buildRSS0_9(r);break;case 1:s=this.buildRSS1(r);break;case 2:s=this.buildRSS2(r);break;default:return n(new Error("default RSS version not recognized."))}}e(s)})});return n=c.maybePromisify(e,n),n}parseURL(t,e,s=0){let o="",a=0===t.indexOf("https")?r.get:n.get,l=i.parse(t),p=Object.assign({},u,this.options.headers),h=null,d=new Promise((e,n)=>{const r=Object.assign({headers:p},l,this.options.requestOptions);a(r,r=>{if(this.options.maxRedirects&&r.statusCode>=300&&r.statusCode<400&&r.headers.location){if(s===this.options.maxRedirects)return n(new Error("Too many redirects"));{const o=i.resolve(t,r.headers.location);return this.parseURL(o,null,s+1).then(e,n)}}if(r.statusCode>=300)return n(new Error("Status code "+r.statusCode));let a=c.getEncodingFromContentType(r.headers["content-type"]);r.setEncoding(a),r.on("data",t=>{o+=t}),r.on("end",()=>this.parseString(o).then(e,n))}).on("error",n),h=setTimeout(()=>n(new Error("Request timed out after "+this.options.timeout+"ms")),this.options.timeout)}).then(t=>(clearTimeout(h),Promise.resolve(t)),t=>(clearTimeout(h),Promise.reject(t)));return d=c.maybePromisify(e,d),d}buildAtomFeed(t){let e={items:[]};if(c.copyFromXML(t.feed,e,this.options.customFields.feed),t.feed.link&&(e.link=c.getLink(t.feed.link,"alternate",0),e.feedUrl=c.getLink(t.feed.link,"self",1)),t.feed.title){let n=t.feed.title[0]||"";n._&&(n=n._),n&&(e.title=n)}return t.feed.updated&&(e.lastBuildDate=t.feed.updated[0]),e.items=(t.feed.entry||[]).map(t=>this.parseItemAtom(t)),e}parseItemAtom(t){let e={};if(c.copyFromXML(t,e,this.options.customFields.item),t.title){let n=t.title[0]||"";n._&&(n=n._),n&&(e.title=n)}return t.link&&t.link.length&&(e.link=c.getLink(t.link,"alternate",0)),t.published&&t.published.length&&t.published[0].length&&(e.pubDate=new Date(t.published[0]).toISOString()),!e.pubDate&&t.updated&&t.updated.length&&t.updated[0].length&&(e.pubDate=new Date(t.updated[0]).toISOString()),t.author&&t.author.length&&t.author[0].name&&t.author[0].name.length&&(e.author=t.author[0].name[0]),t.content&&t.content.length&&(e.content=c.getContent(t.content[0]),e.contentSnippet=c.getSnippet(e.content)),t.summary&&t.summary.length&&(e.summary=c.getContent(t.summary[0])),t.id&&(e.id=t.id[0]),this.setISODate(e),e}buildRSS0_9(t){var e=t.rss.channel[0],n=e.item;return this.buildRSS(e,n)}buildRSS1(t){let e=(t=t["rdf:RDF"]).channel[0],n=t.item;return this.buildRSS(e,n)}buildRSS2(t){let e=t.rss.channel[0],n=e.item,r=this.buildRSS(e,n);return t.rss.$&&t.rss.$["xmlns:itunes"]&&this.decorateItunes(r,e),r}buildRSS(t,e){e=e||[];let n={items:[]},r=a.feed.concat(this.options.customFields.feed),s=a.item.concat(this.options.customFields.item);if(t["atom:link"]&&t["atom:link"][0]&&t["atom:link"][0].$&&(n.feedUrl=t["atom:link"][0].$.href),t.image&&t.image[0]&&t.image[0].url){n.image={};let e=t.image[0];e.link&&(n.image.link=e.link[0]),e.url&&(n.image.url=e.url[0]),e.title&&(n.image.title=e.title[0]),e.width&&(n.image.width=e.width[0]),e.height&&(n.image.height=e.height[0])}const o=this.generatePaginationLinks(t);return Object.keys(o).length&&(n.paginationLinks=o),c.copyFromXML(t,n,r),n.items=e.map(t=>this.parseItemRss(t,s)),n}parseItemRss(t,e){let n={};return c.copyFromXML(t,n,e),t.enclosure&&(n.enclosure=t.enclosure[0].$),t.description&&(n.content=c.getContent(t.description[0]),n.contentSnippet=c.getSnippet(n.content)),t.guid&&(n.guid=t.guid[0],n.guid._&&(n.guid=n.guid._)),t.$&&t.$["rdf:about"]&&(n["rdf:about"]=t.$["rdf:about"]),t.category&&(n.categories=t.category),this.setISODate(n),n}decorateItunes(t,e){let n=e.item||[];if(t.itunes={},e["itunes:owner"]){let n={};e["itunes:owner"][0]["itunes:name"]&&(n.name=e["itunes:owner"][0]["itunes:name"][0]),e["itunes:owner"][0]["itunes:email"]&&(n.email=e["itunes:owner"][0]["itunes:email"][0]),t.itunes.owner=n}if(e["itunes:image"]){let n;n=e["itunes:image"][0]&&e["itunes:image"][0].$&&e["itunes:image"][0].$.href?e["itunes:image"][0].$.href:null,n&&(t.itunes.image=n)}if(e["itunes:category"]){const n=e["itunes:category"].map(t=>({name:t&&t.$&&t.$.text,subs:t["itunes:category"]?t["itunes:category"].map(t=>({name:t&&t.$&&t.$.text})):null}));t.itunes.categories=n.map(t=>t.name),t.itunes.categoriesWithSubs=n}if(e["itunes:keywords"])if(e["itunes:keywords"].length>1)t.itunes.keywords=e["itunes:keywords"].map(t=>t&&t.$&&t.$.text);else{let n=e["itunes:keywords"][0];n&&"string"==typeof n._&&(n=n._),n&&n.$&&n.$.text?t.itunes.keywords=n.$.text.split(","):"string"==typeof n&&(t.itunes.keywords=n.split(","))}c.copyFromXML(e,t.itunes,a.podcastFeed),n.forEach((e,n)=>{let r=t.items[n];r.itunes={},c.copyFromXML(e,r.itunes,a.podcastItem);let s=e["itunes:image"];s&&s[0]&&s[0].$&&s[0].$.href&&(r.itunes.image=s[0].$.href)})}setISODate(t){let e=t.pubDate||t.date;if(e)try{t.isoDate=new Date(e.trim()).toISOString()}catch(t){}}generatePaginationLinks(t){if(!t["atom:link"])return{};const e=["self","first","next","prev","last"];return t["atom:link"].reduce((t,n)=>n.$&&e.includes(n.$.rel)?(t[n.$.rel]=n.$.href,t):t,{})}},dn}()),mn),Tn=i(vn);function xn(t,e){const n=(t||"").replace(/"/g,"'"),r=(e||"").replace(/"/g,"'").replace(/\n/g," "),s=["tragedy","comedy","satire","dark comedy","absurdist","epic","legend","romance","thriller","horror","mystery","adventure","coming-of-age","redemption","revenge","quest","survival","time loop","parallel narrative","multi-POV puzzle","non-linear","metafiction","allegory","myth retelling","mockumentary","epistolary","diary","fragmented","stream of consciousness"],o=["hero","heroine","anti-hero","villain","mentor","sage","fool","jester","rebel","orphan","explorer","lover","creator","ruler","magician","everyman","guardian","destroyer","trickster","martyr","survivor","outsider","double agent","mad scientist","detective","artist","revolutionary","exile","AI","clone","shapeshifter","time traveler","fairy tale prince","fairy tale princess","cursed one","prophesied child","last human","first awakened","witness","chronicler","betrayer"],i=["power struggle","family feud","mentor betrayal","love triangle","class war","generational gap","culture clash","ideology war","identity crisis","moral dilemma","trauma and healing","desire vs duty","ideal vs reality","belief collapse","memory loss","systemic oppression","production relations conflict","revolution vs conservatism","individual vs collective","freedom vs order","truth vs lies","tradition vs innovation","survival crisis","runaway technology","fate vs free will","mortality","cosmic horror","resource scarcity","knowledge monopoly","territorial dispute","time pressure","information asymmetry","real vs virtual","organic vs mechanical","evolution vs devolution","memory authenticity","consciousness nature","existential meaning"],a={narrative_mode:s[Math.floor(Math.random()*s.length)],character_archetype:o[Math.floor(Math.random()*o.length)],conflict_type:i[Math.floor(Math.random()*i.length)]};return`\n[Role]\nYou are a creative sci-fi story consultant who generates unexpected story concepts by colliding scientific news with randomly selected narrative dimensions.\n\n[Task]\nStep 1: Analyze Scientific News\nExtract from the provided news:\nCore technology and its mechanism;\nPotential future applications (10-100 years ahead);\nPossible social transformations.\n\nStep 2: Use Provided Dimensions\nDo not select them yourself. Use exactly these provided values:\n\n- Narrative Mode: ${a.narrative_mode}\n- Character Archetype: ${a.character_archetype}\n- Conflict Type: ${a.conflict_type}\n\nStep 3: Generate Inspiration\nSynthesize the tech and 3 provided dimensions into a story pitch. Work with whatever combination you gotdon't try to make it "stranger" or "safer." The randomness itself creates the collision.\n\n[INPUT]\n- Title: "${n}"\n- Content: "${r}"\n\n[SELECTION CRITERIA]\n\n1. Exclude: Pure product reviews and user guides, industry reports and market data, legal and policy interpretations, personal opinions and commentary articles, pure business strategy analysis, news on security vulnerabilities and hacker attacks, recruitment and talent market information, conference announcements, event reports and so on.\n2. Retain: Content containing scientific breakthroughs, technological innovations, or future trends that can be extended into science fiction storylines, world-building, and character development.\n\n[RULES]\n1. If the content is empty, use ONLY the title to assess relevance.\n2. Based on selection criteria, if irrelevant, output {"is_relevant": false}.\n3. If relevant, return ONLY a valid JSON object (no markdown code blocks) .\n\n[OUTPUT FORMAT]\n{\n  is_relevant: true,\n  title_zh: "",\n  summary: "1-2 sentence technical summary in english",\n  summary_zh: "",\n  category: "biotech/physics/computer/space/climate/other",\n  inspiration: "A 150-250 word pitch integrating: tech extrapolation + protagonist + conflict + narrative mode + thematic question. Write as one flowing paragraph with specific character details, concrete scenarios, and unexpected angles. You may use 'What if' as opening.",\n  inspiration_zh: "150-250++++''"\n}\n\n[Key Principles]\n\nNo preference for "interesting" or "coherent" combinations.\nWork with what you get, tension and harmony are both valuable.\nLet the random selections drive diversity, not deliberate "weirdness".\nNot every story needs a "discovery of hidden truth" structure.\nAvoid ending with rhetorical questions.\nExplore conflicts beyond binary moral choices.\n`}function En(t,e,n,r,s){if("function"==typeof e||!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}function On(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}let In=function(){const{crypto:t}=globalThis;if(t?.randomUUID)return In=t.randomUUID.bind(t),t.randomUUID();const e=new Uint8Array(1),n=t?()=>t.getRandomValues(e)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,t=>(+t^n()&15>>+t/4).toString(16))};function Dn(t){return"object"==typeof t&&null!==t&&("name"in t&&"AbortError"===t.name||"message"in t&&String(t.message).includes("FetchRequestCanceledException"))}const An=t=>{if(t instanceof Error)return t;if("object"==typeof t&&null!==t){try{if("[object Error]"===Object.prototype.toString.call(t)){const e=new Error(t.message,t.cause?{cause:t.cause}:{});return t.stack&&(e.stack=t.stack),t.cause&&!e.cause&&(e.cause=t.cause),t.name&&(e.name=t.name),e}}catch{}try{return new Error(JSON.stringify(t))}catch{}}return new Error(t)};class Sn extends Error{}class kn extends Sn{constructor(t,e,n,r){super(`${kn.makeMessage(t,e,n)}`),this.status=t,this.headers=r,this.requestID=r?.get("x-request-id"),this.error=e;const s=e;this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(t,e,n){const r=e?.message?"string"==typeof e.message?e.message:JSON.stringify(e.message):e?JSON.stringify(e):n;return t&&r?`${t} ${r}`:t?`${t} status code (no body)`:r||"(no status code or body)"}static generate(t,e,n,r){if(!t||!r)return new Pn({message:n,cause:An(e)});const s=e?.error;return 400===t?new Ln(t,s,n,r):401===t?new Rn(t,s,n,r):403===t?new $n(t,s,n,r):404===t?new jn(t,s,n,r):409===t?new qn(t,s,n,r):422===t?new Fn(t,s,n,r):429===t?new Mn(t,s,n,r):t>=500?new zn(t,s,n,r):new kn(t,s,n,r)}}class Nn extends kn{constructor({message:t}={}){super(void 0,void 0,t||"Request was aborted.",void 0)}}class Pn extends kn{constructor({message:t,cause:e}){super(void 0,void 0,t||"Connection error.",void 0),e&&(this.cause=e)}}class Cn extends Pn{constructor({message:t}={}){super({message:t??"Request timed out."})}}class Ln extends kn{}class Rn extends kn{}class $n extends kn{}class jn extends kn{}class qn extends kn{}class Fn extends kn{}class Mn extends kn{}class zn extends kn{}class Un extends Sn{constructor(){super("Could not parse response content as the length limit was reached")}}class Bn extends Sn{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Vn extends Error{constructor(t){super(t)}}const Zn=/^[a-z][a-z0-9+.-]*:/i;let Hn=t=>(Hn=Array.isArray,Hn(t)),Wn=Hn;function Xn(t){return"object"!=typeof t?{}:t??{}}function Gn(t){return null!=t&&"object"==typeof t&&!Array.isArray(t)}const Kn=t=>new Promise(e=>setTimeout(e,t)),Yn="6.10.0";const Jn=()=>{const t="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===t)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yn,"X-Stainless-OS":tr(Deno.build.os),"X-Stainless-Arch":Qn(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===t)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yn,"X-Stainless-OS":tr(globalThis.process.platform??"unknown"),"X-Stainless-Arch":Qn(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};const e=function(){if("undefined"==typeof navigator||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const t=n.exec(navigator.userAgent);if(t){return{browser:e,version:`${t[1]||0}.${t[2]||0}.${t[3]||0}`}}}return null}();return e?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${e.browser}`,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Yn,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};const Qn=t=>"x32"===t?"x32":"x86_64"===t||"x64"===t?"x64":"arm"===t?"arm":"aarch64"===t||"arm64"===t?"arm64":t?`other:${t}`:"unknown",tr=t=>(t=t.toLowerCase()).includes("ios")?"iOS":"android"===t?"Android":"darwin"===t?"MacOS":"win32"===t?"Windows":"freebsd"===t?"FreeBSD":"openbsd"===t?"OpenBSD":"linux"===t?"Linux":t?`Other:${t}`:"Unknown";let er;function nr(...t){const e=globalThis.ReadableStream;if(void 0===e)throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...t)}function rr(t){let e=Symbol.asyncIterator in t?t[Symbol.asyncIterator]():t[Symbol.iterator]();return nr({start(){},async pull(t){const{done:n,value:r}=await e.next();n?t.close():t.enqueue(r)},async cancel(){await(e.return?.())}})}function sr(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const t=await e.read();return t?.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}const or=({headers:t,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)}),ir="RFC3986",ar=t=>String(t),cr={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:ar};let ur=(t,e)=>(ur=Object.hasOwn??Function.prototype.call.bind(Object.prototype.hasOwnProperty),ur(t,e));const lr=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),pr=1024;function hr(t,e){if(Hn(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const dr={brackets:t=>String(t)+"[]",comma:"comma",indices:(t,e)=>String(t)+"["+e+"]",repeat:t=>String(t)},fr=function(t,e){Array.prototype.push.apply(t,Hn(e)?e:[e])};let mr;const gr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:(t,e,n,r,s)=>{if(0===t.length)return t;let o=t;if("symbol"==typeof t?o=Symbol.prototype.toString.call(t):"string"!=typeof t&&(o=String(t)),"iso-8859-1"===n)return escape(o).replace(/%u[0-9a-f]{4}/gi,function(t){return"%26%23"+parseInt(t.slice(2),16)+"%3B"});let i="";for(let t=0;t<o.length;t+=pr){const e=o.length>=pr?o.slice(t,t+pr):o,n=[];for(let t=0;t<e.length;++t){let r=e.charCodeAt(t);45===r||46===r||95===r||126===r||r>=48&&r<=57||r>=65&&r<=90||r>=97&&r<=122||"RFC1738"===s&&(40===r||41===r)?n[n.length]=e.charAt(t):r<128?n[n.length]=lr[r]:r<2048?n[n.length]=lr[192|r>>6]+lr[128|63&r]:r<55296||r>=57344?n[n.length]=lr[224|r>>12]+lr[128|r>>6&63]+lr[128|63&r]:(t+=1,r=65536+((1023&r)<<10|1023&e.charCodeAt(t)),n[n.length]=lr[240|r>>18]+lr[128|r>>12&63]+lr[128|r>>6&63]+lr[128|63&r])}i+=n.join("")}return i},encodeValuesOnly:!1,format:ir,formatter:ar,indices:!1,serializeDate:t=>(mr??(mr=Function.prototype.call.bind(Date.prototype.toISOString)))(t),skipNulls:!1,strictNullHandling:!1};const yr={};function wr(t,e,n,r,s,o,i,a,c,u,l,p,h,d,f,m,g,y){let w=t,b=y,_=0,v=!1;for(;void 0!==(b=b.get(yr))&&!v;){const e=b.get(t);if(_+=1,void 0!==e){if(e===_)throw new RangeError("Cyclic object value");v=!0}void 0===b.get(yr)&&(_=0)}if("function"==typeof u?w=u(e,w):w instanceof Date?w=h?.(w):"comma"===n&&Hn(w)&&(w=hr(w,function(t){return t instanceof Date?h?.(t):t})),null===w){if(o)return c&&!m?c(e,gr.encoder,g,"key",d):e;w=""}if("string"==typeof(T=w)||"number"==typeof T||"boolean"==typeof T||"symbol"==typeof T||"bigint"==typeof T||function(t){return!(!t||"object"!=typeof t||!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t)))}(w)){if(c){const t=m?e:c(e,gr.encoder,g,"key",d);return[f?.(t)+"="+f?.(c(w,gr.encoder,g,"value",d))]}return[f?.(e)+"="+f?.(String(w))]}var T;const x=[];if(void 0===w)return x;let E;if("comma"===n&&Hn(w))m&&c&&(w=hr(w,c)),E=[{value:w.length>0?w.join(",")||null:void 0}];else if(Hn(u))E=u;else{const t=Object.keys(w);E=l?t.sort(l):t}const O=a?String(e).replace(/\./g,"%2E"):String(e),I=r&&Hn(w)&&1===w.length?O+"[]":O;if(s&&Hn(w)&&0===w.length)return I+"[]";for(let e=0;e<E.length;++e){const b=E[e],v="object"==typeof b&&void 0!==b.value?b.value:w[b];if(i&&null===v)continue;const T=p&&a?b.replace(/\./g,"%2E"):b,O=Hn(w)?"function"==typeof n?n(I,T):I:I+(p?"."+T:"["+T+"]");y.set(t,_);const D=new WeakMap;D.set(yr,y),fr(x,wr(v,O,n,r,s,o,i,a,"comma"===n&&m&&Hn(w)?null:c,u,l,p,h,d,f,m,g,D))}return x}function br(t,e={}){let n=t;const r=function(t=gr){if(void 0!==t.allowEmptyArrays&&"boolean"!=typeof t.allowEmptyArrays)throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(void 0!==t.encodeDotInKeys&&"boolean"!=typeof t.encodeDotInKeys)throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(null!==t.encoder&&void 0!==t.encoder&&"function"!=typeof t.encoder)throw new TypeError("Encoder has to be a function.");const e=t.charset||gr.charset;if(void 0!==t.charset&&"utf-8"!==t.charset&&"iso-8859-1"!==t.charset)throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=ir;if(void 0!==t.format){if(!ur(cr,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=cr[n];let s,o=gr.filter;if(("function"==typeof t.filter||Hn(t.filter))&&(o=t.filter),s=t.arrayFormat&&t.arrayFormat in dr?t.arrayFormat:"indices"in t?t.indices?"indices":"repeat":gr.arrayFormat,"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const i=void 0===t.allowDots?1==!!t.encodeDotInKeys||gr.allowDots:!!t.allowDots;return{addQueryPrefix:"boolean"==typeof t.addQueryPrefix?t.addQueryPrefix:gr.addQueryPrefix,allowDots:i,allowEmptyArrays:"boolean"==typeof t.allowEmptyArrays?!!t.allowEmptyArrays:gr.allowEmptyArrays,arrayFormat:s,charset:e,charsetSentinel:"boolean"==typeof t.charsetSentinel?t.charsetSentinel:gr.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:void 0===t.delimiter?gr.delimiter:t.delimiter,encode:"boolean"==typeof t.encode?t.encode:gr.encode,encodeDotInKeys:"boolean"==typeof t.encodeDotInKeys?t.encodeDotInKeys:gr.encodeDotInKeys,encoder:"function"==typeof t.encoder?t.encoder:gr.encoder,encodeValuesOnly:"boolean"==typeof t.encodeValuesOnly?t.encodeValuesOnly:gr.encodeValuesOnly,filter:o,format:n,formatter:r,serializeDate:"function"==typeof t.serializeDate?t.serializeDate:gr.serializeDate,skipNulls:"boolean"==typeof t.skipNulls?t.skipNulls:gr.skipNulls,sort:"function"==typeof t.sort?t.sort:null,strictNullHandling:"boolean"==typeof t.strictNullHandling?t.strictNullHandling:gr.strictNullHandling}}(e);let s,o;"function"==typeof r.filter?(o=r.filter,n=o("",n)):Hn(r.filter)&&(o=r.filter,s=o);const i=[];if("object"!=typeof n||null===n)return"";const a=dr[r.arrayFormat],c="comma"===a&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let t=0;t<s.length;++t){const e=s[t];r.skipNulls&&null===n[e]||fr(i,wr(n[e],e,a,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const l=i.join(r.delimiter);let p=!0===r.addQueryPrefix?"?":"";return r.charsetSentinel&&("iso-8859-1"===r.charset?p+="utf8=%26%2310003%3B&":p+="utf8=%E2%9C%93&"),l.length>0?p+l:""}let _r,vr;function Tr(t){let e;return(_r??(e=new globalThis.TextEncoder,_r=e.encode.bind(e)))(t)}function xr(t){let e;return(vr??(e=new globalThis.TextDecoder,vr=e.decode.bind(e)))(t)}var Er,Or;class Ir{constructor(){Er.set(this,void 0),Or.set(this,void 0),En(this,Er,new Uint8Array),En(this,Or,null)}decode(t){if(null==t)return[];const e=t instanceof ArrayBuffer?new Uint8Array(t):"string"==typeof t?Tr(t):t;En(this,Er,function(t){let e=0;for(const n of t)e+=n.length;const n=new Uint8Array(e);let r=0;for(const e of t)n.set(e,r),r+=e.length;return n}([On(this,Er,"f"),e]));const n=[];let r;for(;null!=(r=Dr(On(this,Er,"f"),On(this,Or,"f")));){if(r.carriage&&null==On(this,Or,"f")){En(this,Or,r.index);continue}if(null!=On(this,Or,"f")&&(r.index!==On(this,Or,"f")+1||r.carriage)){n.push(xr(On(this,Er,"f").subarray(0,On(this,Or,"f")-1))),En(this,Er,On(this,Er,"f").subarray(On(this,Or,"f"))),En(this,Or,null);continue}const t=null!==On(this,Or,"f")?r.preceding-1:r.preceding,e=xr(On(this,Er,"f").subarray(0,t));n.push(e),En(this,Er,On(this,Er,"f").subarray(r.index)),En(this,Or,null)}return n}flush(){return On(this,Er,"f").length?this.decode("\n"):[]}}function Dr(t,e){for(let n=e??0;n<t.length;n++){if(10===t[n])return{preceding:n,index:n+1,carriage:!1};if(13===t[n])return{preceding:n,index:n+1,carriage:!0}}return null}function Ar(t){for(let e=0;e<t.length-1;e++){if(10===t[e]&&10===t[e+1])return e+2;if(13===t[e]&&13===t[e+1])return e+2;if(13===t[e]&&10===t[e+1]&&e+3<t.length&&13===t[e+2]&&10===t[e+3])return e+4}return-1}Er=new WeakMap,Or=new WeakMap,Ir.NEWLINE_CHARS=new Set(["\n","\r"]),Ir.NEWLINE_REGEXP=/\r\n|[\n\r]/g;const Sr={off:0,error:200,warn:300,info:400,debug:500},kr=(t,e,n)=>{var r,s;if(t)return r=Sr,s=t,Object.prototype.hasOwnProperty.call(r,s)?t:void Rr(n).warn(`${e} was set to ${JSON.stringify(t)}, expected one of ${JSON.stringify(Object.keys(Sr))}`)};function Nr(){}function Pr(t,e,n){return!e||Sr[t]>Sr[n]?Nr:e[t].bind(e)}const Cr={error:Nr,warn:Nr,info:Nr,debug:Nr};let Lr=new WeakMap;function Rr(t){const e=t.logger,n=t.logLevel??"off";if(!e)return Cr;const r=Lr.get(e);if(r&&r[0]===n)return r[1];const s={error:Pr("error",e,n),warn:Pr("warn",e,n),info:Pr("info",e,n),debug:Pr("debug",e,n)};return Lr.set(e,[n,s]),s}const $r=t=>(t.options&&(t.options={...t.options},delete t.options.headers),t.headers&&(t.headers=Object.fromEntries((t.headers instanceof Headers?[...t.headers]:Object.entries(t.headers)).map(([t,e])=>[t,"authorization"===t.toLowerCase()||"cookie"===t.toLowerCase()||"set-cookie"===t.toLowerCase()?"***":e]))),"retryOfRequestLogID"in t&&(t.retryOfRequestLogID&&(t.retryOf=t.retryOfRequestLogID),delete t.retryOfRequestLogID),t);var jr,qr,Fr;class Mr{constructor(t,e,n){this.iterator=t,jr.set(this,void 0),this.controller=e,En(this,jr,n)}static fromSSEResponse(t,e,n){let r=!1;const s=n?Rr(n):console;return new Mr(async function*(){if(r)throw new Sn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(const r of async function*(t,e){if(!t.body){if(e.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new Sn("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new Sn("Attempted to iterate over a response with no body")}const n=new zr,r=new Ir,s=sr(t.body);for await(const t of async function*(t){let e=new Uint8Array;for await(const n of t){if(null==n)continue;const t=n instanceof ArrayBuffer?new Uint8Array(n):"string"==typeof n?Tr(n):n;let r,s=new Uint8Array(e.length+t.length);for(s.set(e),s.set(t,e.length),e=s;-1!==(r=Ar(e));)yield e.slice(0,r),e=e.slice(r)}e.length>0&&(yield e)}(s))for(const e of r.decode(t)){const t=n.decode(e);t&&(yield t)}for(const t of r.flush()){const e=n.decode(t);e&&(yield e)}}(t,e))if(!n)if(r.data.startsWith("[DONE]"))n=!0;else if(null!==r.event&&r.event.startsWith("thread.")){let t;try{t=JSON.parse(r.data)}catch(t){throw console.error("Could not parse message into JSON:",r.data),console.error("From chunk:",r.raw),t}if("error"==r.event)throw new kn(void 0,t.error,t.message,void 0);yield{event:r.event,data:t}}else{let e;try{e=JSON.parse(r.data)}catch(t){throw s.error("Could not parse message into JSON:",r.data),s.error("From chunk:",r.raw),t}if(e&&e.error)throw new kn(void 0,e.error,void 0,t.headers);yield e}n=!0}catch(t){if(Dn(t))return;throw t}finally{n||e.abort()}},e,n)}static fromReadableStream(t,e,n){let r=!1;return new Mr(async function*(){if(r)throw new Sn("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let n=!1;try{for await(const e of async function*(){const e=new Ir,n=sr(t);for await(const t of n)for(const n of e.decode(t))yield n;for(const t of e.flush())yield t}())n||e&&(yield JSON.parse(e));n=!0}catch(t){if(Dn(t))return;throw t}finally{n||e.abort()}},e,n)}[(jr=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){const t=[],e=[],n=this.iterator(),r=r=>({next:()=>{if(0===r.length){const r=n.next();t.push(r),e.push(r)}return r.shift()}});return[new Mr(()=>r(t),this.controller,On(this,jr,"f")),new Mr(()=>r(e),this.controller,On(this,jr,"f"))]}toReadableStream(){const t=this;let e;return nr({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{const{value:n,done:r}=await e.next();if(r)return t.close();const s=Tr(JSON.stringify(n)+"\n");t.enqueue(s)}catch(e){t.error(e)}},async cancel(){await(e.return?.())}})}}class zr{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(t){if(t.endsWith("\r")&&(t=t.substring(0,t.length-1)),!t){if(!this.event&&!this.data.length)return null;const t={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],t}if(this.chunks.push(t),t.startsWith(":"))return null;let[e,n,r]=function(t,e){const n=t.indexOf(e);if(-1!==n)return[t.substring(0,n),e,t.substring(n+e.length)];return[t,"",""]}(t,":");return r.startsWith(" ")&&(r=r.substring(1)),"event"===e?this.event=r:"data"===e&&this.data.push(r),null}}async function Ur(t,e){const{response:n,requestLogID:r,retryOfRequestLogID:s,startTime:o}=e,i=await(async()=>{if(e.options.stream)return Rr(t).debug("response",n.status,n.url,n.headers,n.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(n,e.controller,t):Mr.fromSSEResponse(n,e.controller,t);if(204===n.status)return null;if(e.options.__binaryResponse)return n;const r=n.headers.get("content-type"),s=r?.split(";")[0]?.trim();if(s?.includes("application/json")||s?.endsWith("+json")){return Br(await n.json(),n)}return await n.text()})();return Rr(t).debug(`[${r}] response parsed`,$r({retryOfRequestLogID:s,url:n.url,status:n.status,body:i,durationMs:Date.now()-o})),i}function Br(t,e){return!t||"object"!=typeof t||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Vr extends Promise{constructor(t,e,n=Ur){super(t=>{t(null)}),this.responsePromise=e,this.parseResponse=n,qr.set(this,void 0),En(this,qr,t)}_thenUnwrap(t){return new Vr(On(this,qr,"f"),this.responsePromise,async(e,n)=>Br(t(await this.parseResponse(e,n),n),n.response))}asResponse(){return this.responsePromise.then(t=>t.response)}async withResponse(){const[t,e]=await Promise.all([this.parse(),this.asResponse()]);return{data:t,response:e,request_id:e.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(t=>this.parseResponse(On(this,qr,"f"),t))),this.parsedPromise}then(t,e){return this.parse().then(t,e)}catch(t){return this.parse().catch(t)}finally(t){return this.parse().finally(t)}}qr=new WeakMap;class Zr{constructor(t,e,n,r){Fr.set(this,void 0),En(this,Fr,t),this.options=r,this.response=e,this.body=n}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){const t=this.nextPageRequestOptions();if(!t)throw new Sn("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await On(this,Fr,"f").requestAPIList(this.constructor,t)}async*iterPages(){let t=this;for(yield t;t.hasNextPage();)t=await t.getNextPage(),yield t}async*[(Fr=new WeakMap,Symbol.asyncIterator)](){for await(const t of this.iterPages())for(const e of t.getPaginatedItems())yield e}}class Hr extends Vr{constructor(t,e,n){super(t,e,async(t,e)=>new n(t,e.response,await Ur(t,e),e.options))}async*[Symbol.asyncIterator](){const t=await(this);for await(const e of t)yield e}}class Wr extends Zr{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[],this.object=n.object}getPaginatedItems(){return this.data??[]}nextPageRequestOptions(){return null}}class Xr extends Zr{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[],this.has_more=n.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){const t=this.getPaginatedItems(),e=t[t.length-1]?.id;return e?{...this.options,query:{...Xn(this.options.query),after:e}}:null}}class Gr extends Zr{constructor(t,e,n,r){super(t,e,n,r),this.data=n.data||[],this.has_more=n.has_more||!1,this.last_id=n.last_id||""}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){const t=this.last_id;return t?{...this.options,query:{...Xn(this.options.query),after:t}}:null}}const Kr=()=>{if("undefined"==typeof File){const{process:t}=globalThis,e="string"==typeof t?.versions?.node&&parseInt(t.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(e?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Yr(t,e,n){return Kr(),new File(t,e??"unknown_file",n)}function Jr(t){return("object"==typeof t&&null!==t&&("name"in t&&t.name&&String(t.name)||"url"in t&&t.url&&String(t.url)||"filename"in t&&t.filename&&String(t.filename)||"path"in t&&t.path&&String(t.path))||"").split(/[\\/]/).pop()||void 0}const Qr=t=>null!=t&&"object"==typeof t&&"function"==typeof t[Symbol.asyncIterator],ts=async(t,e)=>os(t.body)?{...t,body:await rs(t.body,e)}:t,es=async(t,e)=>({...t,body:await rs(t.body,e)}),ns=new WeakMap;const rs=async(t,e)=>{if(!await function(t){const e="function"==typeof t?t:t.fetch,n=ns.get(e);if(n)return n;const r=(async()=>{try{const t="Response"in e?e.Response:(await e("data:,")).constructor,n=new FormData;return n.toString()!==await new t(n).text()}catch{return!0}})();return ns.set(e,r),r}(e))throw new TypeError("The provided fetch function does not support file uploads with the current global FormData class.");const n=new FormData;return await Promise.all(Object.entries(t||{}).map(([t,e])=>is(n,t,e))),n},ss=t=>t instanceof Blob&&"name"in t,os=t=>{if((t=>"object"==typeof t&&null!==t&&(t instanceof Response||Qr(t)||ss(t)))(t))return!0;if(Array.isArray(t))return t.some(os);if(t&&"object"==typeof t)for(const e in t)if(os(t[e]))return!0;return!1},is=async(t,e,n)=>{if(void 0!==n){if(null==n)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof n||"number"==typeof n||"boolean"==typeof n)t.append(e,String(n));else if(n instanceof Response)t.append(e,Yr([await n.blob()],Jr(n)));else if(Qr(n))t.append(e,Yr([await new Response(rr(n)).blob()],Jr(n)));else if(ss(n))t.append(e,n,Jr(n));else if(Array.isArray(n))await Promise.all(n.map(n=>is(t,e+"[]",n)));else{if("object"!=typeof n)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`);await Promise.all(Object.entries(n).map(([n,r])=>is(t,`${e}[${n}]`,r)))}}},as=t=>null!=t&&"object"==typeof t&&"number"==typeof t.size&&"string"==typeof t.type&&"function"==typeof t.text&&"function"==typeof t.slice&&"function"==typeof t.arrayBuffer;async function cs(t){let e=[];if("string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(as(t))e.push(t instanceof Blob?t:await t.arrayBuffer());else{if(!Qr(t)){const e=t?.constructor?.name;throw new Error(`Unexpected data type: ${typeof t}${e?`; constructor: ${e}`:""}${function(t){if("object"!=typeof t||null===t)return"";const e=Object.getOwnPropertyNames(t);return`; props: [${e.map(t=>`"${t}"`).join(", ")}]`}(t)}`)}for await(const n of t)e.push(...await cs(n))}return e}class us{constructor(t){this._client=t}}function ls(t){return t.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const ps=Object.freeze(Object.create(null)),hs=(t=ls)=>function(e,...n){if(1===e.length)return e[0];let r=!1;const s=[],o=e.reduce((e,o,i)=>{/[?#]/.test(o)&&(r=!0);const a=n[i];let c=(r?encodeURIComponent:t)(""+a);return i!==n.length&&(null==a||"object"==typeof a&&a.toString===Object.getPrototypeOf(Object.getPrototypeOf(a.hasOwnProperty??ps)??ps)?.toString)&&(c=a+"",s.push({start:e.length+o.length,length:c.length,error:`Value of type ${Object.prototype.toString.call(a).slice(8,-1)} is not a valid path parameter`})),e+o+(i===n.length?"":c)},""),i=o.split(/[?#]/,1)[0],a=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;let c;for(;null!==(c=a.exec(i));)s.push({start:c.index,length:c[0].length,error:`Value "${c[0]}" can't be safely passed as a path parameter`});if(s.sort((t,e)=>t.start-e.start),s.length>0){let t=0;const e=s.reduce((e,n)=>{const r=" ".repeat(n.start-t),s="^".repeat(n.length);return t=n.start+n.length,e+r+s},"");throw new Sn(`Path parameters result in path with invalid segments:\n${s.map(t=>t.error).join("\n")}\n${o}\n${e}`)}return o},ds=hs(ls);let fs=class extends us{list(t,e={},n){return this._client.getAPIList(ds`/chat/completions/${t}/messages`,Xr,{query:e,...n})}};function ms(t){return void 0!==t&&"function"in t&&void 0!==t.function}function gs(t){return"auto-parseable-response-format"===t?.$brand}function ys(t){return"auto-parseable-tool"===t?.$brand}function ws(t,e){const n=t.choices.map(t=>{if("length"===t.finish_reason)throw new Un;if("content_filter"===t.finish_reason)throw new Bn;return Ts(t.message.tool_calls),{...t,message:{...t.message,...t.message.tool_calls?{tool_calls:t.message.tool_calls?.map(t=>function(t,e){const n=t.tools?.find(t=>ms(t)&&t.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:ys(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}(e,t))??void 0}:void 0,parsed:t.message.content&&!t.message.refusal?bs(e,t.message.content):null}}});return{...t,choices:n}}function bs(t,e){if("json_schema"!==t.response_format?.type)return null;if("json_schema"===t.response_format?.type){if("$parseRaw"in t.response_format){return t.response_format.$parseRaw(e)}return JSON.parse(e)}return null}function _s(t,e){if(!t||!("tools"in t)||!t.tools)return!1;const n=t.tools?.find(t=>ms(t)&&t.function?.name===e.function.name);return ms(n)&&(ys(n)||n?.function.strict||!1)}function vs(t){return!!gs(t.response_format)||(t.tools?.some(t=>ys(t)||"function"===t.type&&!0===t.function.strict)??!1)}function Ts(t){for(const e of t||[])if("function"!==e.type)throw new Sn(`Currently only \`function\` tool calls are supported; Received \`${e.type}\``)}const xs=t=>"assistant"===t?.role,Es=t=>"tool"===t?.role;var Os,Is,Ds,As,Ss,ks,Ns,Ps,Cs,Ls,Rs,$s,js,qs,Fs,Ms,zs,Us,Bs,Vs,Zs;class Hs{constructor(){Os.add(this),this.controller=new AbortController,Is.set(this,void 0),Ds.set(this,()=>{}),As.set(this,()=>{}),Ss.set(this,void 0),ks.set(this,()=>{}),Ns.set(this,()=>{}),Ps.set(this,{}),Cs.set(this,!1),Ls.set(this,!1),Rs.set(this,!1),$s.set(this,!1),En(this,Is,new Promise((t,e)=>{En(this,Ds,t),En(this,As,e)})),En(this,Ss,new Promise((t,e)=>{En(this,ks,t),En(this,Ns,e)})),On(this,Is,"f").catch(()=>{}),On(this,Ss,"f").catch(()=>{})}_run(t){setTimeout(()=>{t().then(()=>{this._emitFinal(),this._emit("end")},On(this,Os,"m",js).bind(this))},0)}_connected(){this.ended||(On(this,Ds,"f").call(this),this._emit("connect"))}get ended(){return On(this,Cs,"f")}get errored(){return On(this,Ls,"f")}get aborted(){return On(this,Rs,"f")}abort(){this.controller.abort()}on(t,e){return(On(this,Ps,"f")[t]||(On(this,Ps,"f")[t]=[])).push({listener:e}),this}off(t,e){const n=On(this,Ps,"f")[t];if(!n)return this;const r=n.findIndex(t=>t.listener===e);return r>=0&&n.splice(r,1),this}once(t,e){return(On(this,Ps,"f")[t]||(On(this,Ps,"f")[t]=[])).push({listener:e,once:!0}),this}emitted(t){return new Promise((e,n)=>{En(this,$s,!0),"error"!==t&&this.once("error",n),this.once(t,e)})}async done(){En(this,$s,!0),await On(this,Ss,"f")}_emit(t,...e){if(On(this,Cs,"f"))return;"end"===t&&(En(this,Cs,!0),On(this,ks,"f").call(this));const n=On(this,Ps,"f")[t];if(n&&(On(this,Ps,"f")[t]=n.filter(t=>!t.once),n.forEach(({listener:t})=>t(...e))),"abort"===t){const t=e[0];return On(this,$s,"f")||n?.length||Promise.reject(t),On(this,As,"f").call(this,t),On(this,Ns,"f").call(this,t),void this._emit("end")}if("error"===t){const t=e[0];On(this,$s,"f")||n?.length||Promise.reject(t),On(this,As,"f").call(this,t),On(this,Ns,"f").call(this,t),this._emit("end")}}_emitFinal(){}}function Ws(t){return"function"==typeof t.parse}Is=new WeakMap,Ds=new WeakMap,As=new WeakMap,Ss=new WeakMap,ks=new WeakMap,Ns=new WeakMap,Ps=new WeakMap,Cs=new WeakMap,Ls=new WeakMap,Rs=new WeakMap,$s=new WeakMap,Os=new WeakSet,js=function(t){if(En(this,Ls,!0),t instanceof Error&&"AbortError"===t.name&&(t=new Nn),t instanceof Nn)return En(this,Rs,!0),this._emit("abort",t);if(t instanceof Sn)return this._emit("error",t);if(t instanceof Error){const e=new Sn(t.message);return e.cause=t,this._emit("error",e)}return this._emit("error",new Sn(String(t)))};const Xs=10;class Gs extends Hs{constructor(){super(...arguments),qs.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(t){this._chatCompletions.push(t),this._emit("chatCompletion",t);const e=t.choices[0]?.message;return e&&this._addMessage(e),t}_addMessage(t,e=!0){if("content"in t||(t.content=null),this.messages.push(t),e)if(this._emit("message",t),Es(t)&&t.content)this._emit("functionToolCallResult",t.content);else if(xs(t)&&t.tool_calls)for(const e of t.tool_calls)"function"===e.type&&this._emit("functionToolCall",e.function)}async finalChatCompletion(){await this.done();const t=this._chatCompletions[this._chatCompletions.length-1];if(!t)throw new Sn("stream ended without producing a ChatCompletion");return t}async finalContent(){return await this.done(),On(this,qs,"m",Fs).call(this)}async finalMessage(){return await this.done(),On(this,qs,"m",Ms).call(this)}async finalFunctionToolCall(){return await this.done(),On(this,qs,"m",zs).call(this)}async finalFunctionToolCallResult(){return await this.done(),On(this,qs,"m",Us).call(this)}async totalUsage(){return await this.done(),On(this,qs,"m",Bs).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const t=this._chatCompletions[this._chatCompletions.length-1];t&&this._emit("finalChatCompletion",t);const e=On(this,qs,"m",Ms).call(this);e&&this._emit("finalMessage",e);const n=On(this,qs,"m",Fs).call(this);n&&this._emit("finalContent",n);const r=On(this,qs,"m",zs).call(this);r&&this._emit("finalFunctionToolCall",r);const s=On(this,qs,"m",Us).call(this);null!=s&&this._emit("finalFunctionToolCallResult",s),this._chatCompletions.some(t=>t.usage)&&this._emit("totalUsage",On(this,qs,"m",Bs).call(this))}async _createChatCompletion(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),On(this,qs,"m",Vs).call(this,e);const s=await t.chat.completions.create({...e,stream:!1},{...n,signal:this.controller.signal});return this._connected(),this._addChatCompletion(ws(s,e))}async _runChatCompletion(t,e,n){for(const t of e.messages)this._addMessage(t,!1);return await this._createChatCompletion(t,e,n)}async _runTools(t,e,n){const r="tool",{tool_choice:s="auto",stream:o,...i}=e,a="string"!=typeof s&&"function"===s.type&&s?.function?.name,{maxChatCompletions:c=Xs}=n||{},u=e.tools.map(t=>{if(ys(t)){if(!t.$callback)throw new Sn("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:t.$callback,name:t.function.name,description:t.function.description||"",parameters:t.function.parameters,parse:t.$parseRaw,strict:!0}}}return t}),l={};for(const t of u)"function"===t.type&&(l[t.function.name||t.function.function.name]=t.function);const p="tools"in e?u.map(t=>"function"===t.type?{type:"function",function:{name:t.function.name||t.function.function.name,parameters:t.function.parameters,description:t.function.description,strict:t.function.strict}}:t):void 0;for(const t of e.messages)this._addMessage(t,!1);for(let e=0;e<c;++e){const e=await this._createChatCompletion(t,{...i,tool_choice:s,tools:p,messages:[...this.messages]},n),o=e.choices[0]?.message;if(!o)throw new Sn("missing message in ChatCompletion response");if(!o.tool_calls?.length)return;for(const t of o.tool_calls){if("function"!==t.type)continue;const e=t.id,{name:n,arguments:s}=t.function,o=l[n];if(!o){const t=`Invalid tool_call: ${JSON.stringify(n)}. Available options are: ${Object.keys(l).map(t=>JSON.stringify(t)).join(", ")}. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}if(a&&a!==n){const t=`Invalid tool_call: ${JSON.stringify(n)}. ${JSON.stringify(a)} requested. Please try again`;this._addMessage({role:r,tool_call_id:e,content:t});continue}let i;try{i=Ws(o)?await o.parse(s):s}catch(t){const n=t instanceof Error?t.message:String(t);this._addMessage({role:r,tool_call_id:e,content:n});continue}const c=await o.function(i,this),u=On(this,qs,"m",Zs).call(this,c);if(this._addMessage({role:r,tool_call_id:e,content:u}),a)return}}}}qs=new WeakSet,Fs=function(){return On(this,qs,"m",Ms).call(this).content??null},Ms=function(){let t=this.messages.length;for(;t-- >0;){const e=this.messages[t];if(xs(e)){return{...e,content:e.content??null,refusal:e.refusal??null}}}throw new Sn("stream ended without producing a ChatCompletionMessage with role=assistant")},zs=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(xs(e)&&e?.tool_calls?.length)return e.tool_calls.filter(t=>"function"===t.type).at(-1)?.function}},Us=function(){for(let t=this.messages.length-1;t>=0;t--){const e=this.messages[t];if(Es(e)&&null!=e.content&&"string"==typeof e.content&&this.messages.some(t=>"assistant"===t.role&&t.tool_calls?.some(t=>"function"===t.type&&t.id===e.tool_call_id)))return e.content}},Bs=function(){const t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},Vs=function(t){if(null!=t.n&&t.n>1)throw new Sn("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Zs=function(t){return"string"==typeof t?t:void 0===t?"undefined":JSON.stringify(t)};class Ks extends Gs{static runTools(t,e,n){const r=new Ks,s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(t,e,s)),r}_addMessage(t,e=!0){super._addMessage(t,e),xs(t)&&t.content&&this._emit("content",t.content)}}const Ys=1,Js=2,Qs=4,to=8,eo=16,no=32,ro=64,so=128,oo=256,io=511;class ao extends Error{}class co extends Error{}const uo=(t,e)=>{const n=t.length;let r=0;const s=t=>{throw new ao(`${t} at position ${r}`)},o=t=>{throw new co(`${t} at position ${r}`)},i=()=>(p(),r>=n&&s("Unexpected end of input"),'"'===t[r]?a():"{"===t[r]?c():"["===t[r]?u():"null"===t.substring(r,r+4)||eo&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):"true"===t.substring(r,r+4)||no&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):"false"===t.substring(r,r+5)||no&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):"Infinity"===t.substring(r,r+8)||so&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):"-Infinity"===t.substring(r,r+9)||oo&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):"NaN"===t.substring(r,r+3)||ro&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):l()),a=()=>{const i=r;let a=!1;for(r++;r<n&&('"'!==t[r]||a&&"\\"===t[r-1]);)a="\\"===t[r]&&!a,r++;if('"'==t.charAt(r))try{return JSON.parse(t.substring(i,++r-Number(a)))}catch(t){o(String(t))}else if(Ys&e)try{return JSON.parse(t.substring(i,r-Number(a))+'"')}catch(e){return JSON.parse(t.substring(i,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,p();const o={};try{for(;"}"!==t[r];){if(p(),r>=n&&to&e)return o;const s=a();p(),r++;try{const t=i();Object.defineProperty(o,s,{value:t,writable:!0,enumerable:!0,configurable:!0})}catch(t){if(to&e)return o;throw t}p(),","===t[r]&&r++}}catch(t){if(to&e)return o;s("Expected '}' at end of object")}return r++,o},u=()=>{r++;const n=[];try{for(;"]"!==t[r];)n.push(i()),p(),","===t[r]&&r++}catch(t){if(Qs&e)return n;s("Expected ']' at end of array")}return r++,n},l=()=>{if(0===r){"-"===t&&Js&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(n){if(Js&e)try{return"."===t[t.length-1]?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch(t){}o(String(n))}}const i=r;for("-"===t[r]&&r++;t[r]&&!",]}".includes(t[r]);)r++;r!=n||Js&e||s("Unterminated number literal");try{return JSON.parse(t.substring(i,r))}catch(n){"-"===t.substring(i,r)&&Js&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(i,t.lastIndexOf("e")))}catch(t){o(String(t))}}},p=()=>{for(;r<n&&" \n\r\t".includes(t[r]);)r++};return i()},lo=t=>function(t,e=io){if("string"!=typeof t)throw new TypeError("expecting str, got "+typeof t);if(!t.trim())throw new Error(`${t} is empty`);return uo(t.trim(),e)}(t,io^Js);var po,ho,fo,mo,go,yo,wo,bo,_o,vo,To,xo;class Eo extends Gs{constructor(t){super(),po.add(this),ho.set(this,void 0),fo.set(this,void 0),mo.set(this,void 0),En(this,ho,t),En(this,fo,[])}get currentChatCompletionSnapshot(){return On(this,mo,"f")}static fromReadableStream(t){const e=new Eo(null);return e._run(()=>e._fromReadableStream(t)),e}static createChatCompletion(t,e,n){const r=new Eo(e);return r._run(()=>r._runChatCompletion(t,{...e,stream:!0},{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createChatCompletion(t,e,n){super._createChatCompletion;const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),On(this,po,"m",go).call(this);const s=await t.chat.completions.create({...e,stream:!0},{...n,signal:this.controller.signal});this._connected();for await(const t of s)On(this,po,"m",wo).call(this,t);if(s.controller.signal?.aborted)throw new Nn;return this._addChatCompletion(On(this,po,"m",vo).call(this))}async _fromReadableStream(t,e){const n=e?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),On(this,po,"m",go).call(this),this._connected();const r=Mr.fromReadableStream(t,this.controller);let s;for await(const t of r)s&&s!==t.id&&this._addChatCompletion(On(this,po,"m",vo).call(this)),On(this,po,"m",wo).call(this,t),s=t.id;if(r.controller.signal?.aborted)throw new Nn;return this._addChatCompletion(On(this,po,"m",vo).call(this))}[(ho=new WeakMap,fo=new WeakMap,mo=new WeakMap,po=new WeakSet,go=function(){this.ended||En(this,mo,void 0)},yo=function(t){let e=On(this,fo,"f")[t.index];return e||(e={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},On(this,fo,"f")[t.index]=e,e)},wo=function(t){if(this.ended)return;const e=On(this,po,"m",xo).call(this,t);this._emit("chunk",t,e);for(const n of t.choices){const t=e.choices[n.index];null!=n.delta.content&&"assistant"===t.message?.role&&t.message?.content&&(this._emit("content",n.delta.content,t.message.content),this._emit("content.delta",{delta:n.delta.content,snapshot:t.message.content,parsed:t.message.parsed})),null!=n.delta.refusal&&"assistant"===t.message?.role&&t.message?.refusal&&this._emit("refusal.delta",{delta:n.delta.refusal,snapshot:t.message.refusal}),null!=n.logprobs?.content&&"assistant"===t.message?.role&&this._emit("logprobs.content.delta",{content:n.logprobs?.content,snapshot:t.logprobs?.content??[]}),null!=n.logprobs?.refusal&&"assistant"===t.message?.role&&this._emit("logprobs.refusal.delta",{refusal:n.logprobs?.refusal,snapshot:t.logprobs?.refusal??[]});const r=On(this,po,"m",yo).call(this,t);t.finish_reason&&(On(this,po,"m",_o).call(this,t),null!=r.current_tool_call_index&&On(this,po,"m",bo).call(this,t,r.current_tool_call_index));for(const e of n.delta.tool_calls??[])r.current_tool_call_index!==e.index&&(On(this,po,"m",_o).call(this,t),null!=r.current_tool_call_index&&On(this,po,"m",bo).call(this,t,r.current_tool_call_index)),r.current_tool_call_index=e.index;for(const e of n.delta.tool_calls??[]){const n=t.message.tool_calls?.[e.index];n?.type&&("function"===n?.type?this._emit("tool_calls.function.arguments.delta",{name:n.function?.name,index:e.index,arguments:n.function.arguments,parsed_arguments:n.function.parsed_arguments,arguments_delta:e.function?.arguments??""}):Io(n?.type))}}},bo=function(t,e){if(On(this,po,"m",yo).call(this,t).done_tool_calls.has(e))return;const n=t.message.tool_calls?.[e];if(!n)throw new Error("no tool call snapshot");if(!n.type)throw new Error("tool call snapshot missing `type`");if("function"===n.type){const t=On(this,ho,"f")?.tools?.find(t=>ms(t)&&t.function.name===n.function.name);this._emit("tool_calls.function.arguments.done",{name:n.function.name,index:e,arguments:n.function.arguments,parsed_arguments:ys(t)?t.$parseRaw(n.function.arguments):t?.function.strict?JSON.parse(n.function.arguments):null})}else n.type},_o=function(t){const e=On(this,po,"m",yo).call(this,t);if(t.message.content&&!e.content_done){e.content_done=!0;const n=On(this,po,"m",To).call(this);this._emit("content.done",{content:t.message.content,parsed:n?n.$parseRaw(t.message.content):null})}t.message.refusal&&!e.refusal_done&&(e.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),t.logprobs?.content&&!e.logprobs_content_done&&(e.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),t.logprobs?.refusal&&!e.logprobs_refusal_done&&(e.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},vo=function(){if(this.ended)throw new Sn("stream has ended, this shouldn't happen");const t=On(this,mo,"f");if(!t)throw new Sn("request ended without sending any chunks");return En(this,mo,void 0),En(this,fo,[]),function(t,e){const{id:n,choices:r,created:s,model:o,system_fingerprint:i,...a}=t,c={...a,id:n,choices:r.map(({message:e,finish_reason:n,index:r,logprobs:s,...o})=>{if(!n)throw new Sn(`missing finish_reason for choice ${r}`);const{content:i=null,function_call:a,tool_calls:c,...u}=e,l=e.role;if(!l)throw new Sn(`missing role for choice ${r}`);if(a){const{arguments:t,name:c}=a;if(null==t)throw new Sn(`missing function_call.arguments for choice ${r}`);if(!c)throw new Sn(`missing function_call.name for choice ${r}`);return{...o,message:{content:i,function_call:{arguments:t,name:c},role:l,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}}return c?{...o,index:r,finish_reason:n,logprobs:s,message:{...u,role:l,content:i,refusal:e.refusal??null,tool_calls:c.map((e,n)=>{const{function:s,type:o,id:i,...a}=e,{arguments:c,name:u,...l}=s||{};if(null==i)throw new Sn(`missing choices[${r}].tool_calls[${n}].id\n${Oo(t)}`);if(null==o)throw new Sn(`missing choices[${r}].tool_calls[${n}].type\n${Oo(t)}`);if(null==u)throw new Sn(`missing choices[${r}].tool_calls[${n}].function.name\n${Oo(t)}`);if(null==c)throw new Sn(`missing choices[${r}].tool_calls[${n}].function.arguments\n${Oo(t)}`);return{...a,id:i,type:o,function:{...l,name:u,arguments:c}}})}}:{...o,message:{...u,content:i,role:l,refusal:e.refusal??null},finish_reason:n,index:r,logprobs:s}}),created:s,model:o,object:"chat.completion",...i?{system_fingerprint:i}:{}};return function(t,e){return e&&vs(e)?ws(t,e):{...t,choices:t.choices.map(t=>(Ts(t.message.tool_calls),{...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}}(c,e)}(t,On(this,ho,"f"))},To=function(){const t=On(this,ho,"f")?.response_format;return gs(t)?t:null},xo=function(t){var e,n,r,s;let o=On(this,mo,"f");const{choices:i,...a}=t;o?Object.assign(o,a):o=En(this,mo,{...a,choices:[]});for(const{delta:i,finish_reason:a,index:c,logprobs:u=null,...l}of t.choices){let t=o.choices[c];if(t||(t=o.choices[c]={finish_reason:a,index:c,message:{},logprobs:u,...l}),u)if(t.logprobs){const{content:r,refusal:s,...o}=u;Object.assign(t.logprobs,o),r&&((e=t.logprobs).content??(e.content=[]),t.logprobs.content.push(...r)),s&&((n=t.logprobs).refusal??(n.refusal=[]),t.logprobs.refusal.push(...s))}else t.logprobs=Object.assign({},u);if(a&&(t.finish_reason=a,On(this,ho,"f")&&vs(On(this,ho,"f")))){if("length"===a)throw new Un;if("content_filter"===a)throw new Bn}if(Object.assign(t,l),!i)continue;const{content:p,refusal:h,function_call:d,role:f,tool_calls:m,...g}=i;if(Object.assign(t.message,g),h&&(t.message.refusal=(t.message.refusal||"")+h),f&&(t.message.role=f),d&&(t.message.function_call?(d.name&&(t.message.function_call.name=d.name),d.arguments&&((r=t.message.function_call).arguments??(r.arguments=""),t.message.function_call.arguments+=d.arguments)):t.message.function_call=d),p&&(t.message.content=(t.message.content||"")+p,!t.message.refusal&&On(this,po,"m",To).call(this)&&(t.message.parsed=lo(t.message.content))),m){t.message.tool_calls||(t.message.tool_calls=[]);for(const{index:e,id:n,type:r,function:o,...i}of m){const a=(s=t.message.tool_calls)[e]??(s[e]={});Object.assign(a,i),n&&(a.id=n),r&&(a.type=r),o&&(a.function??(a.function={name:o.name??"",arguments:""})),o?.name&&(a.function.name=o.name),o?.arguments&&(a.function.arguments+=o.arguments,_s(On(this,ho,"f"),a)&&(a.function.parsed_arguments=lo(a.function.arguments)))}}}return o},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("chunk",n=>{const r=e.shift();r?r.resolve(n):t.push(n)}),this.on("end",()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0}),this.on("abort",t=>{n=!0;for(const n of e)n.reject(t);e.length=0}),this.on("error",t=>{n=!0;for(const n of e)n.reject(t);e.length=0}),{next:async()=>{if(!t.length)return n?{value:void 0,done:!0}:new Promise((t,n)=>e.push({resolve:t,reject:n})).then(t=>t?{value:t,done:!1}:{value:void 0,done:!0});return{value:t.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Mr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Oo(t){return JSON.stringify(t)}function Io(t){}class Do extends Eo{static fromReadableStream(t){const e=new Do(null);return e._run(()=>e._fromReadableStream(t)),e}static runTools(t,e,n){const r=new Do(e),s={...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"runTools"}};return r._run(()=>r._runTools(t,e,s)),r}}let Ao=class extends us{constructor(){super(...arguments),this.messages=new fs(this._client)}create(t,e){return this._client.post("/chat/completions",{body:t,...e,stream:t.stream??!1})}retrieve(t,e){return this._client.get(ds`/chat/completions/${t}`,e)}update(t,e,n){return this._client.post(ds`/chat/completions/${t}`,{body:e,...n})}list(t={},e){return this._client.getAPIList("/chat/completions",Xr,{query:t,...e})}delete(t,e){return this._client.delete(ds`/chat/completions/${t}`,e)}parse(t,e){return function(t){for(const e of t??[]){if("function"!==e.type)throw new Sn(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(!0!==e.function.strict)throw new Sn(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}(t.tools),this._client.chat.completions.create(t,{...e,headers:{...e?.headers,"X-Stainless-Helper-Method":"chat.completions.parse"}})._thenUnwrap(e=>ws(e,t))}runTools(t,e){return t.stream?Do.runTools(this._client,t,e):Ks.runTools(this._client,t,e)}stream(t,e){return Eo.createChatCompletion(this._client,t,e)}};Ao.Messages=fs;class So extends us{constructor(){super(...arguments),this.completions=new Ao(this._client)}}So.Completions=Ao;const ko=Symbol("brand.privateNullableHeaders");function*No(t){if(!t)return;if(ko in t){const{values:e,nulls:n}=t;yield*e.entries();for(const t of n)yield[t,null];return}let e,n=!1;t instanceof Headers?e=t.entries():Wn(t)?e=t:(n=!0,e=Object.entries(t??{}));for(let t of e){const e=t[0];if("string"!=typeof e)throw new TypeError("expected header name to be a string");const r=Wn(t[1])?t[1]:[t[1]];let s=!1;for(const t of r)void 0!==t&&(n&&!s&&(s=!0,yield[e,null]),yield[e,t])}}const Po=t=>{const e=new Headers,n=new Set;for(const r of t){const t=new Set;for(const[s,o]of No(r)){const r=s.toLowerCase();t.has(r)||(e.delete(s),t.add(r)),null===o?(e.delete(s),n.add(r)):(e.append(s,o),n.delete(r))}}return{[ko]:!0,values:e,nulls:n}};class Co extends us{create(t,e){return this._client.post("/audio/speech",{body:t,...e,headers:Po([{Accept:"application/octet-stream"},e?.headers]),__binaryResponse:!0})}}class Lo extends us{create(t,e){return this._client.post("/audio/transcriptions",es({body:t,...e,stream:t.stream??!1,__metadata:{model:t.model}},this._client))}}class Ro extends us{create(t,e){return this._client.post("/audio/translations",es({body:t,...e,__metadata:{model:t.model}},this._client))}}class $o extends us{constructor(){super(...arguments),this.transcriptions=new Lo(this._client),this.translations=new Ro(this._client),this.speech=new Co(this._client)}}$o.Transcriptions=Lo,$o.Translations=Ro,$o.Speech=Co;class jo extends us{create(t,e){return this._client.post("/batches",{body:t,...e})}retrieve(t,e){return this._client.get(ds`/batches/${t}`,e)}list(t={},e){return this._client.getAPIList("/batches",Xr,{query:t,...e})}cancel(t,e){return this._client.post(ds`/batches/${t}/cancel`,e)}}class qo extends us{create(t,e){return this._client.post("/assistants",{body:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}retrieve(t,e){return this._client.get(ds`/assistants/${t}`,{...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}update(t,e,n){return this._client.post(ds`/assistants/${t}`,{body:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(t={},e){return this._client.getAPIList("/assistants",Xr,{query:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}delete(t,e){return this._client.delete(ds`/assistants/${t}`,{...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}}let Fo=class extends us{create(t,e){return this._client.post("/realtime/sessions",{body:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}};class Mo extends us{create(t,e){return this._client.post("/realtime/transcription_sessions",{body:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}}let zo=class extends us{constructor(){super(...arguments),this.sessions=new Fo(this._client),this.transcriptionSessions=new Mo(this._client)}};zo.Sessions=Fo,zo.TranscriptionSessions=Mo;class Uo extends us{create(t,e){return this._client.post("/chatkit/sessions",{body:t,...e,headers:Po([{"OpenAI-Beta":"chatkit_beta=v1"},e?.headers])})}cancel(t,e){return this._client.post(ds`/chatkit/sessions/${t}/cancel`,{...e,headers:Po([{"OpenAI-Beta":"chatkit_beta=v1"},e?.headers])})}}let Bo=class extends us{retrieve(t,e){return this._client.get(ds`/chatkit/threads/${t}`,{...e,headers:Po([{"OpenAI-Beta":"chatkit_beta=v1"},e?.headers])})}list(t={},e){return this._client.getAPIList("/chatkit/threads",Gr,{query:t,...e,headers:Po([{"OpenAI-Beta":"chatkit_beta=v1"},e?.headers])})}delete(t,e){return this._client.delete(ds`/chatkit/threads/${t}`,{...e,headers:Po([{"OpenAI-Beta":"chatkit_beta=v1"},e?.headers])})}listItems(t,e={},n){return this._client.getAPIList(ds`/chatkit/threads/${t}/items`,Gr,{query:e,...n,headers:Po([{"OpenAI-Beta":"chatkit_beta=v1"},n?.headers])})}};class Vo extends us{constructor(){super(...arguments),this.sessions=new Uo(this._client),this.threads=new Bo(this._client)}}Vo.Sessions=Uo,Vo.Threads=Bo;class Zo extends us{create(t,e,n){return this._client.post(ds`/threads/${t}/messages`,{body:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,e,n){const{thread_id:r}=e;return this._client.get(ds`/threads/${r}/messages/${t}`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,e,n){const{thread_id:r,...s}=e;return this._client.post(ds`/threads/${r}/messages/${t}`,{body:s,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(t,e={},n){return this._client.getAPIList(ds`/threads/${t}/messages`,Xr,{query:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(t,e,n){const{thread_id:r}=e;return this._client.delete(ds`/threads/${r}/messages/${t}`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}class Ho extends us{retrieve(t,e,n){const{thread_id:r,run_id:s,...o}=e;return this._client.get(ds`/threads/${r}/runs/${s}/steps/${t}`,{query:o,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(t,e,n){const{thread_id:r,...s}=e;return this._client.getAPIList(ds`/threads/${r}/runs/${t}/steps`,Xr,{query:s,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}const Wo=t=>void 0!==globalThis.process?globalThis.process.env?.[t]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(t)?.trim():void 0;var Xo,Go,Ko,Yo,Jo,Qo,ti,ei,ni,ri,si,oi,ii,ai,ci,ui,li,pi,hi,di,fi,mi,gi;class yi extends Hs{constructor(){super(...arguments),Xo.add(this),Ko.set(this,[]),Yo.set(this,{}),Jo.set(this,{}),Qo.set(this,void 0),ti.set(this,void 0),ei.set(this,void 0),ni.set(this,void 0),ri.set(this,void 0),si.set(this,void 0),oi.set(this,void 0),ii.set(this,void 0),ai.set(this,void 0)}[(Ko=new WeakMap,Yo=new WeakMap,Jo=new WeakMap,Qo=new WeakMap,ti=new WeakMap,ei=new WeakMap,ni=new WeakMap,ri=new WeakMap,si=new WeakMap,oi=new WeakMap,ii=new WeakMap,ai=new WeakMap,Xo=new WeakSet,Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("event",n=>{const r=e.shift();r?r.resolve(n):t.push(n)}),this.on("end",()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0}),this.on("abort",t=>{n=!0;for(const n of e)n.reject(t);e.length=0}),this.on("error",t=>{n=!0;for(const n of e)n.reject(t);e.length=0}),{next:async()=>{if(!t.length)return n?{value:void 0,done:!0}:new Promise((t,n)=>e.push({resolve:t,reject:n})).then(t=>t?{value:t,done:!1}:{value:void 0,done:!0});return{value:t.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(t){const e=new Go;return e._run(()=>e._fromReadableStream(t)),e}async _fromReadableStream(t,e){const n=e?.signal;n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),this._connected();const r=Mr.fromReadableStream(t,this.controller);for await(const t of r)On(this,Xo,"m",ci).call(this,t);if(r.controller.signal?.aborted)throw new Nn;return this._addRun(On(this,Xo,"m",ui).call(this))}toReadableStream(){return new Mr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(t,e,n,r){const s=new Go;return s._run(()=>s._runToolAssistantStream(t,e,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createToolAssistantStream(t,e,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.submitToolOutputs(e,o,{...r,signal:this.controller.signal});this._connected();for await(const t of i)On(this,Xo,"m",ci).call(this,t);if(i.controller.signal?.aborted)throw new Nn;return this._addRun(On(this,Xo,"m",ui).call(this))}static createThreadAssistantStream(t,e,n){const r=new Go;return r._run(()=>r._threadAssistantStream(t,e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}static createAssistantStream(t,e,n,r){const s=new Go;return s._run(()=>s._runAssistantStream(t,e,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}currentEvent(){return On(this,oi,"f")}currentRun(){return On(this,ii,"f")}currentMessageSnapshot(){return On(this,Qo,"f")}currentRunStepSnapshot(){return On(this,ai,"f")}async finalRunSteps(){return await this.done(),Object.values(On(this,Yo,"f"))}async finalMessages(){return await this.done(),Object.values(On(this,Jo,"f"))}async finalRun(){if(await this.done(),!On(this,ti,"f"))throw Error("Final run was not received.");return On(this,ti,"f")}async _createThreadAssistantStream(t,e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort()));const s={...e,stream:!0},o=await t.createAndRun(s,{...n,signal:this.controller.signal});this._connected();for await(const t of o)On(this,Xo,"m",ci).call(this,t);if(o.controller.signal?.aborted)throw new Nn;return this._addRun(On(this,Xo,"m",ui).call(this))}async _createAssistantStream(t,e,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const o={...n,stream:!0},i=await t.create(e,o,{...r,signal:this.controller.signal});this._connected();for await(const t of i)On(this,Xo,"m",ci).call(this,t);if(i.controller.signal?.aborted)throw new Nn;return this._addRun(On(this,Xo,"m",ui).call(this))}static accumulateDelta(t,e){for(const[n,r]of Object.entries(e)){if(!t.hasOwnProperty(n)){t[n]=r;continue}let e=t[n];if(null!=e)if("index"!==n&&"type"!==n){if("string"==typeof e&&"string"==typeof r)e+=r;else if("number"==typeof e&&"number"==typeof r)e+=r;else{if(!Gn(e)||!Gn(r)){if(Array.isArray(e)&&Array.isArray(r)){if(e.every(t=>"string"==typeof t||"number"==typeof t)){e.push(...r);continue}for(const t of r){if(!Gn(t))throw new Error(`Expected array delta entry to be an object but got: ${t}`);const n=t.index;if(null==n)throw console.error(t),new Error("Expected array delta entry to have an `index` property");if("number"!=typeof n)throw new Error(`Expected array delta entry \`index\` property to be a number but got ${n}`);const r=e[n];null==r?e.push(t):e[n]=this.accumulateDelta(r,t)}continue}throw Error(`Unhandled record type: ${n}, deltaValue: ${r}, accValue: ${e}`)}e=this.accumulateDelta(e,r)}t[n]=e}else t[n]=r;else t[n]=r}return t}_addRun(t){return t}async _threadAssistantStream(t,e,n){return await this._createThreadAssistantStream(e,t,n)}async _runAssistantStream(t,e,n,r){return await this._createAssistantStream(e,t,n,r)}async _runToolAssistantStream(t,e,n,r){return await this._createToolAssistantStream(e,t,n,r)}}Go=yi,ci=function(t){if(!this.ended)switch(En(this,oi,t),On(this,Xo,"m",hi).call(this,t),t.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":On(this,Xo,"m",gi).call(this,t);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":On(this,Xo,"m",pi).call(this,t);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":On(this,Xo,"m",li).call(this,t);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},ui=function(){if(this.ended)throw new Sn("stream has ended, this shouldn't happen");if(!On(this,ti,"f"))throw Error("Final run has not been received");return On(this,ti,"f")},li=function(t){const[e,n]=On(this,Xo,"m",fi).call(this,t,On(this,Qo,"f"));En(this,Qo,e),On(this,Jo,"f")[e.id]=e;for(const t of n){const n=e.content[t.index];"text"==n?.type&&this._emit("textCreated",n.text)}switch(t.event){case"thread.message.created":this._emit("messageCreated",t.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",t.data.delta,e),t.data.delta.content)for(const n of t.data.delta.content){if("text"==n.type&&n.text){let t=n.text,r=e.content[n.index];if(!r||"text"!=r.type)throw Error("The snapshot associated with this text delta is not text or missing");this._emit("textDelta",t,r.text)}if(n.index!=On(this,ei,"f")){if(On(this,ni,"f"))switch(On(this,ni,"f").type){case"text":this._emit("textDone",On(this,ni,"f").text,On(this,Qo,"f"));break;case"image_file":this._emit("imageFileDone",On(this,ni,"f").image_file,On(this,Qo,"f"))}En(this,ei,n.index)}En(this,ni,e.content[n.index])}break;case"thread.message.completed":case"thread.message.incomplete":if(void 0!==On(this,ei,"f")){const e=t.data.content[On(this,ei,"f")];if(e)switch(e.type){case"image_file":this._emit("imageFileDone",e.image_file,On(this,Qo,"f"));break;case"text":this._emit("textDone",e.text,On(this,Qo,"f"))}}On(this,Qo,"f")&&this._emit("messageDone",t.data),En(this,Qo,void 0)}},pi=function(t){const e=On(this,Xo,"m",di).call(this,t);switch(En(this,ai,e),t.event){case"thread.run.step.created":this._emit("runStepCreated",t.data);break;case"thread.run.step.delta":const n=t.data.delta;if(n.step_details&&"tool_calls"==n.step_details.type&&n.step_details.tool_calls&&"tool_calls"==e.step_details.type)for(const t of n.step_details.tool_calls)t.index==On(this,ri,"f")?this._emit("toolCallDelta",t,e.step_details.tool_calls[t.index]):(On(this,si,"f")&&this._emit("toolCallDone",On(this,si,"f")),En(this,ri,t.index),En(this,si,e.step_details.tool_calls[t.index]),On(this,si,"f")&&this._emit("toolCallCreated",On(this,si,"f")));this._emit("runStepDelta",t.data.delta,e);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":En(this,ai,void 0);"tool_calls"==t.data.step_details.type&&On(this,si,"f")&&(this._emit("toolCallDone",On(this,si,"f")),En(this,si,void 0)),this._emit("runStepDone",t.data,e)}},hi=function(t){On(this,Ko,"f").push(t),this._emit("event",t)},di=function(t){switch(t.event){case"thread.run.step.created":return On(this,Yo,"f")[t.data.id]=t.data,t.data;case"thread.run.step.delta":let e=On(this,Yo,"f")[t.data.id];if(!e)throw Error("Received a RunStepDelta before creation of a snapshot");let n=t.data;if(n.delta){const r=Go.accumulateDelta(e,n.delta);On(this,Yo,"f")[t.data.id]=r}return On(this,Yo,"f")[t.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":On(this,Yo,"f")[t.data.id]=t.data}if(On(this,Yo,"f")[t.data.id])return On(this,Yo,"f")[t.data.id];throw new Error("No snapshot available")},fi=function(t,e){let n=[];switch(t.event){case"thread.message.created":return[t.data,n];case"thread.message.delta":if(!e)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let r=t.data;if(r.delta.content)for(const t of r.delta.content)if(t.index in e.content){let n=e.content[t.index];e.content[t.index]=On(this,Xo,"m",mi).call(this,t,n)}else e.content[t.index]=t,n.push(t);return[e,n];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(e)return[e,n];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},mi=function(t,e){return Go.accumulateDelta(e,t)},gi=function(t){switch(En(this,ii,t.data),t.event){case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":case"thread.run.incomplete":En(this,ti,t.data),On(this,si,"f")&&(this._emit("toolCallDone",On(this,si,"f")),En(this,si,void 0))}};let wi=class extends us{constructor(){super(...arguments),this.steps=new Ho(this._client)}create(t,e,n){const{include:r,...s}=e;return this._client.post(ds`/threads/${t}/runs`,{query:{include:r},body:s,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:e.stream??!1})}retrieve(t,e,n){const{thread_id:r}=e;return this._client.get(ds`/threads/${r}/runs/${t}`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,e,n){const{thread_id:r,...s}=e;return this._client.post(ds`/threads/${r}/runs/${t}`,{body:s,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(t,e={},n){return this._client.getAPIList(ds`/threads/${t}/runs`,Xr,{query:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}cancel(t,e,n){const{thread_id:r}=e;return this._client.post(ds`/threads/${r}/runs/${t}/cancel`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(r.id,{thread_id:t},n)}createAndStream(t,e,n){return yi.createAssistantStream(t,this._client.beta.threads.runs,e,n)}async poll(t,e,n){const r=Po([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:s,response:o}=await this.retrieve(t,e,{...n,headers:{...n?.headers,...r}}).withResponse();switch(s.status){case"queued":case"in_progress":case"cancelling":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=o.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await Kn(t);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return s}}}stream(t,e,n){return yi.createAssistantStream(t,this._client.beta.threads.runs,e,n)}submitToolOutputs(t,e,n){const{thread_id:r,...s}=e;return this._client.post(ds`/threads/${r}/runs/${t}/submit_tool_outputs`,{body:s,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers]),stream:e.stream??!1})}async submitToolOutputsAndPoll(t,e,n){const r=await this.submitToolOutputs(t,e,n);return await this.poll(r.id,e,n)}submitToolOutputsStream(t,e,n){return yi.createToolAssistantStream(t,this._client.beta.threads.runs,e,n)}};wi.Steps=Ho;class bi extends us{constructor(){super(...arguments),this.runs=new wi(this._client),this.messages=new Zo(this._client)}create(t={},e){return this._client.post("/threads",{body:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}retrieve(t,e){return this._client.get(ds`/threads/${t}`,{...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}update(t,e,n){return this._client.post(ds`/threads/${t}`,{body:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(t,e){return this._client.delete(ds`/threads/${t}`,{...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}createAndRun(t,e){return this._client.post("/threads/runs",{body:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers]),stream:t.stream??!1})}async createAndRunPoll(t,e){const n=await this.createAndRun(t,e);return await this.runs.poll(n.id,{thread_id:n.thread_id},e)}createAndRunStream(t,e){return yi.createThreadAssistantStream(t,this._client.beta.threads,e)}}bi.Runs=wi,bi.Messages=Zo;class _i extends us{constructor(){super(...arguments),this.realtime=new zo(this._client),this.chatkit=new Vo(this._client),this.assistants=new qo(this._client),this.threads=new bi(this._client)}}_i.Realtime=zo,_i.ChatKit=Vo,_i.Assistants=qo,_i.Threads=bi;class vi extends us{create(t,e){return this._client.post("/completions",{body:t,...e,stream:t.stream??!1})}}class Ti extends us{retrieve(t,e,n){const{container_id:r}=e;return this._client.get(ds`/containers/${r}/files/${t}/content`,{...n,headers:Po([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}}let xi=class extends us{constructor(){super(...arguments),this.content=new Ti(this._client)}create(t,e,n){return this._client.post(ds`/containers/${t}/files`,es({body:e,...n},this._client))}retrieve(t,e,n){const{container_id:r}=e;return this._client.get(ds`/containers/${r}/files/${t}`,n)}list(t,e={},n){return this._client.getAPIList(ds`/containers/${t}/files`,Xr,{query:e,...n})}delete(t,e,n){const{container_id:r}=e;return this._client.delete(ds`/containers/${r}/files/${t}`,{...n,headers:Po([{Accept:"*/*"},n?.headers])})}};xi.Content=Ti;class Ei extends us{constructor(){super(...arguments),this.files=new xi(this._client)}create(t,e){return this._client.post("/containers",{body:t,...e})}retrieve(t,e){return this._client.get(ds`/containers/${t}`,e)}list(t={},e){return this._client.getAPIList("/containers",Xr,{query:t,...e})}delete(t,e){return this._client.delete(ds`/containers/${t}`,{...e,headers:Po([{Accept:"*/*"},e?.headers])})}}Ei.Files=xi;class Oi extends us{create(t,e,n){const{include:r,...s}=e;return this._client.post(ds`/conversations/${t}/items`,{query:{include:r},body:s,...n})}retrieve(t,e,n){const{conversation_id:r,...s}=e;return this._client.get(ds`/conversations/${r}/items/${t}`,{query:s,...n})}list(t,e={},n){return this._client.getAPIList(ds`/conversations/${t}/items`,Gr,{query:e,...n})}delete(t,e,n){const{conversation_id:r}=e;return this._client.delete(ds`/conversations/${r}/items/${t}`,n)}}class Ii extends us{constructor(){super(...arguments),this.items=new Oi(this._client)}create(t={},e){return this._client.post("/conversations",{body:t,...e})}retrieve(t,e){return this._client.get(ds`/conversations/${t}`,e)}update(t,e,n){return this._client.post(ds`/conversations/${t}`,{body:e,...n})}delete(t,e){return this._client.delete(ds`/conversations/${t}`,e)}}Ii.Items=Oi;class Di extends us{create(t,e){const n=!!t.encoding_format;let r=n?t.encoding_format:"base64";n&&Rr(this._client).debug("embeddings/user defined encoding_format:",t.encoding_format);const s=this._client.post("/embeddings",{body:{...t,encoding_format:r},...e});return n?s:(Rr(this._client).debug("embeddings/decoding base64 embeddings from base64"),s._thenUnwrap(t=>(t&&t.data&&t.data.forEach(t=>{const e=t.embedding;t.embedding=(t=>{if("undefined"!=typeof Buffer){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let t=0;t<n;t++)r[t]=e.charCodeAt(t);return Array.from(new Float32Array(r.buffer))}})(e)}),t)))}}class Ai extends us{retrieve(t,e,n){const{eval_id:r,run_id:s}=e;return this._client.get(ds`/evals/${r}/runs/${s}/output_items/${t}`,n)}list(t,e,n){const{eval_id:r,...s}=e;return this._client.getAPIList(ds`/evals/${r}/runs/${t}/output_items`,Xr,{query:s,...n})}}class Si extends us{constructor(){super(...arguments),this.outputItems=new Ai(this._client)}create(t,e,n){return this._client.post(ds`/evals/${t}/runs`,{body:e,...n})}retrieve(t,e,n){const{eval_id:r}=e;return this._client.get(ds`/evals/${r}/runs/${t}`,n)}list(t,e={},n){return this._client.getAPIList(ds`/evals/${t}/runs`,Xr,{query:e,...n})}delete(t,e,n){const{eval_id:r}=e;return this._client.delete(ds`/evals/${r}/runs/${t}`,n)}cancel(t,e,n){const{eval_id:r}=e;return this._client.post(ds`/evals/${r}/runs/${t}`,n)}}Si.OutputItems=Ai;class ki extends us{constructor(){super(...arguments),this.runs=new Si(this._client)}create(t,e){return this._client.post("/evals",{body:t,...e})}retrieve(t,e){return this._client.get(ds`/evals/${t}`,e)}update(t,e,n){return this._client.post(ds`/evals/${t}`,{body:e,...n})}list(t={},e){return this._client.getAPIList("/evals",Xr,{query:t,...e})}delete(t,e){return this._client.delete(ds`/evals/${t}`,e)}}ki.Runs=Si;let Ni=class extends us{create(t,e){return this._client.post("/files",es({body:t,...e},this._client))}retrieve(t,e){return this._client.get(ds`/files/${t}`,e)}list(t={},e){return this._client.getAPIList("/files",Xr,{query:t,...e})}delete(t,e){return this._client.delete(ds`/files/${t}`,e)}content(t,e){return this._client.get(ds`/files/${t}/content`,{...e,headers:Po([{Accept:"application/binary"},e?.headers]),__binaryResponse:!0})}async waitForProcessing(t,{pollInterval:e=5e3,maxWait:n=18e5}={}){const r=new Set(["processed","error","deleted"]),s=Date.now();let o=await this.retrieve(t);for(;!o.status||!r.has(o.status);)if(await Kn(e),o=await this.retrieve(t),Date.now()-s>n)throw new Cn({message:`Giving up on waiting for file ${t} to finish processing after ${n} milliseconds.`});return o}};class Pi extends us{}let Ci=class extends us{run(t,e){return this._client.post("/fine_tuning/alpha/graders/run",{body:t,...e})}validate(t,e){return this._client.post("/fine_tuning/alpha/graders/validate",{body:t,...e})}};class Li extends us{constructor(){super(...arguments),this.graders=new Ci(this._client)}}Li.Graders=Ci;class Ri extends us{create(t,e,n){return this._client.getAPIList(ds`/fine_tuning/checkpoints/${t}/permissions`,Wr,{body:e,method:"post",...n})}retrieve(t,e={},n){return this._client.get(ds`/fine_tuning/checkpoints/${t}/permissions`,{query:e,...n})}delete(t,e,n){const{fine_tuned_model_checkpoint:r}=e;return this._client.delete(ds`/fine_tuning/checkpoints/${r}/permissions/${t}`,n)}}let $i=class extends us{constructor(){super(...arguments),this.permissions=new Ri(this._client)}};$i.Permissions=Ri;class ji extends us{list(t,e={},n){return this._client.getAPIList(ds`/fine_tuning/jobs/${t}/checkpoints`,Xr,{query:e,...n})}}class qi extends us{constructor(){super(...arguments),this.checkpoints=new ji(this._client)}create(t,e){return this._client.post("/fine_tuning/jobs",{body:t,...e})}retrieve(t,e){return this._client.get(ds`/fine_tuning/jobs/${t}`,e)}list(t={},e){return this._client.getAPIList("/fine_tuning/jobs",Xr,{query:t,...e})}cancel(t,e){return this._client.post(ds`/fine_tuning/jobs/${t}/cancel`,e)}listEvents(t,e={},n){return this._client.getAPIList(ds`/fine_tuning/jobs/${t}/events`,Xr,{query:e,...n})}pause(t,e){return this._client.post(ds`/fine_tuning/jobs/${t}/pause`,e)}resume(t,e){return this._client.post(ds`/fine_tuning/jobs/${t}/resume`,e)}}qi.Checkpoints=ji;class Fi extends us{constructor(){super(...arguments),this.methods=new Pi(this._client),this.jobs=new qi(this._client),this.checkpoints=new $i(this._client),this.alpha=new Li(this._client)}}Fi.Methods=Pi,Fi.Jobs=qi,Fi.Checkpoints=$i,Fi.Alpha=Li;class Mi extends us{}class zi extends us{constructor(){super(...arguments),this.graderModels=new Mi(this._client)}}zi.GraderModels=Mi;class Ui extends us{createVariation(t,e){return this._client.post("/images/variations",es({body:t,...e},this._client))}edit(t,e){return this._client.post("/images/edits",es({body:t,...e,stream:t.stream??!1},this._client))}generate(t,e){return this._client.post("/images/generations",{body:t,...e,stream:t.stream??!1})}}class Bi extends us{retrieve(t,e){return this._client.get(ds`/models/${t}`,e)}list(t){return this._client.getAPIList("/models",Wr,t)}delete(t,e){return this._client.delete(ds`/models/${t}`,e)}}class Vi extends us{create(t,e){return this._client.post("/moderations",{body:t,...e})}}class Zi extends us{accept(t,e,n){return this._client.post(ds`/realtime/calls/${t}/accept`,{body:e,...n,headers:Po([{Accept:"*/*"},n?.headers])})}hangup(t,e){return this._client.post(ds`/realtime/calls/${t}/hangup`,{...e,headers:Po([{Accept:"*/*"},e?.headers])})}refer(t,e,n){return this._client.post(ds`/realtime/calls/${t}/refer`,{body:e,...n,headers:Po([{Accept:"*/*"},n?.headers])})}reject(t,e={},n){return this._client.post(ds`/realtime/calls/${t}/reject`,{body:e,...n,headers:Po([{Accept:"*/*"},n?.headers])})}}class Hi extends us{create(t,e){return this._client.post("/realtime/client_secrets",{body:t,...e})}}class Wi extends us{constructor(){super(...arguments),this.clientSecrets=new Hi(this._client),this.calls=new Zi(this._client)}}function Xi(t,e){return e&&function(t){if(gs(t.text?.format))return!0;return!1}(e)?Gi(t,e):{...t,output_parsed:null,output:t.output.map(t=>"function_call"===t.type?{...t,parsed_arguments:null}:"message"===t.type?{...t,content:t.content.map(t=>({...t,parsed:null}))}:t)}}function Gi(t,e){const n=t.output.map(t=>{if("function_call"===t.type)return{...t,parsed_arguments:Yi(e,t)};if("message"===t.type){const n=t.content.map(t=>"output_text"===t.type?{...t,parsed:Ki(e,t.text)}:t);return{...t,content:n}}return t}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||Ji(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const t of r.output)if("message"===t.type)for(const e of t.content)if("output_text"===e.type&&null!==e.parsed)return e.parsed;return null}}),r}function Ki(t,e){if("json_schema"!==t.text?.format?.type)return null;if("$parseRaw"in t.text?.format){const n=t.text?.format;return n.$parseRaw(e)}return JSON.parse(e)}function Yi(t,e){const n=(r=t.tools??[],s=e.name,r.find(t=>"function"===t.type&&t.name===s));var r,s,o;return{...e,...e,parsed_arguments:(o=n,"auto-parseable-tool"===o?.$brand?n.$parseRaw(e.arguments):n?.strict?JSON.parse(e.arguments):null)}}function Ji(t){const e=[];for(const n of t.output)if("message"===n.type)for(const t of n.content)"output_text"===t.type&&e.push(t.text);t.output_text=e.join("")}var Qi,ta,ea,na,ra,sa,oa,ia;Wi.ClientSecrets=Hi,Wi.Calls=Zi;class aa extends Hs{constructor(t){super(),Qi.add(this),ta.set(this,void 0),ea.set(this,void 0),na.set(this,void 0),En(this,ta,t)}static createResponse(t,e,n){const r=new aa(e);return r._run(()=>r._createOrRetrieveResponse(t,e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"stream"}})),r}async _createOrRetrieveResponse(t,e,n){const r=n?.signal;let s;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),On(this,Qi,"m",ra).call(this);let o=null;"response_id"in e?(s=await t.responses.retrieve(e.response_id,{stream:!0},{...n,signal:this.controller.signal,stream:!0}),o=e.starting_after??null):s=await t.responses.create({...e,stream:!0},{...n,signal:this.controller.signal}),this._connected();for await(const t of s)On(this,Qi,"m",sa).call(this,t,o);if(s.controller.signal?.aborted)throw new Nn;return On(this,Qi,"m",oa).call(this)}[(ta=new WeakMap,ea=new WeakMap,na=new WeakMap,Qi=new WeakSet,ra=function(){this.ended||En(this,ea,void 0)},sa=function(t,e){if(this.ended)return;const n=(t,n)=>{(null==e||n.sequence_number>e)&&this._emit(t,n)},r=On(this,Qi,"m",ia).call(this,t);switch(n("event",t),t.type){case"response.output_text.delta":{const e=r.output[t.output_index];if(!e)throw new Sn(`missing output at index ${t.output_index}`);if("message"===e.type){const r=e.content[t.content_index];if(!r)throw new Sn(`missing content at index ${t.content_index}`);if("output_text"!==r.type)throw new Sn(`expected content to be 'output_text', got ${r.type}`);n("response.output_text.delta",{...t,snapshot:r.text})}break}case"response.function_call_arguments.delta":{const e=r.output[t.output_index];if(!e)throw new Sn(`missing output at index ${t.output_index}`);"function_call"===e.type&&n("response.function_call_arguments.delta",{...t,snapshot:e.arguments});break}default:n(t.type,t)}},oa=function(){if(this.ended)throw new Sn("stream has ended, this shouldn't happen");const t=On(this,ea,"f");if(!t)throw new Sn("request ended without sending any events");En(this,ea,void 0);const e=function(t,e){return Xi(t,e)}(t,On(this,ta,"f"));return En(this,na,e),e},ia=function(t){let e=On(this,ea,"f");if(!e){if("response.created"!==t.type)throw new Sn(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return e=En(this,ea,t.response),e}switch(t.type){case"response.output_item.added":e.output.push(t.item);break;case"response.content_part.added":{const n=e.output[t.output_index];if(!n)throw new Sn(`missing output at index ${t.output_index}`);const r=n.type,s=t.part;"message"===r&&"reasoning_text"!==s.type?n.content.push(s):"reasoning"===r&&"reasoning_text"===s.type&&(n.content||(n.content=[]),n.content.push(s));break}case"response.output_text.delta":{const n=e.output[t.output_index];if(!n)throw new Sn(`missing output at index ${t.output_index}`);if("message"===n.type){const e=n.content[t.content_index];if(!e)throw new Sn(`missing content at index ${t.content_index}`);if("output_text"!==e.type)throw new Sn(`expected content to be 'output_text', got ${e.type}`);e.text+=t.delta}break}case"response.function_call_arguments.delta":{const n=e.output[t.output_index];if(!n)throw new Sn(`missing output at index ${t.output_index}`);"function_call"===n.type&&(n.arguments+=t.delta);break}case"response.reasoning_text.delta":{const n=e.output[t.output_index];if(!n)throw new Sn(`missing output at index ${t.output_index}`);if("reasoning"===n.type){const e=n.content?.[t.content_index];if(!e)throw new Sn(`missing content at index ${t.content_index}`);if("reasoning_text"!==e.type)throw new Sn(`expected content to be 'reasoning_text', got ${e.type}`);e.text+=t.delta}break}case"response.completed":En(this,ea,t.response)}return e},Symbol.asyncIterator)](){const t=[],e=[];let n=!1;return this.on("event",n=>{const r=e.shift();r?r.resolve(n):t.push(n)}),this.on("end",()=>{n=!0;for(const t of e)t.resolve(void 0);e.length=0}),this.on("abort",t=>{n=!0;for(const n of e)n.reject(t);e.length=0}),this.on("error",t=>{n=!0;for(const n of e)n.reject(t);e.length=0}),{next:async()=>{if(!t.length)return n?{value:void 0,done:!0}:new Promise((t,n)=>e.push({resolve:t,reject:n})).then(t=>t?{value:t,done:!1}:{value:void 0,done:!0});return{value:t.shift(),done:!1}},return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const t=On(this,na,"f");if(!t)throw new Sn("stream ended without producing a ChatCompletion");return t}}class ca extends us{list(t,e={},n){return this._client.getAPIList(ds`/responses/${t}/input_items`,Xr,{query:e,...n})}}class ua extends us{count(t={},e){return this._client.post("/responses/input_tokens",{body:t,...e})}}class la extends us{constructor(){super(...arguments),this.inputItems=new ca(this._client),this.inputTokens=new ua(this._client)}create(t,e){return this._client.post("/responses",{body:t,...e,stream:t.stream??!1})._thenUnwrap(t=>("object"in t&&"response"===t.object&&Ji(t),t))}retrieve(t,e={},n){return this._client.get(ds`/responses/${t}`,{query:e,...n,stream:e?.stream??!1})._thenUnwrap(t=>("object"in t&&"response"===t.object&&Ji(t),t))}delete(t,e){return this._client.delete(ds`/responses/${t}`,{...e,headers:Po([{Accept:"*/*"},e?.headers])})}parse(t,e){return this._client.responses.create(t,e)._thenUnwrap(e=>Gi(e,t))}stream(t,e){return aa.createResponse(this._client,t,e)}cancel(t,e){return this._client.post(ds`/responses/${t}/cancel`,e)}compact(t={},e){return this._client.post("/responses/compact",{body:t,...e})}}la.InputItems=ca,la.InputTokens=ua;class pa extends us{create(t,e,n){return this._client.post(ds`/uploads/${t}/parts`,es({body:e,...n},this._client))}}class ha extends us{constructor(){super(...arguments),this.parts=new pa(this._client)}create(t,e){return this._client.post("/uploads",{body:t,...e})}cancel(t,e){return this._client.post(ds`/uploads/${t}/cancel`,e)}complete(t,e,n){return this._client.post(ds`/uploads/${t}/complete`,{body:e,...n})}}ha.Parts=pa;class da extends us{create(t,e,n){return this._client.post(ds`/vector_stores/${t}/file_batches`,{body:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,e,n){const{vector_store_id:r}=e;return this._client.get(ds`/vector_stores/${r}/file_batches/${t}`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}cancel(t,e,n){const{vector_store_id:r}=e;return this._client.post(ds`/vector_stores/${r}/file_batches/${t}/cancel`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(t,e,n){const r=await this.create(t,e);return await this.poll(t,r.id,n)}listFiles(t,e,n){const{vector_store_id:r,...s}=e;return this._client.getAPIList(ds`/vector_stores/${r}/file_batches/${t}/files`,Xr,{query:s,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async poll(t,e,n){const r=Po([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){const{data:s,response:o}=await this.retrieve(e,{vector_store_id:t},{...n,headers:r}).withResponse();switch(s.status){case"in_progress":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=o.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await Kn(t);break;case"failed":case"cancelled":case"completed":return s}}}async uploadAndPoll(t,{files:e,fileIds:n=[]},r){if(null==e||0==e.length)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const s=r?.maxConcurrency??5,o=Math.min(s,e.length),i=this._client,a=e.values(),c=[...n];const u=Array(o).fill(a).map(async function(t){for(let e of t){const t=await i.files.create({file:e,purpose:"assistants"},r);c.push(t.id)}});return await(async t=>{const e=await Promise.allSettled(t),n=e.filter(t=>"rejected"===t.status);if(n.length){for(const t of n)console.error(t.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const t of e)"fulfilled"===t.status&&r.push(t.value);return r})(u),await this.createAndPoll(t,{file_ids:c})}}class fa extends us{create(t,e,n){return this._client.post(ds`/vector_stores/${t}/files`,{body:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}retrieve(t,e,n){const{vector_store_id:r}=e;return this._client.get(ds`/vector_stores/${r}/files/${t}`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}update(t,e,n){const{vector_store_id:r,...s}=e;return this._client.post(ds`/vector_stores/${r}/files/${t}`,{body:s,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(t,e={},n){return this._client.getAPIList(ds`/vector_stores/${t}/files`,Xr,{query:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}delete(t,e,n){const{vector_store_id:r}=e;return this._client.delete(ds`/vector_stores/${r}/files/${t}`,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}async createAndPoll(t,e,n){const r=await this.create(t,e,n);return await this.poll(t,r.id,n)}async poll(t,e,n){const r=Po([n?.headers,{"X-Stainless-Poll-Helper":"true","X-Stainless-Custom-Poll-Interval":n?.pollIntervalMs?.toString()??void 0}]);for(;;){const s=await this.retrieve(e,{vector_store_id:t},{...n,headers:r}).withResponse(),o=s.data;switch(o.status){case"in_progress":let t=5e3;if(n?.pollIntervalMs)t=n.pollIntervalMs;else{const e=s.response.headers.get("openai-poll-after-ms");if(e){const n=parseInt(e);isNaN(n)||(t=n)}}await Kn(t);break;case"failed":case"completed":return o}}}async upload(t,e,n){const r=await this._client.files.create({file:e,purpose:"assistants"},n);return this.create(t,{file_id:r.id},n)}async uploadAndPoll(t,e,n){const r=await this.upload(t,e,n);return await this.poll(t,r.id,n)}content(t,e,n){const{vector_store_id:r}=e;return this._client.getAPIList(ds`/vector_stores/${r}/files/${t}/content`,Wr,{...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}class ma extends us{constructor(){super(...arguments),this.files=new fa(this._client),this.fileBatches=new da(this._client)}create(t,e){return this._client.post("/vector_stores",{body:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}retrieve(t,e){return this._client.get(ds`/vector_stores/${t}`,{...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}update(t,e,n){return this._client.post(ds`/vector_stores/${t}`,{body:e,...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}list(t={},e){return this._client.getAPIList("/vector_stores",Xr,{query:t,...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}delete(t,e){return this._client.delete(ds`/vector_stores/${t}`,{...e,headers:Po([{"OpenAI-Beta":"assistants=v2"},e?.headers])})}search(t,e,n){return this._client.getAPIList(ds`/vector_stores/${t}/search`,Wr,{body:e,method:"post",...n,headers:Po([{"OpenAI-Beta":"assistants=v2"},n?.headers])})}}ma.Files=fa,ma.FileBatches=da;class ga extends us{create(t,e){return this._client.post("/videos",ts({body:t,...e},this._client))}retrieve(t,e){return this._client.get(ds`/videos/${t}`,e)}list(t={},e){return this._client.getAPIList("/videos",Gr,{query:t,...e})}delete(t,e){return this._client.delete(ds`/videos/${t}`,e)}downloadContent(t,e={},n){return this._client.get(ds`/videos/${t}/content`,{query:e,...n,headers:Po([{Accept:"application/binary"},n?.headers]),__binaryResponse:!0})}remix(t,e,n){return this._client.post(ds`/videos/${t}/remix`,ts({body:e,...n},this._client))}}var ya,wa,ba,_a,va,Ta,xa;class Ea extends us{constructor(){super(...arguments),ya.add(this)}async unwrap(t,e,n=this._client.webhookSecret,r=300){return await this.verifySignature(t,e,n,r),JSON.parse(t)}async verifySignature(t,e,n=this._client.webhookSecret,r=300){if("undefined"==typeof crypto||"function"!=typeof crypto.subtle.importKey||"function"!=typeof crypto.subtle.verify)throw new Error("Webhook signature verification is only supported when the `crypto` global is defined");On(this,ya,"m",wa).call(this,n);const s=Po([e]).values,o=On(this,ya,"m",ba).call(this,s,"webhook-signature"),i=On(this,ya,"m",ba).call(this,s,"webhook-timestamp"),a=On(this,ya,"m",ba).call(this,s,"webhook-id"),c=parseInt(i,10);if(isNaN(c))throw new Vn("Invalid webhook timestamp format");const u=Math.floor(Date.now()/1e3);if(u-c>r)throw new Vn("Webhook timestamp is too old");if(c>u+r)throw new Vn("Webhook timestamp is too new");const l=o.split(" ").map(t=>t.startsWith("v1,")?t.substring(3):t),p=n.startsWith("whsec_")?Buffer.from(n.replace("whsec_",""),"base64"):Buffer.from(n,"utf-8"),h=a?`${a}.${i}.${t}`:`${i}.${t}`,d=await crypto.subtle.importKey("raw",p,{name:"HMAC",hash:"SHA-256"},!1,["verify"]);for(const t of l)try{const e=Buffer.from(t,"base64");if(await crypto.subtle.verify("HMAC",d,e,(new TextEncoder).encode(h)))return}catch{continue}throw new Vn("The given webhook signature does not match the expected signature")}}ya=new WeakSet,wa=function(t){if("string"!=typeof t||0===t.length)throw new Error("The webhook secret must either be set using the env var, OPENAI_WEBHOOK_SECRET, on the client class, OpenAI({ webhookSecret: '123' }), or passed to this function")},ba=function(t,e){if(!t)throw new Error("Headers are required");const n=t.get(e);if(null==n)throw new Error(`Missing required header: ${e}`);return n};class Oa{constructor({baseURL:t=Wo("OPENAI_BASE_URL"),apiKey:e=Wo("OPENAI_API_KEY"),organization:n=Wo("OPENAI_ORG_ID")??null,project:r=Wo("OPENAI_PROJECT_ID")??null,webhookSecret:s=Wo("OPENAI_WEBHOOK_SECRET")??null,...o}={}){if(_a.add(this),Ta.set(this,void 0),this.completions=new vi(this),this.chat=new So(this),this.embeddings=new Di(this),this.files=new Ni(this),this.images=new Ui(this),this.audio=new $o(this),this.moderations=new Vi(this),this.models=new Bi(this),this.fineTuning=new Fi(this),this.graders=new zi(this),this.vectorStores=new ma(this),this.webhooks=new Ea(this),this.beta=new _i(this),this.batches=new jo(this),this.uploads=new ha(this),this.responses=new la(this),this.realtime=new Wi(this),this.conversations=new Ii(this),this.evals=new ki(this),this.containers=new Ei(this),this.videos=new ga(this),void 0===e)throw new Sn("Missing credentials. Please pass an `apiKey`, or set the `OPENAI_API_KEY` environment variable.");const i={apiKey:e,organization:n,project:r,webhookSecret:s,...o,baseURL:t||"https://api.openai.com/v1"};if(!i.dangerouslyAllowBrowser&&"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator)throw new Sn("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");this.baseURL=i.baseURL,this.timeout=i.timeout??va.DEFAULT_TIMEOUT,this.logger=i.logger??console;const a="warn";this.logLevel=a,this.logLevel=kr(i.logLevel,"ClientOptions.logLevel",this)??kr(Wo("OPENAI_LOG"),"process.env['OPENAI_LOG']",this)??a,this.fetchOptions=i.fetchOptions,this.maxRetries=i.maxRetries??2,this.fetch=i.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new OpenAI({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),En(this,Ta,or),this._options=i,this.apiKey="string"==typeof e?e:"Missing Key",this.organization=n,this.project=r,this.webhookSecret=s}withOptions(t){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,organization:this.organization,project:this.project,webhookSecret:this.webhookSecret,...t})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:t,nulls:e}){}async authHeaders(t){return Po([{Authorization:`Bearer ${this.apiKey}`}])}stringifyQuery(t){return br(t,{arrayFormat:"brackets"})}getUserAgent(){return`${this.constructor.name}/JS ${Yn}`}defaultIdempotencyKey(){return`stainless-node-retry-${In()}`}makeStatusError(t,e,n,r){return kn.generate(t,e,n,r)}async _callApiKey(){const t=this._options.apiKey;if("function"!=typeof t)return!1;let e;try{e=await t()}catch(t){if(t instanceof Sn)throw t;throw new Sn(`Failed to get token from 'apiKey' function: ${t.message}`,{cause:t})}if("string"!=typeof e||!e)throw new Sn(`Expected 'apiKey' function argument to return a string but it returned ${e}`);return this.apiKey=e,!0}buildURL(t,e,n){const r=!On(this,_a,"m",xa).call(this)&&n||this.baseURL,s=(t=>Zn.test(t))(t)?new URL(t):new URL(r+(r.endsWith("/")&&t.startsWith("/")?t.slice(1):t)),o=this.defaultQuery();return function(t){if(!t)return!0;for(const e in t)return!1;return!0}(o)||(e={...o,...e}),"object"==typeof e&&e&&!Array.isArray(e)&&(s.search=this.stringifyQuery(e)),s.toString()}async prepareOptions(t){await this._callApiKey()}async prepareRequest(t,{url:e,options:n}){}get(t,e){return this.methodRequest("get",t,e)}post(t,e){return this.methodRequest("post",t,e)}patch(t,e){return this.methodRequest("patch",t,e)}put(t,e){return this.methodRequest("put",t,e)}delete(t,e){return this.methodRequest("delete",t,e)}methodRequest(t,e,n){return this.request(Promise.resolve(n).then(n=>({method:t,path:e,...n})))}request(t,e=null){return new Vr(this,this.makeRequest(t,e,void 0))}async makeRequest(t,e,n){const r=await t,s=r.maxRetries??this.maxRetries;null==e&&(e=s),await this.prepareOptions(r);const{req:o,url:i,timeout:a}=await this.buildRequest(r,{retryCount:s-e});await this.prepareRequest(o,{url:i,options:r});const c="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),u=void 0===n?"":`, retryOf: ${n}`,l=Date.now();if(Rr(this).debug(`[${c}] sending request`,$r({retryOfRequestLogID:n,method:r.method,url:i,options:r,headers:o.headers})),r.signal?.aborted)throw new Nn;const p=new AbortController,h=await this.fetchWithTimeout(i,o,a,p).catch(An),d=Date.now();if(h instanceof globalThis.Error){const t=`retrying, ${e} attempts remaining`;if(r.signal?.aborted)throw new Nn;const s=Dn(h)||/timed? ?out/i.test(String(h)+("cause"in h?String(h.cause):""));if(e)return Rr(this).info(`[${c}] connection ${s?"timed out":"failed"} - ${t}`),Rr(this).debug(`[${c}] connection ${s?"timed out":"failed"} (${t})`,$r({retryOfRequestLogID:n,url:i,durationMs:d-l,message:h.message})),this.retryRequest(r,e,n??c);if(Rr(this).info(`[${c}] connection ${s?"timed out":"failed"} - error; no more retries left`),Rr(this).debug(`[${c}] connection ${s?"timed out":"failed"} (error; no more retries left)`,$r({retryOfRequestLogID:n,url:i,durationMs:d-l,message:h.message})),s)throw new Cn;throw new Pn({cause:h})}const f=`[${c}${u}${[...h.headers.entries()].filter(([t])=>"x-request-id"===t).map(([t,e])=>", "+t+": "+JSON.stringify(e)).join("")}] ${o.method} ${i} ${h.ok?"succeeded":"failed"} with status ${h.status} in ${d-l}ms`;if(!h.ok){const t=await this.shouldRetry(h);if(e&&t){const t=`retrying, ${e} attempts remaining`;return await async function(t){if(null===t||"object"!=typeof t)return;if(t[Symbol.asyncIterator])return void await(t[Symbol.asyncIterator]().return?.());const e=t.getReader(),n=e.cancel();e.releaseLock(),await n}(h.body),Rr(this).info(`${f} - ${t}`),Rr(this).debug(`[${c}] response error (${t})`,$r({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:d-l})),this.retryRequest(r,e,n??c,h.headers)}const s=t?"error; no more retries left":"error; not retryable";Rr(this).info(`${f} - ${s}`);const o=await h.text().catch(t=>An(t).message),i=(t=>{try{return JSON.parse(t)}catch(t){return}})(o),a=i?void 0:o;Rr(this).debug(`[${c}] response error (${s})`,$r({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,message:a,durationMs:Date.now()-l}));throw this.makeStatusError(h.status,i,a,h.headers)}return Rr(this).info(f),Rr(this).debug(`[${c}] response start`,$r({retryOfRequestLogID:n,url:h.url,status:h.status,headers:h.headers,durationMs:d-l})),{response:h,options:r,controller:p,requestLogID:c,retryOfRequestLogID:n,startTime:l}}getAPIList(t,e,n){return this.requestAPIList(e,{method:"get",path:t,...n})}requestAPIList(t,e){const n=this.makeRequest(e,null,void 0);return new Hr(this,n,t)}async fetchWithTimeout(t,e,n,r){const{signal:s,method:o,...i}=e||{};s&&s.addEventListener("abort",()=>r.abort());const a=setTimeout(()=>r.abort(),n),c=globalThis.ReadableStream&&i.body instanceof globalThis.ReadableStream||"object"==typeof i.body&&null!==i.body&&Symbol.asyncIterator in i.body,u={signal:r.signal,...c?{duplex:"half"}:{},method:"GET",...i};o&&(u.method=o.toUpperCase());try{return await this.fetch.call(void 0,t,u)}finally{clearTimeout(a)}}async shouldRetry(t){const e=t.headers.get("x-should-retry");return"true"===e||"false"!==e&&(408===t.status||(409===t.status||(429===t.status||t.status>=500)))}async retryRequest(t,e,n,r){let s;const o=r?.get("retry-after-ms");if(o){const t=parseFloat(o);Number.isNaN(t)||(s=t)}const i=r?.get("retry-after");if(i&&!s){const t=parseFloat(i);s=Number.isNaN(t)?Date.parse(i)-Date.now():1e3*t}if(!(s&&0<=s&&s<6e4)){const n=t.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(e,n)}return await Kn(s),this.makeRequest(t,e-1,n)}calculateDefaultRetryTimeoutMillis(t,e){const n=e-t;return Math.min(.5*Math.pow(2,n),8)*(1-.25*Math.random())*1e3}async buildRequest(t,{retryCount:e=0}={}){const n={...t},{method:r,path:s,query:o,defaultBaseURL:i}=n,a=this.buildURL(s,o,i);"timeout"in n&&((t,e)=>{if("number"!=typeof e||!Number.isInteger(e))throw new Sn(`${t} must be an integer`);if(e<0)throw new Sn(`${t} must be a positive integer`)})("timeout",n.timeout),n.timeout=n.timeout??this.timeout;const{bodyHeaders:c,body:u}=this.buildBody({options:n});return{req:{method:r,headers:await this.buildHeaders({options:t,method:r,bodyHeaders:c,retryCount:e}),...n.signal&&{signal:n.signal},...globalThis.ReadableStream&&u instanceof globalThis.ReadableStream&&{duplex:"half"},...u&&{body:u},...this.fetchOptions??{},...n.fetchOptions??{}},url:a,timeout:n.timeout}}async buildHeaders({options:t,method:e,bodyHeaders:n,retryCount:r}){let s={};this.idempotencyHeader&&"get"!==e&&(t.idempotencyKey||(t.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=t.idempotencyKey);const o=Po([s,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r),...t.timeout?{"X-Stainless-Timeout":String(Math.trunc(t.timeout/1e3))}:{},...er??(er=Jn()),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project},await this.authHeaders(t),this._options.defaultHeaders,n,t.headers]);return this.validateHeaders(o),o.values}buildBody({options:{body:t,headers:e}}){if(!t)return{bodyHeaders:void 0,body:void 0};const n=Po([e]);return ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof DataView||"string"==typeof t&&n.values.has("content-type")||globalThis.Blob&&t instanceof globalThis.Blob||t instanceof FormData||t instanceof URLSearchParams||globalThis.ReadableStream&&t instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:t}:"object"==typeof t&&(Symbol.asyncIterator in t||Symbol.iterator in t&&"next"in t&&"function"==typeof t.next)?{bodyHeaders:void 0,body:rr(t)}:On(this,Ta,"f").call(this,{body:t,headers:n})}}va=Oa,Ta=new WeakMap,_a=new WeakSet,xa=function(){return"https://api.openai.com/v1"!==this.baseURL},Oa.OpenAI=va,Oa.DEFAULT_TIMEOUT=6e5,Oa.OpenAIError=Sn,Oa.APIError=kn,Oa.APIConnectionError=Pn,Oa.APIConnectionTimeoutError=Cn,Oa.APIUserAbortError=Nn,Oa.NotFoundError=jn,Oa.ConflictError=qn,Oa.RateLimitError=Mn,Oa.BadRequestError=Ln,Oa.AuthenticationError=Rn,Oa.InternalServerError=zn,Oa.PermissionDeniedError=$n,Oa.UnprocessableEntityError=Fn,Oa.InvalidWebhookSignatureError=Vn,Oa.toFile=async function(t,e,n){if(Kr(),(t=>null!=t&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&as(t))(t=await t))return t instanceof File?t:Yr([await t.arrayBuffer()],t.name);if((t=>null!=t&&"object"==typeof t&&"string"==typeof t.url&&"function"==typeof t.blob)(t)){const r=await t.blob();return e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()),Yr(await cs(r),e,n)}const r=await cs(t);if(e||(e=Jr(t)),!n?.type){const t=r.find(t=>"object"==typeof t&&"type"in t&&t.type);"string"==typeof t&&(n={...n,type:t})}return Yr(r,e,n)},Oa.Completions=vi,Oa.Chat=So,Oa.Embeddings=Di,Oa.Files=Ni,Oa.Images=Ui,Oa.Audio=$o,Oa.Moderations=Vi,Oa.Models=Bi,Oa.FineTuning=Fi,Oa.Graders=zi,Oa.VectorStores=ma,Oa.Webhooks=Ea,Oa.Beta=_i,Oa.Batches=jo,Oa.Uploads=ha,Oa.Responses=la,Oa.Realtime=Wi,Oa.Conversations=Ii,Oa.Evals=ki,Oa.Containers=Ei,Oa.Videos=ga;const Ia=(t="")=>"string"!=typeof t?"":t.replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<!--[\s\S]*?-->/g,"").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim(),Da=(t,e=600)=>{if(t.length<=e)return t;const n=t.substring(0,e),r=n.lastIndexOf("."),s=n.lastIndexOf("!"),o=n.lastIndexOf("?"),i=Math.max(r,s,o);return i>.7*e?n.substring(0,i+1).trim():n.trim()},Aa=t=>t.replace(/```json\s*|\s*```/g,"").trim(),Sa=["interface","display","layout","module","panel","theme"],ka=["hook","endpoint"],Na=["operation"];function Pa(t,e,n){function r(n,r){var s;Object.defineProperty(n,"_zod",{value:n._zod??{},enumerable:!1}),(s=n._zod).traits??(s.traits=new Set),n._zod.traits.add(t),e(n,r);for(const t in i.prototype)t in n||Object.defineProperty(n,t,{value:i.prototype[t].bind(n)});n._zod.constr=i,n._zod.def=r}const s=n?.Parent??Object;class o extends s{}function i(t){var e;const s=n?.Parent?new o:this;r(s,t),(e=s._zod).deferred??(e.deferred=[]);for(const t of s._zod.deferred)t();return s}return Object.defineProperty(o,"name",{value:t}),Object.defineProperty(i,"init",{value:r}),Object.defineProperty(i,Symbol.hasInstance,{value:e=>!!(n?.Parent&&e instanceof n.Parent)||e?._zod?.traits?.has(t)}),Object.defineProperty(i,"name",{value:t}),i}class Ca extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class La extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const Ra={};function $a(t){return Ra}function ja(t,e){return"bigint"==typeof e?e.toString():e}function qa(t){return{get value(){{const e=t();return Object.defineProperty(this,"value",{value:e}),e}}}}function Fa(t){return null==t}function Ma(t){const e=t.startsWith("^")?1:0,n=t.endsWith("$")?t.length-1:t.length;return t.slice(e,n)}const za=Symbol("evaluating");function Ua(t,e,n){let r;Object.defineProperty(t,e,{get(){if(r!==za)return void 0===r&&(r=za,r=n()),r},set(n){Object.defineProperty(t,e,{value:n})},configurable:!0})}function Ba(t,e,n){Object.defineProperty(t,e,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Va(...t){const e={};for(const n of t){const t=Object.getOwnPropertyDescriptors(n);Object.assign(e,t)}return Object.defineProperties({},e)}function Za(t){return JSON.stringify(t)}const Ha="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function Wa(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}const Xa=qa(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return new Function(""),!0}catch(t){return!1}});function Ga(t){if(!1===Wa(t))return!1;const e=t.constructor;if(void 0===e)return!0;const n=e.prototype;return!1!==Wa(n)&&!1!==Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")}function Ka(t){return Ga(t)?{...t}:Array.isArray(t)?[...t]:t}const Ya=new Set(["string","number","symbol"]);function Ja(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Qa(t,e,n){const r=new t._zod.constr(e??t._zod.def);return e&&!n?.parent||(r._zod.parent=t),r}function tc(t){const e=t;if(!e)return{};if("string"==typeof e)return{error:()=>e};if(void 0!==e?.message){if(void 0!==e?.error)throw new Error("Cannot specify both `message` and `error` params");e.error=e.message}return delete e.message,"string"==typeof e.error?{...e,error:()=>e.error}:e}function ec(t,e=0){if(!0===t.aborted)return!0;for(let n=e;n<t.issues.length;n++)if(!0!==t.issues[n]?.continue)return!0;return!1}function nc(t,e){return e.map(e=>{var n;return(n=e).path??(n.path=[]),e.path.unshift(t),e})}function rc(t){return"string"==typeof t?t:t?.message}function sc(t,e,n){const r={...t,path:t.path??[]};if(!t.message){const s=rc(t.inst?._zod.def?.error?.(t))??rc(e?.error?.(t))??rc(n.customError?.(t))??rc(n.localeError?.(t))??"Invalid input";r.message=s}return delete r.inst,delete r.continue,e?.reportInput||delete r.input,r}function oc(t){return Array.isArray(t)?"array":"string"==typeof t?"string":"unknown"}function ic(...t){const[e,n,r]=t;return"string"==typeof e?{message:e,code:"custom",input:n,inst:r}:{...e}}const ac=(t,e)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:e,enumerable:!1}),t.message=JSON.stringify(e,ja,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},cc=Pa("$ZodError",ac),uc=Pa("$ZodError",ac,{Parent:Error});const lc=t=>(e,n,r,s)=>{const o=r?Object.assign(r,{async:!1}):{async:!1},i=e._zod.run({value:n,issues:[]},o);if(i instanceof Promise)throw new Ca;if(i.issues.length){const e=new(s?.Err??t)(i.issues.map(t=>sc(t,o,$a())));throw Ha(e,s?.callee),e}return i.value},pc=t=>async(e,n,r,s)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let i=e._zod.run({value:n,issues:[]},o);if(i instanceof Promise&&(i=await i),i.issues.length){const e=new(s?.Err??t)(i.issues.map(t=>sc(t,o,$a())));throw Ha(e,s?.callee),e}return i.value},hc=t=>(e,n,r)=>{const s=r?{...r,async:!1}:{async:!1},o=e._zod.run({value:n,issues:[]},s);if(o instanceof Promise)throw new Ca;return o.issues.length?{success:!1,error:new(t??cc)(o.issues.map(t=>sc(t,s,$a())))}:{success:!0,data:o.value}},dc=hc(uc),fc=t=>async(e,n,r)=>{const s=r?Object.assign(r,{async:!0}):{async:!0};let o=e._zod.run({value:n,issues:[]},s);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new t(o.issues.map(t=>sc(t,s,$a())))}:{success:!0,data:o.value}},mc=fc(uc),gc=t=>(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return lc(t)(e,n,s)},yc=t=>(e,n,r)=>lc(t)(e,n,r),wc=t=>async(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return pc(t)(e,n,s)},bc=t=>async(e,n,r)=>pc(t)(e,n,r),_c=t=>(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return hc(t)(e,n,s)},vc=t=>(e,n,r)=>hc(t)(e,n,r),Tc=t=>async(e,n,r)=>{const s=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return fc(t)(e,n,s)},xc=t=>async(e,n,r)=>fc(t)(e,n,r),Ec=/^[cC][^\s-]{8,}$/,Oc=/^[0-9a-z]+$/,Ic=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Dc=/^[0-9a-vA-V]{20}$/,Ac=/^[A-Za-z0-9]{27}$/,Sc=/^[a-zA-Z0-9_-]{21}$/,kc=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,Nc=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,Pc=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Cc=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/;const Lc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Rc=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,$c=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,jc=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,qc=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,Fc=/^[A-Za-z0-9_-]*$/,Mc=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,zc=/^\+(?:[0-9]){6,14}[0-9]$/,Uc="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",Bc=new RegExp(`^${Uc}$`);function Vc(t){const e="(?:[01]\\d|2[0-3]):[0-5]\\d";return"number"==typeof t.precision?-1===t.precision?`${e}`:0===t.precision?`${e}:[0-5]\\d`:`${e}:[0-5]\\d\\.\\d{${t.precision}}`:`${e}(?::[0-5]\\d(?:\\.\\d+)?)?`}const Zc=/^(?:true|false)$/i,Hc=/^[^A-Z]*$/,Wc=/^[^a-z]*$/,Xc=Pa("$ZodCheck",(t,e)=>{var n;t._zod??(t._zod={}),t._zod.def=e,(n=t._zod).onattach??(n.onattach=[])}),Gc=Pa("$ZodCheckMaxLength",(t,e)=>{var n;Xc.init(t,e),(n=t._zod.def).when??(n.when=t=>{const e=t.value;return!Fa(e)&&void 0!==e.length}),t._zod.onattach.push(t=>{const n=t._zod.bag.maximum??Number.POSITIVE_INFINITY;e.maximum<n&&(t._zod.bag.maximum=e.maximum)}),t._zod.check=n=>{const r=n.value;if(r.length<=e.maximum)return;const s=oc(r);n.issues.push({origin:s,code:"too_big",maximum:e.maximum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),Kc=Pa("$ZodCheckMinLength",(t,e)=>{var n;Xc.init(t,e),(n=t._zod.def).when??(n.when=t=>{const e=t.value;return!Fa(e)&&void 0!==e.length}),t._zod.onattach.push(t=>{const n=t._zod.bag.minimum??Number.NEGATIVE_INFINITY;e.minimum>n&&(t._zod.bag.minimum=e.minimum)}),t._zod.check=n=>{const r=n.value;if(r.length>=e.minimum)return;const s=oc(r);n.issues.push({origin:s,code:"too_small",minimum:e.minimum,inclusive:!0,input:r,inst:t,continue:!e.abort})}}),Yc=Pa("$ZodCheckLengthEquals",(t,e)=>{var n;Xc.init(t,e),(n=t._zod.def).when??(n.when=t=>{const e=t.value;return!Fa(e)&&void 0!==e.length}),t._zod.onattach.push(t=>{const n=t._zod.bag;n.minimum=e.length,n.maximum=e.length,n.length=e.length}),t._zod.check=n=>{const r=n.value,s=r.length;if(s===e.length)return;const o=oc(r),i=s>e.length;n.issues.push({origin:o,...i?{code:"too_big",maximum:e.length}:{code:"too_small",minimum:e.length},inclusive:!0,exact:!0,input:n.value,inst:t,continue:!e.abort})}}),Jc=Pa("$ZodCheckStringFormat",(t,e)=>{var n,r;Xc.init(t,e),t._zod.onattach.push(t=>{const n=t._zod.bag;n.format=e.format,e.pattern&&(n.patterns??(n.patterns=new Set),n.patterns.add(e.pattern))}),e.pattern?(n=t._zod).check??(n.check=n=>{e.pattern.lastIndex=0,e.pattern.test(n.value)||n.issues.push({origin:"string",code:"invalid_format",format:e.format,input:n.value,...e.pattern?{pattern:e.pattern.toString()}:{},inst:t,continue:!e.abort})}):(r=t._zod).check??(r.check=()=>{})}),Qc=Pa("$ZodCheckRegex",(t,e)=>{Jc.init(t,e),t._zod.check=n=>{e.pattern.lastIndex=0,e.pattern.test(n.value)||n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:e.pattern.toString(),inst:t,continue:!e.abort})}}),tu=Pa("$ZodCheckLowerCase",(t,e)=>{e.pattern??(e.pattern=Hc),Jc.init(t,e)}),eu=Pa("$ZodCheckUpperCase",(t,e)=>{e.pattern??(e.pattern=Wc),Jc.init(t,e)}),nu=Pa("$ZodCheckIncludes",(t,e)=>{Xc.init(t,e);const n=Ja(e.includes),r=new RegExp("number"==typeof e.position?`^.{${e.position}}${n}`:n);e.pattern=r,t._zod.onattach.push(t=>{const e=t._zod.bag;e.patterns??(e.patterns=new Set),e.patterns.add(r)}),t._zod.check=n=>{n.value.includes(e.includes,e.position)||n.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:e.includes,input:n.value,inst:t,continue:!e.abort})}}),ru=Pa("$ZodCheckStartsWith",(t,e)=>{Xc.init(t,e);const n=new RegExp(`^${Ja(e.prefix)}.*`);e.pattern??(e.pattern=n),t._zod.onattach.push(t=>{const e=t._zod.bag;e.patterns??(e.patterns=new Set),e.patterns.add(n)}),t._zod.check=n=>{n.value.startsWith(e.prefix)||n.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:e.prefix,input:n.value,inst:t,continue:!e.abort})}}),su=Pa("$ZodCheckEndsWith",(t,e)=>{Xc.init(t,e);const n=new RegExp(`.*${Ja(e.suffix)}$`);e.pattern??(e.pattern=n),t._zod.onattach.push(t=>{const e=t._zod.bag;e.patterns??(e.patterns=new Set),e.patterns.add(n)}),t._zod.check=n=>{n.value.endsWith(e.suffix)||n.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:e.suffix,input:n.value,inst:t,continue:!e.abort})}}),ou=Pa("$ZodCheckOverwrite",(t,e)=>{Xc.init(t,e),t._zod.check=t=>{t.value=e.tx(t.value)}});class iu{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if("function"==typeof t)return t(this,{execution:"sync"}),void t(this,{execution:"async"});const e=t.split("\n").filter(t=>t),n=Math.min(...e.map(t=>t.length-t.trimStart().length)),r=e.map(t=>t.slice(n)).map(t=>" ".repeat(2*this.indent)+t);for(const t of r)this.content.push(t)}compile(){const t=Function,e=this?.args;return new t(...e,[...(this?.content??[""]).map(t=>`  ${t}`)].join("\n"))}}const au={major:4,minor:1,patch:12},cu=Pa("$ZodType",(t,e)=>{var n;t??(t={}),t._zod.def=e,t._zod.bag=t._zod.bag||{},t._zod.version=au;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const e of r)for(const n of e._zod.onattach)n(t);if(0===r.length)(n=t._zod).deferred??(n.deferred=[]),t._zod.deferred?.push(()=>{t._zod.run=t._zod.parse});else{const e=(t,e,n)=>{let r,s=ec(t);for(const o of e){if(o._zod.def.when){if(!o._zod.def.when(t))continue}else if(s)continue;const e=t.issues.length,i=o._zod.check(t);if(i instanceof Promise&&!1===n?.async)throw new Ca;if(r||i instanceof Promise)r=(r??Promise.resolve()).then(async()=>{await i;t.issues.length!==e&&(s||(s=ec(t,e)))});else{if(t.issues.length===e)continue;s||(s=ec(t,e))}}return r?r.then(()=>t):t},n=(n,s,o)=>{if(ec(n))return n.aborted=!0,n;const i=e(s,r,o);if(i instanceof Promise){if(!1===o.async)throw new Ca;return i.then(e=>t._zod.parse(e,o))}return t._zod.parse(i,o)};t._zod.run=(s,o)=>{if(o.skipChecks)return t._zod.parse(s,o);if("backward"===o.direction){const e=t._zod.parse({value:s.value,issues:[]},{...o,skipChecks:!0});return e instanceof Promise?e.then(t=>n(t,s,o)):n(e,s,o)}const i=t._zod.parse(s,o);if(i instanceof Promise){if(!1===o.async)throw new Ca;return i.then(t=>e(t,r,o))}return e(i,r,o)}}t["~standard"]={validate:e=>{try{const n=dc(t,e);return n.success?{value:n.data}:{issues:n.error?.issues}}catch(n){return mc(t,e).then(t=>t.success?{value:t.data}:{issues:t.error?.issues})}},vendor:"zod",version:1}}),uu=Pa("$ZodString",(t,e)=>{var n;cu.init(t,e),t._zod.pattern=[...t?._zod.bag?.patterns??[]].pop()??(n=t._zod.bag,new RegExp(`^${n?`[\\s\\S]{${n?.minimum??0},${n?.maximum??""}}`:"[\\s\\S]*"}$`)),t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=String(n.value)}catch(r){}return"string"==typeof n.value||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:t}),n}}),lu=Pa("$ZodStringFormat",(t,e)=>{Jc.init(t,e),uu.init(t,e)}),pu=Pa("$ZodGUID",(t,e)=>{e.pattern??(e.pattern=Nc),lu.init(t,e)}),hu=Pa("$ZodUUID",(t,e)=>{if(e.version){const t={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[e.version];if(void 0===t)throw new Error(`Invalid UUID version: "${e.version}"`);e.pattern??(e.pattern=Pc(t))}else e.pattern??(e.pattern=Pc());lu.init(t,e)}),du=Pa("$ZodEmail",(t,e)=>{e.pattern??(e.pattern=Cc),lu.init(t,e)}),fu=Pa("$ZodURL",(t,e)=>{lu.init(t,e),t._zod.check=n=>{try{const r=n.value.trim(),s=new URL(r);return e.hostname&&(e.hostname.lastIndex=0,e.hostname.test(s.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:Mc.source,input:n.value,inst:t,continue:!e.abort})),e.protocol&&(e.protocol.lastIndex=0,e.protocol.test(s.protocol.endsWith(":")?s.protocol.slice(0,-1):s.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:e.protocol.source,input:n.value,inst:t,continue:!e.abort})),void(e.normalize?n.value=s.href:n.value=r)}catch(r){n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:t,continue:!e.abort})}}}),mu=Pa("$ZodEmoji",(t,e)=>{e.pattern??(e.pattern=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),lu.init(t,e)}),gu=Pa("$ZodNanoID",(t,e)=>{e.pattern??(e.pattern=Sc),lu.init(t,e)}),yu=Pa("$ZodCUID",(t,e)=>{e.pattern??(e.pattern=Ec),lu.init(t,e)}),wu=Pa("$ZodCUID2",(t,e)=>{e.pattern??(e.pattern=Oc),lu.init(t,e)}),bu=Pa("$ZodULID",(t,e)=>{e.pattern??(e.pattern=Ic),lu.init(t,e)}),_u=Pa("$ZodXID",(t,e)=>{e.pattern??(e.pattern=Dc),lu.init(t,e)}),vu=Pa("$ZodKSUID",(t,e)=>{e.pattern??(e.pattern=Ac),lu.init(t,e)}),Tu=Pa("$ZodISODateTime",(t,e)=>{e.pattern??(e.pattern=function(t){const e=Vc({precision:t.precision}),n=["Z"];t.local&&n.push(""),t.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${e}(?:${n.join("|")})`;return new RegExp(`^${Uc}T(?:${r})$`)}(e)),lu.init(t,e)}),xu=Pa("$ZodISODate",(t,e)=>{e.pattern??(e.pattern=Bc),lu.init(t,e)}),Eu=Pa("$ZodISOTime",(t,e)=>{e.pattern??(e.pattern=new RegExp(`^${Vc(e)}$`)),lu.init(t,e)}),Ou=Pa("$ZodISODuration",(t,e)=>{e.pattern??(e.pattern=kc),lu.init(t,e)}),Iu=Pa("$ZodIPv4",(t,e)=>{e.pattern??(e.pattern=Lc),lu.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.format="ipv4"})}),Du=Pa("$ZodIPv6",(t,e)=>{e.pattern??(e.pattern=Rc),lu.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.format="ipv6"}),t._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:t,continue:!e.abort})}}}),Au=Pa("$ZodCIDRv4",(t,e)=>{e.pattern??(e.pattern=$c),lu.init(t,e)}),Su=Pa("$ZodCIDRv6",(t,e)=>{e.pattern??(e.pattern=jc),lu.init(t,e),t._zod.check=n=>{const r=n.value.split("/");try{if(2!==r.length)throw new Error;const[t,e]=r;if(!e)throw new Error;const n=Number(e);if(`${n}`!==e)throw new Error;if(n<0||n>128)throw new Error;new URL(`http://[${t}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:t,continue:!e.abort})}}});function ku(t){if(""===t)return!0;if(t.length%4!=0)return!1;try{return atob(t),!0}catch{return!1}}const Nu=Pa("$ZodBase64",(t,e)=>{e.pattern??(e.pattern=qc),lu.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64"}),t._zod.check=n=>{ku(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:t,continue:!e.abort})}});const Pu=Pa("$ZodBase64URL",(t,e)=>{e.pattern??(e.pattern=Fc),lu.init(t,e),t._zod.onattach.push(t=>{t._zod.bag.contentEncoding="base64url"}),t._zod.check=n=>{(function(t){if(!Fc.test(t))return!1;const e=t.replace(/[-_]/g,t=>"-"===t?"+":"/");return ku(e.padEnd(4*Math.ceil(e.length/4),"="))})(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:t,continue:!e.abort})}}),Cu=Pa("$ZodE164",(t,e)=>{e.pattern??(e.pattern=zc),lu.init(t,e)});const Lu=Pa("$ZodJWT",(t,e)=>{lu.init(t,e),t._zod.check=n=>{(function(t,e=null){try{const n=t.split(".");if(3!==n.length)return!1;const[r]=n;if(!r)return!1;const s=JSON.parse(atob(r));return!("typ"in s&&"JWT"!==s?.typ||!s.alg||e&&(!("alg"in s)||s.alg!==e))}catch{return!1}})(n.value,e.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:t,continue:!e.abort})}}),Ru=Pa("$ZodBoolean",(t,e)=>{cu.init(t,e),t._zod.pattern=Zc,t._zod.parse=(n,r)=>{if(e.coerce)try{n.value=Boolean(n.value)}catch(t){}const s=n.value;return"boolean"==typeof s||n.issues.push({expected:"boolean",code:"invalid_type",input:s,inst:t}),n}}),$u=Pa("$ZodUnknown",(t,e)=>{cu.init(t,e),t._zod.parse=t=>t}),ju=Pa("$ZodNever",(t,e)=>{cu.init(t,e),t._zod.parse=(e,n)=>(e.issues.push({expected:"never",code:"invalid_type",input:e.value,inst:t}),e)});function qu(t,e,n){t.issues.length&&e.issues.push(...nc(n,t.issues)),e.value[n]=t.value}const Fu=Pa("$ZodArray",(t,e)=>{cu.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;if(!Array.isArray(s))return n.issues.push({expected:"array",code:"invalid_type",input:s,inst:t}),n;n.value=Array(s.length);const o=[];for(let t=0;t<s.length;t++){const i=s[t],a=e.element._zod.run({value:i,issues:[]},r);a instanceof Promise?o.push(a.then(e=>qu(e,n,t))):qu(a,n,t)}return o.length?Promise.all(o).then(()=>n):n}});function Mu(t,e,n,r){t.issues.length&&e.issues.push(...nc(n,t.issues)),void 0===t.value?n in r&&(e.value[n]=void 0):e.value[n]=t.value}function zu(t){const e=Object.keys(t.shape);for(const n of e)if(!t.shape?.[n]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${n}": expected a Zod schema`);const n=(r=t.shape,Object.keys(r).filter(t=>"optional"===r[t]._zod.optin&&"optional"===r[t]._zod.optout));var r;return{...t,keys:e,keySet:new Set(e),numKeys:e.length,optionalKeys:new Set(n)}}function Uu(t,e,n,r,s,o){const i=[],a=s.keySet,c=s.catchall._zod,u=c.def.type;for(const s of Object.keys(e)){if(a.has(s))continue;if("never"===u){i.push(s);continue}const o=c.run({value:e[s],issues:[]},r);o instanceof Promise?t.push(o.then(t=>Mu(t,n,s,e))):Mu(o,n,s,e)}return i.length&&n.issues.push({code:"unrecognized_keys",keys:i,input:e,inst:o}),t.length?Promise.all(t).then(()=>n):n}const Bu=Pa("$ZodObject",(t,e)=>{cu.init(t,e);const n=Object.getOwnPropertyDescriptor(e,"shape");if(!n?.get){const t=e.shape;Object.defineProperty(e,"shape",{get:()=>{const n={...t};return Object.defineProperty(e,"shape",{value:n}),n}})}const r=qa(()=>zu(e));Ua(t._zod,"propValues",()=>{const t=e.shape,n={};for(const e in t){const r=t[e]._zod;if(r.values){n[e]??(n[e]=new Set);for(const t of r.values)n[e].add(t)}}return n});const s=Wa,o=e.catchall;let i;t._zod.parse=(e,n)=>{i??(i=r.value);const a=e.value;if(!s(a))return e.issues.push({expected:"object",code:"invalid_type",input:a,inst:t}),e;e.value={};const c=[],u=i.shape;for(const t of i.keys){const r=u[t]._zod.run({value:a[t],issues:[]},n);r instanceof Promise?c.push(r.then(n=>Mu(n,e,t,a))):Mu(r,e,t,a)}return o?Uu(c,a,e,n,r.value,t):c.length?Promise.all(c).then(()=>e):e}}),Vu=Pa("$ZodObjectJIT",(t,e)=>{Bu.init(t,e);const n=t._zod.parse,r=qa(()=>zu(e));let s;const o=Wa,i=!Ra.jitless,a=i&&Xa.value,c=e.catchall;let u;t._zod.parse=(l,p)=>{u??(u=r.value);const h=l.value;return o(h)?i&&a&&!1===p?.async&&!0!==p.jitless?(s||(s=(t=>{const e=new iu(["shape","payload","ctx"]),n=r.value,s=t=>{const e=Za(t);return`shape[${e}]._zod.run({ value: input[${e}], issues: [] }, ctx)`};e.write("const input = payload.value;");const o=Object.create(null);let i=0;for(const t of n.keys)o[t]="key_"+i++;e.write("const newResult = {};");for(const t of n.keys){const n=o[t],r=Za(t);e.write(`const ${n} = ${s(t)};`),e.write(`\n        if (${n}.issues.length) {\n          payload.issues = payload.issues.concat(${n}.issues.map(iss => ({\n            ...iss,\n            path: iss.path ? [${r}, ...iss.path] : [${r}]\n          })));\n        }\n        \n        \n        if (${n}.value === undefined) {\n          if (${r} in input) {\n            newResult[${r}] = undefined;\n          }\n        } else {\n          newResult[${r}] = ${n}.value;\n        }\n        \n      `)}e.write("payload.value = newResult;"),e.write("return payload;");const a=e.compile();return(e,n)=>a(t,e,n)})(e.shape)),l=s(l,p),c?Uu([],h,l,p,u,t):l):n(l,p):(l.issues.push({expected:"object",code:"invalid_type",input:h,inst:t}),l)}});function Zu(t,e,n,r){for(const n of t)if(0===n.issues.length)return e.value=n.value,e;const s=t.filter(t=>!ec(t));return 1===s.length?(e.value=s[0].value,s[0]):(e.issues.push({code:"invalid_union",input:e.value,inst:n,errors:t.map(t=>t.issues.map(t=>sc(t,r,$a())))}),e)}const Hu=Pa("$ZodUnion",(t,e)=>{cu.init(t,e),Ua(t._zod,"optin",()=>e.options.some(t=>"optional"===t._zod.optin)?"optional":void 0),Ua(t._zod,"optout",()=>e.options.some(t=>"optional"===t._zod.optout)?"optional":void 0),Ua(t._zod,"values",()=>{if(e.options.every(t=>t._zod.values))return new Set(e.options.flatMap(t=>Array.from(t._zod.values)))}),Ua(t._zod,"pattern",()=>{if(e.options.every(t=>t._zod.pattern)){const t=e.options.map(t=>t._zod.pattern);return new RegExp(`^(${t.map(t=>Ma(t.source)).join("|")})$`)}});const n=1===e.options.length,r=e.options[0]._zod.run;t._zod.parse=(s,o)=>{if(n)return r(s,o);let i=!1;const a=[];for(const t of e.options){const e=t._zod.run({value:s.value,issues:[]},o);if(e instanceof Promise)a.push(e),i=!0;else{if(0===e.issues.length)return e;a.push(e)}}return i?Promise.all(a).then(e=>Zu(e,s,t,o)):Zu(a,s,t,o)}}),Wu=Pa("$ZodIntersection",(t,e)=>{cu.init(t,e),t._zod.parse=(t,n)=>{const r=t.value,s=e.left._zod.run({value:r,issues:[]},n),o=e.right._zod.run({value:r,issues:[]},n);return s instanceof Promise||o instanceof Promise?Promise.all([s,o]).then(([e,n])=>Gu(t,e,n)):Gu(t,s,o)}});function Xu(t,e){if(t===e)return{valid:!0,data:t};if(t instanceof Date&&e instanceof Date&&+t===+e)return{valid:!0,data:t};if(Ga(t)&&Ga(e)){const n=Object.keys(e),r=Object.keys(t).filter(t=>-1!==n.indexOf(t)),s={...t,...e};for(const n of r){const r=Xu(t[n],e[n]);if(!r.valid)return{valid:!1,mergeErrorPath:[n,...r.mergeErrorPath]};s[n]=r.data}return{valid:!0,data:s}}if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let r=0;r<t.length;r++){const s=Xu(t[r],e[r]);if(!s.valid)return{valid:!1,mergeErrorPath:[r,...s.mergeErrorPath]};n.push(s.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function Gu(t,e,n){if(e.issues.length&&t.issues.push(...e.issues),n.issues.length&&t.issues.push(...n.issues),ec(t))return t;const r=Xu(e.value,n.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return t.value=r.data,t}const Ku=Pa("$ZodRecord",(t,e)=>{cu.init(t,e),t._zod.parse=(n,r)=>{const s=n.value;if(!Ga(s))return n.issues.push({expected:"record",code:"invalid_type",input:s,inst:t}),n;const o=[];if(e.keyType._zod.values){const i=e.keyType._zod.values;n.value={};for(const t of i)if("string"==typeof t||"number"==typeof t||"symbol"==typeof t){const i=e.valueType._zod.run({value:s[t],issues:[]},r);i instanceof Promise?o.push(i.then(e=>{e.issues.length&&n.issues.push(...nc(t,e.issues)),n.value[t]=e.value})):(i.issues.length&&n.issues.push(...nc(t,i.issues)),n.value[t]=i.value)}let a;for(const t in s)i.has(t)||(a=a??[],a.push(t));a&&a.length>0&&n.issues.push({code:"unrecognized_keys",input:s,inst:t,keys:a})}else{n.value={};for(const i of Reflect.ownKeys(s)){if("__proto__"===i)continue;const a=e.keyType._zod.run({value:i,issues:[]},r);if(a instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(a.issues.length){n.issues.push({code:"invalid_key",origin:"record",issues:a.issues.map(t=>sc(t,r,$a())),input:i,path:[i],inst:t}),n.value[a.value]=a.value;continue}const c=e.valueType._zod.run({value:s[i],issues:[]},r);c instanceof Promise?o.push(c.then(t=>{t.issues.length&&n.issues.push(...nc(i,t.issues)),n.value[a.value]=t.value})):(c.issues.length&&n.issues.push(...nc(i,c.issues)),n.value[a.value]=c.value)}}return o.length?Promise.all(o).then(()=>n):n}}),Yu=Pa("$ZodEnum",(t,e)=>{cu.init(t,e);const n=function(t){const e=Object.values(t).filter(t=>"number"==typeof t);return Object.entries(t).filter(([t,n])=>-1===e.indexOf(+t)).map(([t,e])=>e)}(e.entries),r=new Set(n);t._zod.values=r,t._zod.pattern=new RegExp(`^(${n.filter(t=>Ya.has(typeof t)).map(t=>"string"==typeof t?Ja(t):t.toString()).join("|")})$`),t._zod.parse=(e,s)=>{const o=e.value;return r.has(o)||e.issues.push({code:"invalid_value",values:n,input:o,inst:t}),e}}),Ju=Pa("$ZodLiteral",(t,e)=>{if(cu.init(t,e),0===e.values.length)throw new Error("Cannot create literal schema with no valid values");t._zod.values=new Set(e.values),t._zod.pattern=new RegExp(`^(${e.values.map(t=>"string"==typeof t?Ja(t):t?Ja(t.toString()):String(t)).join("|")})$`),t._zod.parse=(n,r)=>{const s=n.value;return t._zod.values.has(s)||n.issues.push({code:"invalid_value",values:e.values,input:s,inst:t}),n}}),Qu=Pa("$ZodTransform",(t,e)=>{cu.init(t,e),t._zod.parse=(n,r)=>{if("backward"===r.direction)throw new La(t.constructor.name);const s=e.transform(n.value,n);if(r.async){return(s instanceof Promise?s:Promise.resolve(s)).then(t=>(n.value=t,n))}if(s instanceof Promise)throw new Ca;return n.value=s,n}});function tl(t,e){return t.issues.length&&void 0===e?{issues:[],value:void 0}:t}const el=Pa("$ZodOptional",(t,e)=>{cu.init(t,e),t._zod.optin="optional",t._zod.optout="optional",Ua(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,void 0]):void 0),Ua(t._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${Ma(t.source)})?$`):void 0}),t._zod.parse=(t,n)=>{if("optional"===e.innerType._zod.optin){const r=e.innerType._zod.run(t,n);return r instanceof Promise?r.then(e=>tl(e,t.value)):tl(r,t.value)}return void 0===t.value?t:e.innerType._zod.run(t,n)}}),nl=Pa("$ZodNullable",(t,e)=>{cu.init(t,e),Ua(t._zod,"optin",()=>e.innerType._zod.optin),Ua(t._zod,"optout",()=>e.innerType._zod.optout),Ua(t._zod,"pattern",()=>{const t=e.innerType._zod.pattern;return t?new RegExp(`^(${Ma(t.source)}|null)$`):void 0}),Ua(t._zod,"values",()=>e.innerType._zod.values?new Set([...e.innerType._zod.values,null]):void 0),t._zod.parse=(t,n)=>null===t.value?t:e.innerType._zod.run(t,n)}),rl=Pa("$ZodDefault",(t,e)=>{cu.init(t,e),t._zod.optin="optional",Ua(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(t,n)=>{if("backward"===n.direction)return e.innerType._zod.run(t,n);if(void 0===t.value)return t.value=e.defaultValue,t;const r=e.innerType._zod.run(t,n);return r instanceof Promise?r.then(t=>sl(t,e)):sl(r,e)}});function sl(t,e){return void 0===t.value&&(t.value=e.defaultValue),t}const ol=Pa("$ZodPrefault",(t,e)=>{cu.init(t,e),t._zod.optin="optional",Ua(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(t,n)=>("backward"===n.direction||void 0===t.value&&(t.value=e.defaultValue),e.innerType._zod.run(t,n))}),il=Pa("$ZodNonOptional",(t,e)=>{cu.init(t,e),Ua(t._zod,"values",()=>{const t=e.innerType._zod.values;return t?new Set([...t].filter(t=>void 0!==t)):void 0}),t._zod.parse=(n,r)=>{const s=e.innerType._zod.run(n,r);return s instanceof Promise?s.then(e=>al(e,t)):al(s,t)}});function al(t,e){return t.issues.length||void 0!==t.value||t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:e}),t}const cl=Pa("$ZodCatch",(t,e)=>{cu.init(t,e),Ua(t._zod,"optin",()=>e.innerType._zod.optin),Ua(t._zod,"optout",()=>e.innerType._zod.optout),Ua(t._zod,"values",()=>e.innerType._zod.values),t._zod.parse=(t,n)=>{if("backward"===n.direction)return e.innerType._zod.run(t,n);const r=e.innerType._zod.run(t,n);return r instanceof Promise?r.then(r=>(t.value=r.value,r.issues.length&&(t.value=e.catchValue({...t,error:{issues:r.issues.map(t=>sc(t,n,$a()))},input:t.value}),t.issues=[]),t)):(t.value=r.value,r.issues.length&&(t.value=e.catchValue({...t,error:{issues:r.issues.map(t=>sc(t,n,$a()))},input:t.value}),t.issues=[]),t)}}),ul=Pa("$ZodPipe",(t,e)=>{cu.init(t,e),Ua(t._zod,"values",()=>e.in._zod.values),Ua(t._zod,"optin",()=>e.in._zod.optin),Ua(t._zod,"optout",()=>e.out._zod.optout),Ua(t._zod,"propValues",()=>e.in._zod.propValues),t._zod.parse=(t,n)=>{if("backward"===n.direction){const r=e.out._zod.run(t,n);return r instanceof Promise?r.then(t=>ll(t,e.in,n)):ll(r,e.in,n)}const r=e.in._zod.run(t,n);return r instanceof Promise?r.then(t=>ll(t,e.out,n)):ll(r,e.out,n)}});function ll(t,e,n){return t.issues.length?(t.aborted=!0,t):e._zod.run({value:t.value,issues:t.issues},n)}const pl=Pa("$ZodReadonly",(t,e)=>{cu.init(t,e),Ua(t._zod,"propValues",()=>e.innerType._zod.propValues),Ua(t._zod,"values",()=>e.innerType._zod.values),Ua(t._zod,"optin",()=>e.innerType._zod.optin),Ua(t._zod,"optout",()=>e.innerType._zod.optout),t._zod.parse=(t,n)=>{if("backward"===n.direction)return e.innerType._zod.run(t,n);const r=e.innerType._zod.run(t,n);return r instanceof Promise?r.then(hl):hl(r)}});function hl(t){return t.value=Object.freeze(t.value),t}const dl=Pa("$ZodCustom",(t,e)=>{Xc.init(t,e),cu.init(t,e),t._zod.parse=(t,e)=>t,t._zod.check=n=>{const r=n.value,s=e.fn(r);if(s instanceof Promise)return s.then(e=>fl(e,n,r,t));fl(s,n,r,t)}});function fl(t,e,n,r){if(!t){const t={code:"custom",input:n,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(t.params=r._zod.def.params),e.issues.push(ic(t))}}class ml{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...e){const n=e[0];if(this._map.set(t,n),n&&"object"==typeof n&&"id"in n){if(this._idmap.has(n.id))throw new Error(`ID ${n.id} already exists in the registry`);this._idmap.set(n.id,t)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const e=this._map.get(t);return e&&"object"==typeof e&&"id"in e&&this._idmap.delete(e.id),this._map.delete(t),this}get(t){const e=t._zod.parent;if(e){const n={...this.get(e)??{}};delete n.id;const r={...n,...this._map.get(t)};return Object.keys(r).length?r:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function gl(){return new ml}const yl=gl();function wl(t,e){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...tc(e)})}function bl(t,e){return new Gc({check:"max_length",...tc(e),maximum:t})}function _l(t,e){return new Kc({check:"min_length",...tc(e),minimum:t})}function vl(t,e){return new Yc({check:"length_equals",...tc(e),length:t})}function Tl(t){return new ou({check:"overwrite",tx:t})}function xl(t){const e=function(t,e){const n=new Xc({check:"custom",...tc(e)});return n._zod.check=t,n}(n=>(n.addIssue=t=>{if("string"==typeof t)n.issues.push(ic(t,n.value,e._zod.def));else{const r=t;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=e),r.continue??(r.continue=!e._zod.def.abort),n.issues.push(ic(r))}},t(n.value,n)));return e}const El=Pa("ZodISODateTime",(t,e)=>{Tu.init(t,e),Gl.init(t,e)});function Ol(t){return function(t,e){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...tc(e)})}(El,t)}const Il=Pa("ZodISODate",(t,e)=>{xu.init(t,e),Gl.init(t,e)});function Dl(t){return function(t,e){return new t({type:"string",format:"date",check:"string_format",...tc(e)})}(Il,t)}const Al=Pa("ZodISOTime",(t,e)=>{Eu.init(t,e),Gl.init(t,e)});function Sl(t){return function(t,e){return new t({type:"string",format:"time",check:"string_format",precision:null,...tc(e)})}(Al,t)}const kl=Pa("ZodISODuration",(t,e)=>{Ou.init(t,e),Gl.init(t,e)});function Nl(t){return function(t,e){return new t({type:"string",format:"duration",check:"string_format",...tc(e)})}(kl,t)}const Pl=Pa("ZodError",(t,e)=>{cc.init(t,e),t.name="ZodError",Object.defineProperties(t,{format:{value:e=>function(t,e=t=>t.message){const n={_errors:[]},r=t=>{for(const s of t.issues)if("invalid_union"===s.code&&s.errors.length)s.errors.map(t=>r({issues:t}));else if("invalid_key"===s.code)r({issues:s.issues});else if("invalid_element"===s.code)r({issues:s.issues});else if(0===s.path.length)n._errors.push(e(s));else{let t=n,r=0;for(;r<s.path.length;){const n=s.path[r];r===s.path.length-1?(t[n]=t[n]||{_errors:[]},t[n]._errors.push(e(s))):t[n]=t[n]||{_errors:[]},t=t[n],r++}}};return r(t),n}(t,e)},flatten:{value:e=>function(t,e=t=>t.message){const n={},r=[];for(const s of t.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}(t,e)},addIssue:{value:e=>{t.issues.push(e),t.message=JSON.stringify(t.issues,ja,2)}},addIssues:{value:e=>{t.issues.push(...e),t.message=JSON.stringify(t.issues,ja,2)}},isEmpty:{get:()=>0===t.issues.length}})},{Parent:Error}),Cl=lc(Pl),Ll=pc(Pl),Rl=hc(Pl),$l=fc(Pl),jl=gc(Pl),ql=yc(Pl),Fl=wc(Pl),Ml=bc(Pl),zl=_c(Pl),Ul=vc(Pl),Bl=Tc(Pl),Vl=xc(Pl),Zl=Pa("ZodType",(t,e)=>(cu.init(t,e),t.def=e,t.type=e.type,Object.defineProperty(t,"_def",{value:e}),t.check=(...n)=>t.clone(Va(e,{checks:[...e.checks??[],...n.map(t=>"function"==typeof t?{_zod:{check:t,def:{check:"custom"},onattach:[]}}:t)]})),t.clone=(e,n)=>Qa(t,e,n),t.brand=()=>t,t.register=(e,n)=>(e.add(t,n),t),t.parse=(e,n)=>Cl(t,e,n,{callee:t.parse}),t.safeParse=(e,n)=>Rl(t,e,n),t.parseAsync=async(e,n)=>Ll(t,e,n,{callee:t.parseAsync}),t.safeParseAsync=async(e,n)=>$l(t,e,n),t.spa=t.safeParseAsync,t.encode=(e,n)=>jl(t,e,n),t.decode=(e,n)=>ql(t,e,n),t.encodeAsync=async(e,n)=>Fl(t,e,n),t.decodeAsync=async(e,n)=>Ml(t,e,n),t.safeEncode=(e,n)=>zl(t,e,n),t.safeDecode=(e,n)=>Ul(t,e,n),t.safeEncodeAsync=async(e,n)=>Bl(t,e,n),t.safeDecodeAsync=async(e,n)=>Vl(t,e,n),t.refine=(e,n)=>t.check(function(t,e={}){return function(t,e,n){return new t({type:"custom",check:"custom",fn:e,...tc(n)})}(Hp,t,e)}(e,n)),t.superRefine=e=>t.check(xl(e)),t.overwrite=e=>t.check(Tl(e)),t.optional=()=>$p(t),t.nullable=()=>qp(t),t.nullish=()=>$p(qp(t)),t.nonoptional=e=>function(t,e){return new zp({type:"nonoptional",innerType:t,...tc(e)})}(t,e),t.array=()=>Tp(t),t.or=e=>Ip([t,e]),t.and=e=>new Dp({type:"intersection",left:t,right:e}),t.transform=e=>Vp(t,new Lp({type:"transform",transform:e})),t.default=e=>{return n=e,new Fp({type:"default",innerType:t,get defaultValue(){return"function"==typeof n?n():Ka(n)}});var n},t.prefault=e=>{return n=e,new Mp({type:"prefault",innerType:t,get defaultValue(){return"function"==typeof n?n():Ka(n)}});var n},t.catch=e=>{return new Up({type:"catch",innerType:t,catchValue:"function"==typeof(n=e)?n:()=>n});var n},t.pipe=e=>Vp(t,e),t.readonly=()=>new Zp({type:"readonly",innerType:t}),t.describe=e=>{const n=t.clone();return yl.add(n,{description:e}),n},Object.defineProperty(t,"description",{get:()=>yl.get(t)?.description,configurable:!0}),t.meta=(...e)=>{if(0===e.length)return yl.get(t);const n=t.clone();return yl.add(n,e[0]),n},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),Hl=Pa("_ZodString",(t,e)=>{uu.init(t,e),Zl.init(t,e);const n=t._zod.bag;t.format=n.format??null,t.minLength=n.minimum??null,t.maxLength=n.maximum??null,t.regex=(...e)=>t.check(function(t,e){return new Qc({check:"string_format",format:"regex",...tc(e),pattern:t})}(...e)),t.includes=(...e)=>t.check(function(t,e){return new nu({check:"string_format",format:"includes",...tc(e),includes:t})}(...e)),t.startsWith=(...e)=>t.check(function(t,e){return new ru({check:"string_format",format:"starts_with",...tc(e),prefix:t})}(...e)),t.endsWith=(...e)=>t.check(function(t,e){return new su({check:"string_format",format:"ends_with",...tc(e),suffix:t})}(...e)),t.min=(...e)=>t.check(_l(...e)),t.max=(...e)=>t.check(bl(...e)),t.length=(...e)=>t.check(vl(...e)),t.nonempty=(...e)=>t.check(_l(1,...e)),t.lowercase=e=>t.check(function(t){return new tu({check:"string_format",format:"lowercase",...tc(t)})}(e)),t.uppercase=e=>t.check(function(t){return new eu({check:"string_format",format:"uppercase",...tc(t)})}(e)),t.trim=()=>t.check(Tl(t=>t.trim())),t.normalize=(...e)=>t.check(function(t){return Tl(e=>e.normalize(t))}(...e)),t.toLowerCase=()=>t.check(Tl(t=>t.toLowerCase())),t.toUpperCase=()=>t.check(Tl(t=>t.toUpperCase()))}),Wl=Pa("ZodString",(t,e)=>{uu.init(t,e),Hl.init(t,e),t.email=e=>t.check(function(t,e){return new t({type:"string",format:"email",check:"string_format",abort:!1,...tc(e)})}(Kl,e)),t.url=e=>t.check(function(t,e){return new t({type:"string",format:"url",check:"string_format",abort:!1,...tc(e)})}(Ql,e)),t.jwt=e=>t.check(function(t,e){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...tc(e)})}(fp,e)),t.emoji=e=>t.check(function(t,e){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...tc(e)})}(tp,e)),t.guid=e=>t.check(wl(Yl,e)),t.uuid=e=>t.check(function(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...tc(e)})}(Jl,e)),t.uuidv4=e=>t.check(function(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...tc(e)})}(Jl,e)),t.uuidv6=e=>t.check(function(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...tc(e)})}(Jl,e)),t.uuidv7=e=>t.check(function(t,e){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...tc(e)})}(Jl,e)),t.nanoid=e=>t.check(function(t,e){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...tc(e)})}(ep,e)),t.guid=e=>t.check(wl(Yl,e)),t.cuid=e=>t.check(function(t,e){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...tc(e)})}(np,e)),t.cuid2=e=>t.check(function(t,e){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...tc(e)})}(rp,e)),t.ulid=e=>t.check(function(t,e){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...tc(e)})}(sp,e)),t.base64=e=>t.check(function(t,e){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...tc(e)})}(pp,e)),t.base64url=e=>t.check(function(t,e){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...tc(e)})}(hp,e)),t.xid=e=>t.check(function(t,e){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...tc(e)})}(op,e)),t.ksuid=e=>t.check(function(t,e){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...tc(e)})}(ip,e)),t.ipv4=e=>t.check(function(t,e){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...tc(e)})}(ap,e)),t.ipv6=e=>t.check(function(t,e){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...tc(e)})}(cp,e)),t.cidrv4=e=>t.check(function(t,e){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...tc(e)})}(up,e)),t.cidrv6=e=>t.check(function(t,e){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...tc(e)})}(lp,e)),t.e164=e=>t.check(function(t,e){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...tc(e)})}(dp,e)),t.datetime=e=>t.check(Ol(e)),t.date=e=>t.check(Dl(e)),t.time=e=>t.check(Sl(e)),t.duration=e=>t.check(Nl(e))});function Xl(t){return function(t,e){return new t({type:"string",...tc(e)})}(Wl,t)}const Gl=Pa("ZodStringFormat",(t,e)=>{lu.init(t,e),Hl.init(t,e)}),Kl=Pa("ZodEmail",(t,e)=>{du.init(t,e),Gl.init(t,e)}),Yl=Pa("ZodGUID",(t,e)=>{pu.init(t,e),Gl.init(t,e)}),Jl=Pa("ZodUUID",(t,e)=>{hu.init(t,e),Gl.init(t,e)}),Ql=Pa("ZodURL",(t,e)=>{fu.init(t,e),Gl.init(t,e)}),tp=Pa("ZodEmoji",(t,e)=>{mu.init(t,e),Gl.init(t,e)}),ep=Pa("ZodNanoID",(t,e)=>{gu.init(t,e),Gl.init(t,e)}),np=Pa("ZodCUID",(t,e)=>{yu.init(t,e),Gl.init(t,e)}),rp=Pa("ZodCUID2",(t,e)=>{wu.init(t,e),Gl.init(t,e)}),sp=Pa("ZodULID",(t,e)=>{bu.init(t,e),Gl.init(t,e)}),op=Pa("ZodXID",(t,e)=>{_u.init(t,e),Gl.init(t,e)}),ip=Pa("ZodKSUID",(t,e)=>{vu.init(t,e),Gl.init(t,e)}),ap=Pa("ZodIPv4",(t,e)=>{Iu.init(t,e),Gl.init(t,e)}),cp=Pa("ZodIPv6",(t,e)=>{Du.init(t,e),Gl.init(t,e)}),up=Pa("ZodCIDRv4",(t,e)=>{Au.init(t,e),Gl.init(t,e)}),lp=Pa("ZodCIDRv6",(t,e)=>{Su.init(t,e),Gl.init(t,e)}),pp=Pa("ZodBase64",(t,e)=>{Nu.init(t,e),Gl.init(t,e)}),hp=Pa("ZodBase64URL",(t,e)=>{Pu.init(t,e),Gl.init(t,e)}),dp=Pa("ZodE164",(t,e)=>{Cu.init(t,e),Gl.init(t,e)}),fp=Pa("ZodJWT",(t,e)=>{Lu.init(t,e),Gl.init(t,e)}),mp=Pa("ZodBoolean",(t,e)=>{Ru.init(t,e),Zl.init(t,e)});function gp(t){return function(t,e){return new t({type:"boolean",...tc(e)})}(mp,t)}const yp=Pa("ZodUnknown",(t,e)=>{$u.init(t,e),Zl.init(t,e)});function wp(){return new yp({type:"unknown"})}const bp=Pa("ZodNever",(t,e)=>{ju.init(t,e),Zl.init(t,e)});function _p(t){return function(t,e){return new t({type:"never",...tc(e)})}(bp,t)}const vp=Pa("ZodArray",(t,e)=>{Fu.init(t,e),Zl.init(t,e),t.element=e.element,t.min=(e,n)=>t.check(_l(e,n)),t.nonempty=e=>t.check(_l(1,e)),t.max=(e,n)=>t.check(bl(e,n)),t.length=(e,n)=>t.check(vl(e,n)),t.unwrap=()=>t.element});function Tp(t,e){return function(t,e,n){return new t({type:"array",element:e,...tc(n)})}(vp,t,e)}const xp=Pa("ZodObject",(t,e)=>{Vu.init(t,e),Zl.init(t,e),Ua(t,"shape",()=>e.shape),t.keyof=()=>Np(Object.keys(t._zod.def.shape)),t.catchall=e=>t.clone({...t._zod.def,catchall:e}),t.passthrough=()=>t.clone({...t._zod.def,catchall:wp()}),t.loose=()=>t.clone({...t._zod.def,catchall:wp()}),t.strict=()=>t.clone({...t._zod.def,catchall:_p()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=e=>function(t,e){if(!Ga(e))throw new Error("Invalid input to extend: expected a plain object");const n=t._zod.def.checks;if(n&&n.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const r=Va(t._zod.def,{get shape(){const n={...t._zod.def.shape,...e};return Ba(this,"shape",n),n},checks:[]});return Qa(t,r)}(t,e),t.safeExtend=e=>function(t,e){if(!Ga(e))throw new Error("Invalid input to safeExtend: expected a plain object");const n={...t._zod.def,get shape(){const n={...t._zod.def.shape,...e};return Ba(this,"shape",n),n},checks:t._zod.def.checks};return Qa(t,n)}(t,e),t.merge=e=>function(t,e){const n=Va(t._zod.def,{get shape(){const n={...t._zod.def.shape,...e._zod.def.shape};return Ba(this,"shape",n),n},get catchall(){return e._zod.def.catchall},checks:[]});return Qa(t,n)}(t,e),t.pick=e=>function(t,e){const n=t._zod.def;return Qa(t,Va(t._zod.def,{get shape(){const t={};for(const r in e){if(!(r in n.shape))throw new Error(`Unrecognized key: "${r}"`);e[r]&&(t[r]=n.shape[r])}return Ba(this,"shape",t),t},checks:[]}))}(t,e),t.omit=e=>function(t,e){const n=t._zod.def,r=Va(t._zod.def,{get shape(){const r={...t._zod.def.shape};for(const t in e){if(!(t in n.shape))throw new Error(`Unrecognized key: "${t}"`);e[t]&&delete r[t]}return Ba(this,"shape",r),r},checks:[]});return Qa(t,r)}(t,e),t.partial=(...e)=>function(t,e,n){const r=Va(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const e in n){if(!(e in r))throw new Error(`Unrecognized key: "${e}"`);n[e]&&(s[e]=t?new t({type:"optional",innerType:r[e]}):r[e])}else for(const e in r)s[e]=t?new t({type:"optional",innerType:r[e]}):r[e];return Ba(this,"shape",s),s},checks:[]});return Qa(e,r)}(Rp,t,e[0]),t.required=(...e)=>function(t,e,n){const r=Va(e._zod.def,{get shape(){const r=e._zod.def.shape,s={...r};if(n)for(const e in n){if(!(e in s))throw new Error(`Unrecognized key: "${e}"`);n[e]&&(s[e]=new t({type:"nonoptional",innerType:r[e]}))}else for(const e in r)s[e]=new t({type:"nonoptional",innerType:r[e]});return Ba(this,"shape",s),s},checks:[]});return Qa(e,r)}(zp,t,e[0])});function Ep(t,e){const n={type:"object",shape:t??{},...tc(e)};return new xp(n)}const Op=Pa("ZodUnion",(t,e)=>{Hu.init(t,e),Zl.init(t,e),t.options=e.options});function Ip(t,e){return new Op({type:"union",options:t,...tc(e)})}const Dp=Pa("ZodIntersection",(t,e)=>{Wu.init(t,e),Zl.init(t,e)});const Ap=Pa("ZodRecord",(t,e)=>{Ku.init(t,e),Zl.init(t,e),t.keyType=e.keyType,t.valueType=e.valueType});function Sp(t,e,n){return new Ap({type:"record",keyType:t,valueType:e,...tc(n)})}const kp=Pa("ZodEnum",(t,e)=>{Yu.init(t,e),Zl.init(t,e),t.enum=e.entries,t.options=Object.values(e.entries);const n=new Set(Object.keys(e.entries));t.extract=(t,r)=>{const s={};for(const r of t){if(!n.has(r))throw new Error(`Key ${r} not found in enum`);s[r]=e.entries[r]}return new kp({...e,checks:[],...tc(r),entries:s})},t.exclude=(t,r)=>{const s={...e.entries};for(const e of t){if(!n.has(e))throw new Error(`Key ${e} not found in enum`);delete s[e]}return new kp({...e,checks:[],...tc(r),entries:s})}});function Np(t,e){const n=Array.isArray(t)?Object.fromEntries(t.map(t=>[t,t])):t;return new kp({type:"enum",entries:n,...tc(e)})}const Pp=Pa("ZodLiteral",(t,e)=>{Ju.init(t,e),Zl.init(t,e),t.values=new Set(e.values),Object.defineProperty(t,"value",{get(){if(e.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return e.values[0]}})});function Cp(t,e){return new Pp({type:"literal",values:Array.isArray(t)?t:[t],...tc(e)})}const Lp=Pa("ZodTransform",(t,e)=>{Qu.init(t,e),Zl.init(t,e),t._zod.parse=(n,r)=>{if("backward"===r.direction)throw new La(t.constructor.name);n.addIssue=r=>{if("string"==typeof r)n.issues.push(ic(r,n.value,e));else{const e=r;e.fatal&&(e.continue=!1),e.code??(e.code="custom"),e.input??(e.input=n.value),e.inst??(e.inst=t),n.issues.push(ic(e))}};const s=e.transform(n.value,n);return s instanceof Promise?s.then(t=>(n.value=t,n)):(n.value=s,n)}});const Rp=Pa("ZodOptional",(t,e)=>{el.init(t,e),Zl.init(t,e),t.unwrap=()=>t._zod.def.innerType});function $p(t){return new Rp({type:"optional",innerType:t})}const jp=Pa("ZodNullable",(t,e)=>{nl.init(t,e),Zl.init(t,e),t.unwrap=()=>t._zod.def.innerType});function qp(t){return new jp({type:"nullable",innerType:t})}const Fp=Pa("ZodDefault",(t,e)=>{rl.init(t,e),Zl.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});const Mp=Pa("ZodPrefault",(t,e)=>{ol.init(t,e),Zl.init(t,e),t.unwrap=()=>t._zod.def.innerType});const zp=Pa("ZodNonOptional",(t,e)=>{il.init(t,e),Zl.init(t,e),t.unwrap=()=>t._zod.def.innerType});const Up=Pa("ZodCatch",(t,e)=>{cl.init(t,e),Zl.init(t,e),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});const Bp=Pa("ZodPipe",(t,e)=>{ul.init(t,e),Zl.init(t,e),t.in=e.in,t.out=e.out});function Vp(t,e){return new Bp({type:"pipe",in:t,out:e})}const Zp=Pa("ZodReadonly",(t,e)=>{pl.init(t,e),Zl.init(t,e),t.unwrap=()=>t._zod.def.innerType});const Hp=Pa("ZodCustom",(t,e)=>{dl.init(t,e),Zl.init(t,e)});const Wp="directus:extension",Xp=Ep({app:Xl(),api:Xl()}),Gp=Ep({request:$p(Ep({urls:Tp(Xl()),methods:Tp(Ip([Cp("GET"),Cp("POST"),Cp("PATCH"),Cp("PUT"),Cp("DELETE")]))})),log:$p(Ep({})),sleep:$p(Ep({}))}),Kp=$p(Ep({enabled:gp(),requestedScopes:Gp})),Yp=Ip([Ep({type:Np(ka),name:Xl(),source:Xl()}),Ep({type:Np(Sa),name:Xl(),source:Xl()}),Ep({type:Np(Na),name:Xl(),source:Xp})]),Jp=Ep({host:Xl(),hidden:gp().optional()}),Qp=Ep({type:Np(Sa),path:Xl(),source:Xl()}),th=Ep({type:Np(ka),path:Xl(),source:Xl(),sandbox:Kp}),eh=Ep({type:Np(Na),path:Xp,source:Xp,sandbox:Kp}),nh=Ep({type:Cp("bundle"),partial:gp().optional(),path:Xp,entries:Tp(Yp)});Tp(Yp);const rh=Jp.and(Ip([Qp,th,eh,nh]));Ep({name:Xl(),version:Xl(),type:Ip([Cp("module"),Cp("commonjs")]).optional(),description:Xl().optional(),icon:Xl().optional(),dependencies:Sp(Xl(),Xl()).optional(),devDependencies:Sp(Xl(),Xl()).optional(),[Wp]:rh});var sh=(t,{services:e,getSchema:n})=>{const{ItemsService:r}=e;let s=!1;t.post("/process",async(t,o)=>{if(t.query.secret!==process.env.DIRECTUS_STATIC_TOKEN)return o.status(403).send("Forbidden");if(s)return o.status(429).json({message:"Task is already running"});o.json({message:"Processing started",status:"in-progress"});const i=t=>new Promise(e=>setTimeout(e,t));(async()=>{s=!0;const t=await n(),o=new r("cron_writer_logs",{schema:t,accountability:null}),a={total_sources:0,total_selected:0,total_saved:0,sources_breakdown:[]},c=async(t,e,n="System",r=null)=>{try{await o.createOne({level:t,message:e.substring(0,255),source_name:n.substring(0,50),details:r?"string"==typeof r?r:JSON.stringify(r).substring(0,255):"",timestamp:new Date})}catch(t){}};try{const n=new r("rss_sources",{schema:t,accountability:null}),s=new r("tech_news",{schema:t,accountability:null}),u=await n.readByQuery({filter:{status:{_eq:"active"}},sort:["-priority"]}),l=Array.isArray(u)?u:u?.data||[];if(a.total_sources=l.length,0===a.total_sources)return;const p=new Oa({apiKey:process.env.LLM_API_KEY,baseURL:"https://dashscope.aliyuncs.com/compatible-mode/v1"});for(const t of l){let e=0,r=0;try{const o=new Tn({timeout:1e4,headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36...",Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","Accept-Language":"en-US,en;q=0.9","Cache-Control":"no-cache",Pragma:"no-cache"}}),u=await o.parseURL(t.url),l=(u?.items||[]).slice(0,t.fetch_limit||3);for(const n of l){const o=(n.title||"").replace(/<[^>]*>/g,"").trim(),u=Da(Ia(n["content:encoded"]||n.content||n.description||""),800);if(u&&!(u.trim().split(/\s+/).length<20))try{const t=await p.chat.completions.create({model:"qwen-plus",max_completion_tokens:1024,messages:[{role:"user",content:xn(o,u)}]},{timeout:4e4}),c=JSON.parse(Aa(t.choices[0]?.message?.content||"{}"));await i(1500),c?.is_relevant&&(e++,a.total_selected++,await s.createOne({title:o,title_zh:c.title_zh,url:n.link||n.guid,published_at:n.pubDate?new Date(n.pubDate).toISOString():(new Date).toISOString(),category:c.category,summary_zh:c.summary_zh,summary:c.summary,inspiration:c.inspiration,inspiration_zh:c.inspiration_zh}),r++,a.total_saved++)}catch(e){await c("warning",`AI/DB Error: ${e.message}`,t.name,o)}}await n.updateOne(t.id,{last_fetched_at:new Date,last_saved_items:r,consecutive_fetches:t.consecutive_fetches||1})}catch(e){await c("error",`Fetch Failed: ${e.message}`,t.name,t.url)}a.sources_breakdown.push(`${t.name}:  ${e},  ${r}`)}const{logsRemoved:h,newsRemoved:d}=await async function(t,e){const{ItemsService:n}=t,r=new n("cron_writer_logs",{schema:e,accountability:null}),s=new n("tech_news",{schema:e,accountability:null}),o=new Date,i=new Date(o.getTime()-6048e5),a=await r.deleteByQuery({filter:{date_created:{_lt:i.toISOString()}}}),c=new Date(o.getTime()-7776e6),u=await s.deleteByQuery({filter:{date_created:{_lt:c.toISOString()}}});return{logsRemoved:a.length,newsRemoved:u.length}}(e,t);await o.createOne({level:"info",message:"Daily Task Completed Successfully",source_name:"TaskRunner",result:[`Total Sources: ${a.total_sources}`,`Total Selected (AI): ${a.total_selected}`,`Total Saved (DB): ${a.total_saved}`,`Logs Cleaned: ${h} (older than 7 days)`,`News Cleaned: ${d} (older than 90 days)`,"--- Details ---",...a.sources_breakdown].join("\n"),timestamp:new Date})}catch(t){await c("error",`Fatal: ${t.message}`,"System",t.stack)}finally{s=!1}})()})};export{sh as default};
