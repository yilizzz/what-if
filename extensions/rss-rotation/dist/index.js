var t=({schedule:t,action:r},{database:i,logger:a})=>{t("*/5 * * * * *",async()=>{a.info("[Schedule] Triggering RSS rotation..."),await(async()=>{try{a.info("[Rotation] Starting rotation...");const t=await i("rss_sources").where("status","active").first(),r=t?t.priority:-1;let o=await i("rss_sources").where("priority",">",r).orderBy("priority","asc").first();o||(o=await i("rss_sources").orderBy("priority","asc").first()),o?(await i.transaction(async r=>{t&&await r("rss_sources").where("id",t.id).update({status:"inactive"}),await r("rss_sources").where("id",o.id).update({status:"active"})}),a.info(`[Rotation] Switched from ID ${t?.id}-priority${t?.priority} to ID ${o.id}-priority${o?.priority}`)):a.warn("[Rotation] No RSS sources found to rotate")}catch(t){a.error(`[Rotation Error]: ${t.message}`)}})()})};export{t as default};
