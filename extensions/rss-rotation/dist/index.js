var t=({schedule:t,action:r},{database:a,logger:s})=>{t("0 12 * * *",async()=>{s.info("[Schedule] Triggering RSS rotation..."),await(async()=>{try{s.info("[Rotation] Starting rotation...");const t=await a("rss_sources").where("status","active").first(),r=t?t.priority:-1;let i=await a("rss_sources").where("priority",">",r).orderBy("priority","asc").first();i||(i=await a("rss_sources").orderBy("priority","asc").first()),i?await a.transaction(async r=>{t&&await r("rss_sources").where("id",t.id).update({status:"inactive"}),await r("rss_sources").where("id",i.id).update({status:"active"})}):s.warn("[Rotation] No RSS sources found to rotate")}catch(t){s.error(`[Rotation Error]: ${t.message}`)}})()})};export{t as default};
