var e=({filter:e},{services:r,getSchema:s})=>{const{ItemsService:o}=r;e("items.update",async(e,r)=>{if("rss_sources"!==r.collection)return e;if(void 0===e.url)return e;try{const t=await s(),a=new o("rss_sources",{schema:t}),c=Array.isArray(r.keys)?r.keys[0]:r.keys,i=await a.readOne(c,{fields:["url"]});i&&i.url!==e.url?(console.log("[âœ… RESET TRIGGERED] URL changed! Resetting..."),e.consecutive_failures=0,e.last_fetch_error=null,e.status="active"):console.log("[DEBUG] rss_sources : URLs are the same or no original record. No reset.")}catch(e){console.error("[ERROR] Failed to read original record rss_sources:",e.message)}return e})};export{e as default};
